"use strict";(self.webpackChunkhousing_dashboard=self.webpackChunkhousing_dashboard||[]).push([[2811,2844,3966,4076,4955,6340,9366,9832],{1900:(e,t,i)=>{i.d(t,{A:()=>f});var r=i(50076),n=i(42553),o=i(76460),s=i(87663),l=i(64920),a=i(53430),u=i(36693),c=i(67478),d=i(24241);const p=new Map;class f{static fromJSON(e){return new f(e.fields,e.timeZoneByFieldName)}static fromLayer(e){var t;return new f(null!==(t=e.fields)&&void 0!==t?t:[],g(e))}static fromLayerJSON(e){var t;return new f(null!==(t=e.fields)&&void 0!==t?t:[],g(e))}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const i=[];for(const n of this.fields){const e=null===n||void 0===n?void 0:n.name,t=h(e);if(e&&t){var r;const o=y(e);this._fieldsMap.set(e,n),this._fieldsMap.set(o,n),this._normalizedFieldsMap.set(t,n),i.push("".concat(o,":").concat(n.type,":").concat(null===(r=this._timeZoneByFieldName)||void 0===r?void 0:r.get(e))),(0,a.vE)(n)?(this.dateFields.push(n),this._dateFieldsSet.add(n)):(0,a.WA)(n)&&(this._numericFieldsSet.add(n),this.numericFields.push(n)),(0,a.te)(n)||(0,a.Xz)(n)||(n.editable=null==n.editable||!!n.editable,n.nullable=null==n.nullable||!!n.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,a.te)(e)||(0,a.Xz)(e)||e.nullable||void 0!==(0,a.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(null===e||void 0===e?void 0:e.uid)}has(e){return null!=this.get(e)}get(e){var t;if(!e)return;let i=this._fieldsMap.get(e);return i||(i=null!==(t=this._fieldsMap.get(y(e)))&&void 0!==t?t:this._normalizedFieldsMap.get(h(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(o.A.getLogger("esri.layers.support.FieldsIndex").errorOnce(new r.A("getTimeZone:no-timezone-information","no time zone information for field '".concat(t.name,"'"))),u.n$):m.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?l.GB.instance:t===u.n$?d.mQ.utcInstance:(0,s.tE)(p,t,(()=>d.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,a.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var t,i;return null!==(t=null===(i=this.get(e))||void 0===i?void 0:i.name)&&void 0!==t?t:void 0}toJSON(){return{fields:this.fields.map((e=>n.A.isSerializable(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function y(e){return e.trim().toLowerCase()}function h(e){var t,i;return null!==(t=null===(i=(0,a.rS)(e))||void 0===i?void 0:i.toLowerCase())&&void 0!==t?t:""}const m=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function g(e){var t,i,r,n,o,s,l;const a=new Map;if(!e.fields)return a;const d=!0===e.datesInUnknownTimezone,{timeInfo:p,editFieldsInfo:f}=e,h=null!==(t=p?"startField"in p?p.startField:p.startTimeField:"")&&void 0!==t?t:"",g=null!==(i=p?"endField"in p?p.endField:p.endTimeField:"")&&void 0!==i?i:"",v=function(e){return"dateFieldsTimeZone"in e}(e)?null!==(r=e.dateFieldsTimeZone)&&void 0!==r?r:null:e.dateFieldsTimeReference?(0,c.ZS)(e.dateFieldsTimeReference):null,_=f?function(e){return"timeZone"in e}(f)?null!==(n=f.timeZone)&&void 0!==n?n:v:f.dateFieldsTimeReference?(0,c.ZS)(f.dateFieldsTimeReference):null!==v&&void 0!==v?v:u.n$:null,M=p?function(e){return"timeZone"in e}(p)?null!==(o=p.timeZone)&&void 0!==o?o:v:p.timeReference?(0,c.ZS)(p.timeReference):v:null,S=new Map([[y(null!==(s=null===f||void 0===f?void 0:f.creationDateField)&&void 0!==s?s:""),_],[y(null!==(l=null===f||void 0===f?void 0:f.editDateField)&&void 0!==l?l:""),_],[y(h),M],[y(g),M]]);for(const{name:c,type:w}of e.fields)if(m.has(w))a.set(c,u.L5);else if("date"!==w&&"esriFieldTypeDate"!==w)a.set(c,null);else if(d)a.set(c,u.L5);else{var b;const e=null!==(b=S.get(y(null!==c&&void 0!==c?c:"")))&&void 0!==b?b:v;a.set(c,e)}return a}},4414:(e,t,i)=>{i.d(t,{O3:()=>d,PU:()=>u,YW:()=>f,ex:()=>l,hv:()=>p,zp:()=>a});var r=i(15941),n=i(76931),o=i(43047),s=i(55855);const l=2.4;function a(e){return(0,n.PN)(e*l)}function u(e){return(0,n.Lz)(e)/l}function c(e,t,i,n){let{color:s,ratio:l}=t,{color:a,ratio:u}=i;if(u===l){const e=1e-6;1===u?l-=e:u+=e}const c=(0,r.qE)((n-l)/(u-l),0,1);(0,o.l)(e,s.toArray(),a.toArray(),c)}function d(e){const t=new Uint8ClampedArray(2048);if(e=e.filter((e=>{let{ratio:t}=e;return t>=0&&t<=1})).sort(((e,t)=>e.ratio-t.ratio)).map((e=>{let{color:t,ratio:i}=e;return{color:t,ratio:Math.max(i,.001)}})),e.length<1)return t;let i=e[0],r=e[0],n=1;const o=(0,s.vt)();for(let s=0;s<512;s++){const l=(s+.5)/512;for(;l>r.ratio&&n<e.length;)i=r,r=e[n++];c(o,i,r,l),t.set(o,4*s)}return t}function p(e,t,i){const r=Math.sqrt(e**2+t**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function f(e){return"function"==typeof e?e:e?t=>+t[e]:()=>1}},20665:(e,t,i)=>{i.d(t,{A:()=>f});var r=i(89379),n=i(35143),o=i(91967),s=i(98773),l=i(94643),a=i(46053),u=(i(81806),i(76460),i(47249),i(85842)),c=i(53430),d=i(98976);let p=class extends o.A{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||(0,s.UT)((()=>(0,d.lw)())):null}get featureUtilsPromise(){var e;return null!==(e=this._get("featureUtilsPromise"))&&void 0!==e?e:i.e(9912).then(i.bind(i,9912)).then((e=>this._featureUtils=e))}get calculatedExpressions(){var e;const t=new l.A;if(!this.expressionsUsedInTitle.length)return t;if(null===(e=this._arcadeTask)||void 0===e||!e.value){for(const e of null!==(i=this.expressionsUsedInTitle)&&void 0!==i?i:[]){var i;t.push({name:e.name,invalid:!0})}return t}for(const n of this.expressionsUsedInTitle)try{const e=this._arcadeTask.value.arcade.parseScript(n.expression,["$layer","$map","$datastore"]);if(e.isAsync){t.push({name:n.name,invalid:!0});break}t.push({name:n.name,syntax:e,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(e,{vars:{$feature:"any"}})})}catch(r){t.push({name:n.name,invalid:!0});break}return t}get expressionsUsedInTitle(){var e,t,i,r;let n=null!==(e=null===(t=this.effectivePopupTemplate)||void 0===t?void 0:t.title)&&void 0!==e?e:"";return"string"!=typeof n?[]:(n=n.toLowerCase(),null!==(i=null===(r=this.effectivePopupTemplate)||void 0===r||null===(r=r.expressionInfos)||void 0===r?void 0:r.filter((e=>n.includes("{expression/".concat(e.name.toLowerCase(),"}")))))&&void 0!==i?i:[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some((e=>!0===e.invalid))}get requiredFields(){var e;const t=new Set;if(null!==(e=this._arcadeTask)&&void 0!==e&&e.value&&!this.hasBadExpressions)for(const l of null!==(i=null===(r=this.calculatedExpressions)||void 0===r?void 0:r.toArray())&&void 0!==i?i:[]){var i,r;try{const e=this._arcadeTask.value.arcade.extractFieldLiterals(l.syntax);for(const i of e){var n;const e=i.split("."),r=this.fieldsIndex.get(null!==(n=e.at(-1))&&void 0!==n?n:"");r&&t.add(r.name)}}catch(s){}}const o=this._extractFieldNames(this.workingTitle);for(const l of o){const e=this.fieldsIndex.get(l);e&&t.add(e.name)}return t}get titleFromDisplayField(){var e,t,i,r;let n="";return this.displayField&&(n=null!==(e=null===(t=this.fieldsIndex.get(this.displayField))||void 0===t?void 0:t.name)&&void 0!==e?e:""),n||(n=null!==(i=null===(r=this.fieldsIndex.get(this.objectIdField))||void 0===r?void 0:r.name)&&void 0!==i?i:""),n?"{".concat(n,"}"):""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return""===e||null==e||this.hasBadExpressions||"string"!=typeof e?this.titleFromDisplayField:e}async getTitle(e,t,i){try{var r,n;const{attributes:o}=t,s=null!==(r=null===i||void 0===i?void 0:i.timeZone)&&void 0!==r?r:"system",[{substituteFieldsInLinksAndAttributes:l}]=await Promise.all([this.featureUtilsPromise,null===(n=this._arcadeTask)||void 0===n?void 0:n.promise]);if(i.fetchMissingFields&&(t=await this._checkAndReQueryGraphic(e,t)),this.workingTitle&&this.fieldInfoMap){const i=this._createFormattedAttributes(e,t,s).global;return l({attributes:o,expressionAttributes:null,fieldInfoMap:this.fieldInfoMap,globalAttributes:i,layer:e,text:this.workingTitle})}return""}catch(o){}return""}async _checkAndReQueryGraphic(e,t){const i=t.getObjectId();if(null==i)return t;if(!(0,c.Kl)(this.requiredFields,t)){const t=e.createQuery();t.where="1=1",t.outFields=[...this.requiredFields],t.objectIds=[i];const r=await e.queryFeatures(t);if(1===(null===r||void 0===r?void 0:r.features.length))return r.features[0]}return t}_createFieldInfoMap(e){const t=new Map;if(!e)return t;for(const r of e){var i;if(!r.fieldName)continue;const e=this.fieldsIndex.get(r.fieldName),n=null!==(i=null===e||void 0===e?void 0:e.name)&&void 0!==i?i:r.fieldName;r.fieldName=n,t.set(n.toLowerCase(),r)}return t}_createFormattedAttributes(e,t){var i,n,o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"system";const l=null!==(i=null===(n=this.effectivePopupTemplate)||void 0===n?void 0:n.fieldInfos)&&void 0!==i?i:[],a={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&null!==(o=this._arcadeTask)&&void 0!==o&&o.value){const i=this._arcadeTask.value.Feature.createFromGraphicLikeObject(t.geometry,t.attributes,e,null);for(const e of this.calculatedExpressions)try{a["expression/".concat(e.name)]=e.func({vars:{$feature:i}})}catch(c){}}const u=(0,r.A)((0,r.A)({},t.attributes),a);return{global:this._featureUtils.formatAttributes({fieldInfos:l,attributes:u,graphic:t,timeZone:s,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return(0,c.nw)(e).filter((e=>!(0===e.indexOf("relationships/")||0===e.indexOf("expression/"))))}};(0,n._)([(0,a.MZ)({readOnly:!0})],p.prototype,"_arcadeTask",null),(0,n._)([(0,a.MZ)()],p.prototype,"_featureUtils",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],p.prototype,"featureUtilsPromise",null),(0,n._)([(0,a.MZ)({readOnly:!0})],p.prototype,"calculatedExpressions",null),(0,n._)([(0,a.MZ)()],p.prototype,"displayField",void 0),(0,n._)([(0,a.MZ)()],p.prototype,"effectivePopupTemplate",void 0),(0,n._)([(0,a.MZ)()],p.prototype,"expressionsUsedInTitle",null),(0,n._)([(0,a.MZ)()],p.prototype,"fieldsIndex",void 0),(0,n._)([(0,a.MZ)()],p.prototype,"fieldInfoMap",null),(0,n._)([(0,a.MZ)()],p.prototype,"fields",void 0),(0,n._)([(0,a.MZ)()],p.prototype,"objectIdField",void 0),(0,n._)([(0,a.MZ)()],p.prototype,"requiredFields",null),p=(0,n._)([(0,u.$)("esri.layers.support.TitleCreator")],p);const f=p},33754:(e,t,i)=>{i.d(t,{H:()=>n,L:()=>r});const r=1;function n(e,t){let i=0;for(const n of t){var r;const t=null===(r=n.attributes)||void 0===r?void 0:r[e];"number"==typeof t&&isFinite(t)&&(i=Math.max(i,t))}return i}},37534:(e,t,i)=>{i.d(t,{Rr:()=>a,fY:()=>c,ne:()=>u});var r=i(35143),n=i(48611),o=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),l=i(51162);function a(e,t,i){if(!e)return null;const r=e.find((e=>!!e.field));if(!r)return null;const n=new l.A;return n.read(r,i),[n]}const u={type:[l.A],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:a},write:{writer:function(e,t,i,r){const o=e.find((e=>!!e.field));o&&(0,n.sM)(i,[o.toJSON()],t)}}}},c=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return(0,r._)([(0,o.MZ)(u)],t.prototype,"orderBy",void 0),t=(0,r._)([(0,s.$)("esri.layers.mixins.OrderedLayer")],t),t}},43311:(e,t,i)=>{i.r(t),i.d(t,{default:()=>B});var r=i(89379),n=i(35143),o=i(39356),s=i(94643),l=i(50076),a=i(53084),u=i(77717),c=i(48611),d=i(62754),p=i(46053),f=(i(81806),i(76460),i(28379)),y=i(85842),h=i(17707),m=i(76797),g=i(9624),v=i(13312),_=i(2413),M=i(1438),S=i(80963),b=i(38451),w=i(63733),x=i(25515),I=i(33754),z=i(65624),C=i(11270),F=i(94729),T=i(5682),A=i(44135),N=i(86875),O=i(7246),L=i(76940),k=i(86659);function Z(e){return"markup"===e.featureCollectionType||e.layers.some((e=>null!=e.layerDefinition.visibilityField||!P(e)))}function P(e){var t;let{layerDefinition:i,featureSet:r}=e;const n=null!==(t=i.geometryType)&&void 0!==t?t:r.geometryType;return G.find((e=>{var t;return n===e.geometryTypeJSON&&(null===(t=i.drawingInfo)||void 0===t||null===(t=t.renderer)||void 0===t||null===(t=t.symbol)||void 0===t?void 0:t.type)===e.identifyingSymbol.type}))}function R(){return new m.A({xmin:-180,ymin:-90,xmax:180,ymax:90})}const E=new A.A({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),J=new A.A({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0,length:255});let j=class extends w.A{constructor(e){super(e),this.visibilityMode="inherited"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on("after-add",(e=>{e.item.sourceLayer=this.layer})),this.graphics.on("after-remove",(e=>{e.item.sourceLayer=null}))}get fullExtent(){var e;const t=null===(e=this.layer)||void 0===e?void 0:e.spatialReference,i=this.fullBounds;return t?null==i?(0,g.projectOrLoad)(R(),t).geometry:(0,_.w1)(i,t):null}get fullBounds(){var e;const t=null===(e=this.layer)||void 0===e?void 0:e.spatialReference;if(!t)return null;const i=(0,_.Ie)();return this.graphics.forEach((e=>{const r=null!=e.geometry?(0,g.projectOrLoad)(e.geometry,t).geometry:null;null!=r&&(0,_.fT)(i,"point"===r.type?r:r.extent,i)})),(0,_.aI)(i,_.qv)?null:i}get sublayers(){return this.graphics}};(0,n._)([(0,p.MZ)({readOnly:!0})],j.prototype,"fullExtent",null),(0,n._)([(0,p.MZ)({readOnly:!0})],j.prototype,"fullBounds",null),(0,n._)([(0,p.MZ)({readOnly:!0})],j.prototype,"sublayers",null),(0,n._)([(0,p.MZ)()],j.prototype,"layer",void 0),(0,n._)([(0,p.MZ)()],j.prototype,"layerId",void 0),(0,n._)([(0,p.MZ)({readOnly:!0})],j.prototype,"visibilityMode",void 0),j=(0,n._)([(0,y.$)("esri.layers.MapNotesLayer.MapNotesSublayer")],j);const G=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new N.A).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new O.A).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new L.A).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new L.A).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new k.A).toJSON()}];let D=class extends((0,z.dM)((0,T.j)((0,C.q)((0,F.A)((0,u.P)(x.A)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.listMode="hide-children",this.minScale=0,this.maxScale=0,this.spatialReference=v.A.WGS84,this.sublayers=new s.A(G.map((e=>new j({id:e.id,layerId:e.layerId,title:e.title,layer:this})))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(e,t,i){return{operations:{supportsMapNotesEditing:!Z(t)&&"portal-item"!==(null===i||void 0===i?void 0:i.origin)}}}readFeatureCollections(e,t,i){if(!Z(t))return null;const r=t.layers.map((e=>{const t=new b.default;return t.read(e,i),t}));return new s.A({items:r})}readLegacyfeatureCollectionJSON(e,t){return Z(t)?(0,a.o8)(t.featureCollection):null}get fullExtent(){var e;const t=this.spatialReference,i=(0,_.Ie)();return null!=this.sublayers?this.sublayers.forEach((e=>{let{fullBounds:t}=e;return null!=t?(0,_.fT)(i,t,i):i}),i):null!==(e=this.featureCollectionJSON)&&void 0!==e&&e.layers.some((e=>e.layerDefinition.extent))&&this.featureCollectionJSON.layers.forEach((e=>{const r=(0,g.projectOrLoad)(e.layerDefinition.extent,t).geometry;null!=r&&(0,_.fT)(i,r,i)})),(0,_.aI)(i,_.qv)?(0,g.projectOrLoad)(R(),t).geometry:(0,_.w1)(i,t)}readMinScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.minScale)return i.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.maxScale)return i.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(e,t){return t.layers.length?v.A.fromJSON(t.layers[0].layerDefinition.spatialReference):v.A.WGS84}readSublayers(e,t,i){if(Z(t))return null;const r=[];let n=t.layers.reduce(((e,t)=>{var i;return Math.max(e,null!==(i=t.layerDefinition.id)&&void 0!==i?i:-1)}),-1)+1;for(const s of t.layers){var l;const{layerDefinition:e,featureSet:t}=s,i=null!==(l=e.id)&&void 0!==l?l:n++,a=P(s);if(null!=a){const n=new j({id:a.id,title:e.name,layerId:i,layer:this,graphics:t.features.map((e=>{let{geometry:t,symbol:i,attributes:r,popupInfo:n}=e;return o.A.fromJSON({attributes:r,geometry:t,symbol:i,popupTemplate:n})}))});r.push(n)}}return new s.A(r)}writeSublayers(e,t,i,r){var n;const{minScale:o,maxScale:s}=this;if(null==e)return;const a=e.some((e=>e.graphics.length>0));if(!this.capabilities.operations.supportsMapNotesEditing)return void(a&&(null===r||void 0===r||null===(n=r.messages)||void 0===n||n.push(new l.A("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer"))));const u=[];let d=this.spatialReference.toJSON();e:for(const l of e)for(const e of l.graphics)if(null!=e.geometry){d=e.geometry.spatialReference.toJSON();break e}for(const l of G){const t=e.find((e=>l.id===e.id));this._writeMapNoteSublayer(u,t,l,o,s,d,r)}(0,c.sM)("featureCollection.layers",u,t)}get textLayer(){return this._findSublayer("textLayer")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}read(e,t){"featureCollection"in e&&(e=(0,a.o8)(e),Object.assign(e,e.featureCollection)),super.read(e,t)}async beforeSave(){if(null==this.sublayers)return;let e=null;const t=[];for(const r of this.sublayers)for(const i of r.graphics)if(null!=i.geometry){const r=i.geometry;e?(0,S.aI)(r.spatialReference,e)||((0,g.canProjectWithoutEngine)(r.spatialReference,e)||(0,g.isLoaded)()||await(0,g.load)(),i.geometry=(0,g.project)(r,e)):e=r.spatialReference,t.push(i)}const i=await(0,M.el)(t.map((e=>e.geometry)));t.forEach(((e,t)=>e.geometry=i[t]))}_findSublayer(e){var t,i;return null==this.sublayers?null:null!==(t=null===(i=this.sublayers)||void 0===i?void 0:i.find((t=>t.id===e)))&&void 0!==t?t:null}_writeMapNoteSublayer(e,t,i,r,n,o,s){const l=[];if(null!=t){for(const e of t.graphics)this._writeMapNote(l,e,i.geometryType,s);this._normalizeObjectIds(l,E),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,a.o8)(i.identifyingSymbol)}},id:t.layerId,geometryType:i.geometryTypeJSON,minScale:r,maxScale:n,objectIdField:"OBJECTID",fields:[E.toJSON(),J.toJSON()],spatialReference:o},featureSet:{features:l,geometryType:i.geometryTypeJSON}})}}_writeMapNote(e,t,i,n){var o,s;if(null==t)return;const{geometry:l,symbol:a,popupTemplate:u}=t;if(null==l)return;if(l.type!==i)return void(null===n||void 0===n||null===(o=n.messages)||void 0===o||o.push(new d.A("map-notes-layer:invalid-geometry-type",'Geometry "'.concat(l.type,'" cannot be saved in "').concat(i,'" layer'),{graphic:t})));if(null==a)return void(null===n||void 0===n||null===(s=n.messages)||void 0===s||s.push(new d.A("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t})));const c={attributes:(0,r.A)({},t.attributes),geometry:l.toJSON(),symbol:a.toJSON()};null!=u&&(c.popupInfo=u.toJSON()),e.push(c)}_normalizeObjectIds(e,t){const i=t.name;let r=(0,I.H)(i,e)+1;const n=new Set;for(const o of e){o.attributes||(o.attributes={});const{attributes:e}=o;(null==e[i]||n.has(e[i]))&&(e[i]=r++),n.add(e[i])}}};(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"capabilities",void 0),(0,n._)([(0,f.w)(["portal-item","web-map"],"capabilities",["layers"])],D.prototype,"readCapabilities",null),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"featureCollections",void 0),(0,n._)([(0,f.w)(["web-map","portal-item"],"featureCollections",["layers"])],D.prototype,"readFeatureCollections",null),(0,n._)([(0,p.MZ)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],D.prototype,"featureCollectionJSON",void 0),(0,n._)([(0,f.w)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],D.prototype,"readLegacyfeatureCollectionJSON",null),(0,n._)([(0,p.MZ)({readOnly:!0,json:{read:!0,write:{enabled:!0,ignoreOrigin:!0}}})],D.prototype,"featureCollectionType",void 0),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"fullExtent",null),(0,n._)([(0,p.MZ)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],D.prototype,"legendEnabled",void 0),(0,n._)([(0,p.MZ)({type:["show","hide","hide-children"]})],D.prototype,"listMode",void 0),(0,n._)([(0,p.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],D.prototype,"minScale",void 0),(0,n._)([(0,f.w)(["web-map","portal-item"],"minScale",["layers"])],D.prototype,"readMinScale",null),(0,n._)([(0,p.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],D.prototype,"maxScale",void 0),(0,n._)([(0,f.w)(["web-map","portal-item"],"maxScale",["layers"])],D.prototype,"readMaxScale",null),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"multipointLayer",null),(0,n._)([(0,p.MZ)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],D.prototype,"operationalLayerType",void 0),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"pointLayer",null),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"polygonLayer",null),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"polylineLayer",null),(0,n._)([(0,p.MZ)({type:v.A})],D.prototype,"spatialReference",void 0),(0,n._)([(0,f.w)(["web-map","portal-item"],"spatialReference",["layers"])],D.prototype,"readSpatialReference",null),(0,n._)([(0,p.MZ)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],D.prototype,"sublayers",void 0),(0,n._)([(0,f.w)("web-map","sublayers",["layers"])],D.prototype,"readSublayers",null),(0,n._)([(0,h.K)("web-map","sublayers")],D.prototype,"writeSublayers",null),(0,n._)([(0,p.MZ)({readOnly:!0})],D.prototype,"textLayer",null),(0,n._)([(0,p.MZ)()],D.prototype,"title",void 0),(0,n._)([(0,p.MZ)({readOnly:!0,json:{read:!1}})],D.prototype,"type",void 0),D=(0,n._)([(0,y.$)("esri.layers.MapNotesLayer")],D);const B=D},44460:(e,t,i)=>{i.d(t,{Cb:()=>o,HW:()=>c,JR:()=>n,JZ:()=>a,WR:()=>l,b6:()=>d,fT:()=>r,nC:()=>u,yM:()=>s});const r=[252,146,31,255],n=[153,153,153,255],o={type:"esriSMS",style:"esriSMSCircle",size:6,color:r,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},s={type:"esriSLS",style:"esriSLSSolid",width:.75,color:r},l={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},d={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},51162:(e,t,i)=>{i.d(t,{A:()=>d});var r,n=i(35143),o=i(45802),s=i(42553),l=i(46053),a=(i(81806),i(76460),i(47249),i(85842));const u=new o.J({asc:"ascending",desc:"descending"});let c=r=class extends s.A{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new r({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"field",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],c.prototype,"valueExpression",void 0),(0,n._)([(0,l.MZ)({type:u.apiValues,json:{type:u.jsonValues,read:u.read,write:u.write}})],c.prototype,"order",void 0),c=r=(0,n._)([(0,a.$)("esri.layers.support.OrderByInfo")],c);const d=c},53521:(e,t,i)=>{i.d(t,{q:()=>n});var r=i(79369);class n{constructor(e,t){this._storage=new r.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._storage.put(this,e,t,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},57831:(e,t,i)=>{i.d(t,{q:()=>n});var r=i(86729);function n(e,t,i){if(null===i||void 0===i||!i.features||!i.hasZ)return;const n=(0,r.N)(i.geometryType,t,e.outSpatialReference);if(null!=n)for(const r of i.features)n(r.geometry)}},61701:(e,t,i)=>{var r;i.d(t,{X:()=>r}),function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(r||(r={}))},64810:(e,t,i)=>{i.d(t,{Ch:()=>a,mW:()=>s,u2:()=>l});var r=i(89379),n=i(15941),o=i(34154);function s(e,t){return(0,r.A)((0,r.A)({},t),{},{filterMode:e.mode})}function l(e,t){var i;return null!==(i=u(e,t).next().value)&&void 0!==i?i:null}function a(e,t,i){const r=function(e){if("manual"===d(e))return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:i,maxScale:r}of e.filters)t[0]=Math.max(t[0],p(i)),t[1]=Math.min(t[1],f(r));return t}(e);if(r&&((0,n.gg)(t,r[0])||(0,n.ZH)(i,r[1])))return"";const s=Array.from(u(e,t,i)),l=function(e,t,i){var r,o;if(0===e.length)return!0;const s=p(null===(r=e.at(0))||void 0===r?void 0:r.minScale),l=f(null===(o=e.at(-1))||void 0===o?void 0:o.maxScale);if((0,n.ZH)(s,t)||(0,n.gg)(l,i))return!0;for(let a=0;a<e.length-1;a++){const t=e[a],i=e[a+1];if((0,n.ZH)(p(i.minScale),f(t.maxScale)))return!0}return!1}(s,t,i)?"1=1":s.map((e=>e.where||"1=1")).reduce(((e,t)=>(0,o.IW)(e,t)),"");return l&&"1=1"!==l?l:""}function*u(e,t,i){if("manual"===d(e)){const t=e.filters.find((t=>t.id===e.activeFilterId));t&&(yield t)}else{"object"==typeof t&&(t=t.scale);for(const r of e.filters)c(r.minScale,r.maxScale,t,i)&&(yield r)}}function c(e,t,i,r){return e=p(e),i=p(i),t=f(t),!(!(0,n.Sp)(i,e)&&(null!==r&&void 0!==r?r:i)>e)&&!(0,n.Hx)(t,i)&&(void 0===r||!(0,n.Sp)(r,e))}function d(e){return"mode"in e?e.mode:e.filterMode}function p(e){return e||Number.POSITIVE_INFINITY}function f(e){return e||0}},65460:(e,t,i)=>{i.d(t,{BI:()=>m,D3:()=>y,XJ:()=>h,lc:()=>f,mX:()=>v,rU:()=>g,tH:()=>w});var r=i(88685);const n="__begin__",o="__end__",s=new RegExp(n,"ig"),l=new RegExp(o,"ig"),a=new RegExp("^"+n,"i"),u=new RegExp(o+"$","i"),c='"',d=c+" + ",p=" + "+c;function f(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function y(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function h(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=f(e.labelExpression),t.type="conventional"),t}function m(e){const t=h(e);switch(t.type){case"conventional":return v(t.expression);case"arcade":return t.expression}return null}function g(e){const t=h(e);switch(t.type){case"conventional":return function(e){const t=null===e||void 0===e?void 0:e.match(_);return(null===t||void 0===t?void 0:t[1].trim())||null}(t.expression);case"arcade":return w(t.expression)}return null}function v(e){let t;return e?(t=(0,r.HC)(e,(e=>n+'$feature["'+e+'"]'+o)),t=a.test(t)?t.replace(a,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(s,d).replaceAll(l,p)):t='""',t}const _=/^\s*\{([^}]+)\}\s*$/i;const M=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,S=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,b=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function w(e){if(!e)return null;let t=M.exec(e)||S.exec(e);return t?t[1]||t[3]:(t=b.exec(e),t?t[2]:null)}},77725:(e,t,i)=>{i.d(t,{A:()=>_});var r,n=i(35143),o=i(39356),s=i(45802),l=i(42553),a=i(53084),u=i(46053),c=(i(81806),i(76460),i(28379)),d=i(85842),p=i(17707),f=i(13312),y=i(19902),h=i(31608),m=i(44135);const g=new s.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=r=class extends l.A{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){return this.readFeaturesWithClass(e,t,o.A)}writeGeometryType(e,t,i,r){if(e)return void g.write(e,t,i,r);const{features:n}=this;if(n)for(const o of n)if(null!=(null===o||void 0===o?void 0:o.geometry))return void g.write(o.geometry.type,t,i,r)}readQueryGeometry(e,t){if(!e)return null;const i=!!e.spatialReference,r=(0,y.rS)(e);return r&&!i&&t.spatialReference&&(r.spatialReference=f.A.fromJSON(t.spatialReference)),r}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:i}=this;if(i)for(const r of i)if(r&&null!=r.geometry&&r.geometry.spatialReference)return void(t.spatialReference=r.geometry.spatialReference.toJSON())}clone(){return new r(this.cloneProperties())}cloneProperties(){return(0,a.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let i=0;i<t.features.length;i++){const r=t.features[i];if(r.geometry){const t=null===e||void 0===e?void 0:e[i];r.geometry=(null===t||void 0===t?void 0:t.toJSON())||r.geometry}}return t}quantize(e){const{scale:[t,i],translate:[r,n]}=e,o=this.features,s=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-r)/t)),(e=>Math.round((n-e)/i)));for(let l=0,a=o.length;l<a;l++)(null===s||void 0===s?void 0:s(o[l].geometry))||(o.splice(l,1),l--,a--);return this.transform=e,this}unquantize(){var e,t;const{geometryType:i,features:r,transform:n}=this;if(!n)return this;const{translate:[o,s],scale:[l,a]}=n;let u=null,c=null;if(this.hasZ&&null!=(null===n||void 0===n||null===(e=n.scale)||void 0===e?void 0:e[2])){const{translate:[,,e],scale:[,,t]}=n;u=i=>i*t+e}if(this.hasM&&null!=(null===n||void 0===n||null===(t=n.scale)||void 0===t?void 0:t[3])){const{translate:[,,,e],scale:[,,,t]}=n;c=i=>null==i?i:i*t+e}const d=this._getHydrationFunction(i,(e=>e*l+o),(e=>s-e*a),u,c);for(const{geometry:p}of r)null!=p&&d&&d(p);return this.transform=null,this}readFeaturesWithClass(e,t,i){const r=f.A.fromJSON(t.spatialReference),n=[];for(let s=0;s<e.length;s++){var o;const t=e[s],l=i.fromJSON(t),a=null===(o=t.geometry)||void 0===o?void 0:o.spatialReference;null==l.geometry||a||(l.geometry.spatialReference=r);const u=t.aggregateGeometries,c=l.aggregateGeometries;if(u&&null!=c)for(const e in c){const t=c[e],i=u[e],n=null===i||void 0===i?void 0:i.spatialReference;null==t||n||(t.spatialReference=r)}n.push(l)}return n}_quantizePoints(e,t,i){let r,n;const o=[];for(let s=0,l=e.length;s<l;s++){const l=e[s];if(s>0){const e=t(l[0]),s=i(l[1]);e===r&&s===n||(o.push([e-r,s-n]),r=e,n=s)}else r=t(l[0]),n=i(l[1]),o.push([r,n])}return o.length>0?o:null}_getQuantizationFunction(e,t,i){return"point"===e?e=>(e.x=t(e.x),e.y=i(e.y),e):"polyline"===e||"polygon"===e?e=>{const r=(0,y.Bi)(e)?e.rings:e.paths,n=[];for(let o=0,s=r.length;o<s;o++){const e=r[o],s=this._quantizePoints(e,t,i);s&&n.push(s)}return n.length>0?((0,y.Bi)(e)?e.rings=n:e.paths=n,e):null}:"multipoint"===e?e=>{const r=this._quantizePoints(e.points,t,i);return r&&r.length>0?(e.points=r,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,i,r,n){return"point"===e?e=>{e.x=t(e.x),e.y=i(e.y),r&&(e.z=r(e.z))}:"polyline"===e||"polygon"===e?e=>{const o=(0,y.Bi)(e)?e.rings:e.paths;let s,l;for(let r=0,n=o.length;r<n;r++){const e=o[r];for(let r=0,n=e.length;r<n;r++){const n=e[r];r>0?(s+=n[0],l+=n[1]):(s=n[0],l=n[1]),n[0]=t(s),n[1]=i(l)}}if(r&&n)for(let t=0,i=o.length;t<i;t++){const e=o[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=r(i[2]),i[3]=n(i[3])}}else if(r)for(let t=0,i=o.length;t<i;t++){const e=o[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=r(i[2])}}else if(n)for(let t=0,i=o.length;t<i;t++){const e=o[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=i(e.ymin),e.xmax=t(e.xmax),e.ymax=i(e.ymax),r&&null!=e.zmax&&null!=e.zmin&&(e.zmax=r(e.zmax),e.zmin=r(e.zmin)),n&&null!=e.mmax&&null!=e.mmin&&(e.mmax=n(e.mmax),e.mmin=n(e.mmin))}:"multipoint"===e?e=>{const o=e.points;let s,l;for(let r=0,n=o.length;r<n;r++){const e=o[r];r>0?(s+=e[0],l+=e[1]):(s=e[0],l=e[1]),e[0]=t(s),e[1]=i(l)}if(r&&n)for(let t=0,i=o.length;t<i;t++){const e=o[t];e[2]=r(e[2]),e[3]=n(e[3])}else if(r)for(let t=0,i=o.length;t<i;t++){const e=o[t];e[2]=r(e[2])}else if(n)for(let t=0,i=o.length;t<i;t++){const e=o[t];e[2]=n(e[2])}}:null}};(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,n._)([(0,u.MZ)({type:[o.A],json:{write:!0}})],v.prototype,"features",void 0),(0,n._)([(0,c.w)("features")],v.prototype,"readFeatures",null),(0,n._)([(0,u.MZ)({type:[m.A],json:{write:!0}})],v.prototype,"fields",void 0),(0,n._)([(0,u.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,n._)([(0,p.K)("geometryType")],v.prototype,"writeGeometryType",null),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,n._)([(0,u.MZ)({types:h.yR,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,n._)([(0,c.w)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,n._)([(0,u.MZ)({type:f.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,n._)([(0,p.K)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,n._)([(0,u.MZ)({json:{write:!0}})],v.prototype,"transform",void 0),v=r=(0,n._)([(0,d.$)("esri.rest.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0;const _=v},79369:(e,t,i)=>{i.d(t,{F:()=>a,Ti:()=>n});var r=i(30015);const n=-3,o=n-1;var s,l;(l=s||(s={}))[l.ALL=0]="ALL",l[l.SOME=1]="SOME";class a{get size(){return this._size}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new r.A,this._users=new r.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){var i;const r=this._db.get(e.id+t);return null!==(i=null===r||void 0===r?void 0:r.size)&&void 0!==i?i:0}put(e,t,i,r,l){t=e.id+t;const a=this._db.get(t);if(a&&(this._size-=a.size,e.size-=a.size,this._db.delete(t),a.entry!==i&&this._notifyRemove(t,a.entry,a.size,s.ALL)),r>this._maxSize)return void this._notifyRemove(t,i,r,s.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return console.warn("Refusing to cache entry with size ".concat(r," for key ").concat(t)),void this._notifyRemove(t,i,0,s.ALL);const c=1+Math.max(l,o)-n;this._db.set(t,new u(i,r,c)),this._size+=r,e.size+=r,this._checkSize()}updateSize(e,t,i,r){t=e.id+t;const n=this._db.get(t);if(n&&n.entry===i){for(this._size-=n.size,e.size-=n.size;r>this._maxSize;){const e=this._notifyRemove(t,i,r,s.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);r=e}n.size=r,this._size+=r,e.size+=r,this._checkSize()}}pop(e,t){t=e.id+t;const i=this._db.get(t);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(t),++this._hit,i.entry;++this._miss}get(e,t){t=e.id+t;const i=this._db.get(t);if(void 0!==i)return this._db.delete(t),i.lives=i.lifetime,this._db.set(t,i),++this._hit,i.entry;++this._miss}peek(e,t){const i=this._db.get(e.id+t);return i?++this._hit:++this._miss,null===i||void 0===i?void 0:i.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},i=new Array;this._db.forEach(((e,r)=>{const n=e.lifetime;i[n]=(i[n]||0)+e.size,this._users.forAll((i=>{const{id:n,name:o}=i;if(r.startsWith(n)){const i=t[o]||0;t[o]=i+e.size}}))}));const r={};this._users.forAll((e=>{const i=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const n=t[i]||0;t[i]=n,r[i]=Math.round(100*e.hitRate)+"%"}else r[i]="0%"}));const o=Object.keys(t);o.sort(((e,i)=>t[i]-t[e])),o.forEach((i=>e[i]=Math.round(t[i]/2**20)+"MB / "+r[i]));for(let s=i.length-1;s>=0;--s){const t=i[s];t&&(e["Priority "+(s+n-1)]=Math.round(t/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,i)=>{i.startsWith(t)&&(this._size-=e.size,this._db.delete(i),this._notifyRemove(i,e.entry,e.size,s.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,e.size,s.ALL))),this._users.forAll((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,i,r){let n;return this._removeFuncs.some((o=>{if(e.startsWith(o[0])){const e=o[1](t,r,i);return"number"==typeof e&&(n=e),!0}return!1})),n}_checkSize(){this._users.forAll((e=>this._checkSizeLimits(e))),this._checkSizeLimits()}_checkSizeLimits(e){const t=null!==e&&void 0!==e?e:this;if(t.maxSize<0||t.size<=t.maxSize)return;const i=null===e||void 0===e?void 0:e.id;let r=!0;for(;r;){r=!1;for(const[n,o]of this._db)if(0===o.lifetime&&(!i||n.startsWith(i))){if(this._purgeItem(n,o,e),t.size<=.9*t.maxSize)return;r||(r=this._db.has(n))}}for(const[n,o]of this._db)if((!i||n.startsWith(i))&&(this._purgeItem(n,o,e),t.size<=.9*t.maxSize))return}_purgeItem(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._users.find((t=>e.startsWith(t.id)));if(this._db.delete(e),t.lives<=1){this._size-=t.size,i&&(i.size-=t.size);const r=this._notifyRemove(e,t.entry,t.size,s.SOME);null!=r&&r>0&&(this._size+=r,i&&(i.size+=r),t.lives=t.lifetime,t.size=r,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}class u{constructor(e,t,i){this.entry=e,this.size=t,this.lifetime=i,this.lives=i}}},84202:(e,t,i)=>{i.d(t,{A7:()=>u,Cx:()=>c,Hk:()=>d,JJ:()=>h,SF:()=>p,UK:()=>a,jM:()=>f,x3:()=>y});i(81806);var r=i(86875),n=i(7246),o=i(76940),s=i(86659),l=i(44460);const a=o.A.fromJSON(l.Cb),u=n.A.fromJSON(l.yM),c=r.A.fromJSON(l.WR),d=s.A.fromJSON(l.JZ);function p(e){if(null==e)return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return a;case"polyline":return u;case"polygon":case"extent":return c}return null}const f=o.A.fromJSON(l.nC),y=n.A.fromJSON(l.HW),h=r.A.fromJSON(l.b6)},91485:(e,t,i)=>{i.d(t,{A:()=>f});var r=i(35143),n=i(69098),o=i(42553),s=i(46053),l=(i(81806),i(76460),i(47249),i(28379)),a=i(85842),u=i(17707),c=i(76866),d=i(15427);let p=class extends(n.A.ClonableMixin(o.A)){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const t={};for(const i of Object.keys(e))t[i]=(0,c.rS)(e[i]);return t}writeDomains(e,t){const i={};for(const n of Object.keys(e)){var r;e[n]&&(i[n]=null===(r=e[n])||void 0===r?void 0:r.toJSON())}t.domains=i}};(0,r._)([(0,s.MZ)({json:{write:!0}})],p.prototype,"id",void 0),(0,r._)([(0,s.MZ)({json:{write:!0}})],p.prototype,"name",void 0),(0,r._)([(0,s.MZ)({json:{write:!0}})],p.prototype,"domains",void 0),(0,r._)([(0,l.w)("domains")],p.prototype,"readDomains",null),(0,r._)([(0,u.K)("domains")],p.prototype,"writeDomains",null),(0,r._)([(0,s.MZ)({type:[d.A],json:{write:!0}})],p.prototype,"templates",void 0),p=(0,r._)([(0,a.$)("esri.layers.support.FeatureType")],p);const f=p},91524:(e,t,i)=>{i.d(t,{K:()=>p,Q:()=>u});var r=i(35143),n=i(45802),o=i(76460),s=i(46053),l=(i(81806),i(47249),i(6409)),a=i(85842);const u=(0,n.O)()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),c="percent-of-total",d="field",p=e=>{let t=class extends e{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,i=null!=this.normalizationTotal;return t||i?(e=t&&d||i&&c||null,t&&i&&o.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==d&&e!==c||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}};return(0,r._)([(0,s.MZ)({type:String,json:{name:"parameters.normalizationField",write:!0}})],t.prototype,"normalizationField",void 0),(0,r._)([(0,s.MZ)({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],t.prototype,"normalizationMaxValue",void 0),(0,r._)([(0,s.MZ)({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],t.prototype,"normalizationMinValue",void 0),(0,r._)([(0,s.MZ)({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],t.prototype,"normalizationTotal",void 0),(0,r._)([(0,l.e)(u,{name:"parameters.normalizationType"})],t.prototype,"normalizationType",null),t=(0,r._)([(0,a.$)("esri.rest.support.NormalizationBinParametersMixin")],t),t}},97763:(e,t,i)=>{i.d(t,{$w:()=>v,Bu:()=>N,DW:()=>C,FH:()=>G,FM:()=>c,G9:()=>s,GV:()=>M,Go:()=>d,K3:()=>j,Kn:()=>I,MM:()=>y,MO:()=>q,Nl:()=>O,Ny:()=>S,O2:()=>L,UE:()=>k,YC:()=>B,YF:()=>P,ZO:()=>E,_1:()=>T,_H:()=>w,_W:()=>_,_d:()=>z,bs:()=>D,dI:()=>K,e6:()=>p,gQ:()=>u,iA:()=>J,jn:()=>m,lW:()=>f,mA:()=>h,n5:()=>Z,pM:()=>F,pV:()=>x,pk:()=>$,rB:()=>U,s4:()=>o,xo:()=>A,yH:()=>b,yX:()=>Q,zb:()=>R,zr:()=>g});var r=i(89379),n=i(13442);function o(e,t,i,r){return function(e){return"function"==typeof e}(e)?e(t,i,r):e}function s(e){return[e.r,e.g,e.b,e.a]}const l=" /-,\n";function a(e){let t=e.length;for(;t--;)if(!l.includes(e.charAt(t)))return!1;return!0}function u(e,t){const i=[];let r=0,n=-1;do{if(n=e.indexOf("[",r),n>=r){if(n>r){const t=e.slice(r,n);i.push([t,null,a(t)])}if(r=n+1,n=e.indexOf("]",r),n>=r){if(n>r){const o=t[e.slice(r,n)];o&&i.push([null,o,!1])}r=n+1}}}while(-1!==n);if(r<e.length){const t=e.slice(r);i.push([t,null,a(t)])}return i}function c(e,t,i,r){let n="",o=null;for(const s of t){const[t,r,l]=s;if(t)l?o=t:(o&&(n+=o,o=null),n+=t);else{let t=r;null!=i&&(t=q(r,i));const s=e.attributes[t];s&&(o&&(n+=o,o=null),n+=s)}}return function(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}(n,r)}function d(e,t,i,r,n,o){let s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const l=t/n,a=i/o,u=Math.ceil(l/2),c=Math.ceil(a/2);for(let d=0;d<o;d++)for(let i=0;i<n;i++){const p=4*(i+(s?o-d-1:d)*n);let f=0,y=0,h=0,m=0,g=0,v=0,_=0;const M=(d+.5)*a;for(let r=Math.floor(d*a);r<(d+1)*a;r++){const n=Math.abs(M-(r+.5))/c,o=(i+.5)*l,s=n*n;for(let a=Math.floor(i*l);a<(i+1)*l;a++){let i=Math.abs(o-(a+.5))/u;const n=Math.sqrt(s+i*i);n>=-1&&n<=1&&(f=2*n*n*n-3*n*n+1,f>0&&(i=4*(a+r*t),_+=f*e[i+3],h+=f,e[i+3]<255&&(f=f*e[i+3]/250),m+=f*e[i],g+=f*e[i+1],v+=f*e[i+2],y+=f))}}r[p]=m/y,r[p+1]=g/y,r[p+2]=v/y,r[p+3]=_/h}}function p(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function f(e){var t,i;return null!==(t=null===(i=e.data)||void 0===i?void 0:i.symbol)&&void 0!==t?t:null}function y(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function h(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function m(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function g(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e||isNaN(e)?t:e},_=(e,t)=>null!=e?e:t,M=(e,t)=>null!==e&&void 0!==e?e:t,S=e=>e.tintColor?p(e.tintColor):[255,255,255,1],b=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function w(){return Promise.all([i.e(2612),i.e(7983)]).then(i.bind(i,1669))}function x(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function I(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function z(e){let t="normal",i="normal";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:t,weight:i}}function C(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function F(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=F(t);if(null!=e)return e}break;case"CIMTextSymbol":return F(e.symbol);case"CIMSolidFill":return e.color}return null}function T(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=T(e);if(null!=t)return t}break}case"CIMTextSymbol":return T(e.symbol);case"CIMSolidStroke":return e.color}}function A(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=A(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return A(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function N(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function O(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function L(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const k=e=>e.includes("data:image/svg+xml");function Z(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function P(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}function R(e,t,i,r,n,o){let s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const{infos:l}=o;let a=1,u=0,c=0,d=0,p=1;for(const{absoluteAnchorPoint:h,offsetX:m,offsetY:g,rotation:v,size:_,frameHeight:M,rotateClockWise:S,scaleSymbolsProportionally:b}of l)p=h?1:a,c=H(m,g,u,p,c),d=V(m,g,u,p,d),M&&(b||s)&&(a*=_/M),u=W(v,S,u);const f=H(r,n,u,p,c),y=V(r,n,u,p,d);return{size:e*a,rotation:W(t,i,u),offsetX:f,offsetY:y}}function E(e){if(null==e)return!1;if(Array.isArray(e))return e.every((e=>E(e)));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function J(e,t){if("color"===t||"outlinecolor"===t||"backgroundcolor"===t||"borderlinecolor"===t||"tintcolor"===t)return[...n.K[t]];const i=n.D[e];if(!i)throw new Error("InternalError: default value for type ".concat(e,"."));return i[t]}function j(e){return"string"==typeof e?function(e){return e.split(" ").map((e=>Number(e)))}(e):e}function G(e){return null!==e&&void 0!==e&&e.dashTemplate&&(e.dashTemplate=j(e.dashTemplate)),e}function D(e){var t;if(null==e)return"Normal";switch(e.type){case"CIMTextSymbol":return null!==(t=e.textCase)&&void 0!==t?t:"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const e of t)if("CIMVectorMarker"===e.type)return D(e)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const e of t)if(e.symbol)return D(e.symbol)}}return"Normal"}function B(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let i=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{var t;const e=null!==(t=r.size)&&void 0!==t?t:n.D.CIMVectorMarker.size;e>i&&(i=e);break}}return i}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=r.width;null!=e&&e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&g(r.markerPlacement)){var i;const e=null!==(i=r.size)&&void 0!==i?i:n.D.CIMVectorMarker.size;e>t&&(t=e)}break;case"CIMPictureFill":{const e=r.height;null!=e&&e>t&&(t=e)}}return t}}}function q(e,t){if(null!==t){const i=t.get(e);return i?i.name:e}return e}function $(e){return e.map((e=>(0,r.A)((0,r.A)({},e),{},{propertyName:P(e.propertyName)})))}function U(e){const t={};for(const i in e){const r=e[i];t[P(i)]=r}return t}function V(e,t,i,r,n){const o=i*Math.PI/180;if(o){const i=Math.cos(o);return(Math.sin(o)*e+i*t)*r+n}return t*r+n}function H(e,t,i,r,n){const o=i*Math.PI/180;return o?(Math.cos(o)*e-Math.sin(o)*t)*r+n:e*r+n}function W(e,t,i){return t?i-e:i+e}function K(e,t,i){const r="Color"===i||"TintColor"===i||"ToColor"===i,n="Rotation"===i||"Angle"===i||"ToRotation"===i;let o=t[P(i)];if(null!=o&&(r?o=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]:n&&(o*=Math.PI/180)),null==o&&(o=J(t.type,i.toLowerCase()),null!=o&&(r?o=[o[0]/255,o[1]/255,o[2]/255,o[3]]:n&&(o*=Math.PI/180))),null!=t.primitiveName){const s=e[t.primitiveName];if(null!=s){const e=s[i];null==e||("string"==typeof e||"number"==typeof e||Array.isArray(e)?(o=e,null!=o&&(r?o=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]:n&&(o*=Math.PI/180))):(o={valueExpressionInfo:e,defaultValue:o},null!=o&&(r?o={type:"Process",op:"ArcadeColor",value:o}:n&&(o={type:"Process",op:"Divide",left:o,right:180/Math.PI}))))}}if(null==o)throw new Error('Failed to derive a value or an expression for "'.concat(i,'".'));return o}function Q(e,t){return Math.max(Math.min((null!==e&&void 0!==e?e:t)/100,1),0)}}}]);
//# sourceMappingURL=4076.f69fedc3.chunk.js.map
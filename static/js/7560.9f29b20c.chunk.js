"use strict";(self.webpackChunkhousing_dashboard=self.webpackChunkhousing_dashboard||[]).push([[7560],{17560:(e,t,i)=>{i.d(t,{o:()=>De});var s=i(32743),r=i(89379),n=i(76931),o=i(5095),a=i(28736),c=i(43282),l=i(12258);class h extends l.r{}function u(e){const{sprite:t,isMapAligned:i,colorLocked:s,scaleSymbolsProportionally:r,isStroke:n}=e;let o=0;return i&&(o|=(0,a.mR)(c.c.bitset.isMapAligned)),s&&(o|=(0,a.mR)(c.c.bitset.colorLocked)),t.sdf&&(o|=(0,a.mR)(c.c.bitset.isSDF)),r&&(o|=(0,a.mR)(c.c.bitset.scaleSymbolsProportionally)),n&&(o|=(0,a.mR)(c.c.bitset.isStroke)),o}var d=i(90113),f=i(93345);class p extends h{get vertexSpec(){return{createComputedParams:e=>{var t;let{pixelDimensions:i,texelDimensions:s,baseSize:o,referenceSize:a,strokeWidth:c,sizeRatio:l}=e;i||(i=e.sprite.sdf?[0,0]:[e.sprite.width,e.sprite.height]),s||(s=e.sprite.sdf?[0,0]:i),o=(0,n.Lz)(o),a=(0,n.Lz)(a),c=(0,n.Lz)(c);const h=(null!==(t=e.sprite.sdfDecodeCoeff)&&void 0!==t?t:1)*l;return(0,r.A)((0,r.A)({},e),{},{pixelDimensions:i,texelDimensions:s,baseSize:o,referenceSize:a,strokeWidth:c,sdfDecodeCoeff:h})},optionalAttributes:{zoomRange:{type:f.pe.SHORT,count:2,packPrecisionFactor:o.fq,pack:(e,t)=>{let{scaleInfo:i}=e,{tileInfo:s}=t;return(0,a.My)(i,s)}}},attributes:{id:{type:f.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:f.pe.UNSIGNED_BYTE,count:1,pack:u},pos:{type:f.pe.SHORT,count:2,pack:"position",packPrecisionFactor:1},offset:{type:f.pe.FLOAT,count:2,packAlternating:{count:4,pack:e=>{const t=e.texelDimensions;return[[-.5*t[0],-.5*t[1]],[.5*t[0],-.5*t[1]],[-.5*t[0],.5*t[1]],[.5*t[0],.5*t[1]]]}}},uv:{type:f.pe.SHORT,count:2,packPrecisionFactor:1,packAlternating:{count:4,packTessellation:e=>{let{texXmax:t,texXmin:i,texYmax:s,texYmin:r}=e;return[[i,r],[t,r],[i,s],[t,s]]}}},animationPointerAndBaseSizeAndReferenceSize:{type:f.pe.UNSIGNED_SHORT,count:4,packPrecisionFactor:1,pack:e=>{let{animations:t,baseSize:i,referenceSize:s}=e;return[t.dataColumn,t.dataRow,i,s]}},sizing:{type:f.pe.UNSIGNED_SHORT,count:4,packPrecisionFactor:8,pack:e=>{let{strokeWidth:t,pixelDimensions:i,baseSize:s,sprite:r,sizeRatio:n}=e;const o=Math.max(s*r.width/r.height,s),a=r.sdfDecodeCoeff*o*n;return[i[0],i[1],t,a]}},angle:{type:f.pe.BYTE,count:1,packTessellation:e=>{let{angle:t}=e;return t}}}}}_write(e,t){const i=this.evaluatedMeshParams.sprite,{textureBinding:s}=i;e.recordStart(this.instanceId,this.attributeLayout,s);const r=t.getDisplayId();if("esriGeometryPolygon"===t.geometryType){const i=t.readCentroidForDisplay();if(!i)return;const[s,n]=i.coords;this._writeQuad(e,r,s,n)}else if("esriGeometryPoint"===t.geometryType){const i=t.readXForDisplay(),s=t.readYForDisplay();this._writeQuad(e,r,i,s)}else{const i=t.readGeometryForDisplay();if(i){const{angleToLine:t}=this.evaluatedMeshParams;if(t){let t=!0,s=null,n=null;i.forEachVertex(((i,o)=>{if(null!=s&&null!=n){const a=Math.atan2(o-n,i-s)/d.rp;t&&(this._writeQuad(e,r,s,n,a),t=!1),this._writeQuad(e,r,i,o,a)}s=i,n=o}))}else i.forEachVertex(((t,i)=>{this._writeQuad(e,r,t,i)}))}}e.recordEnd()}_writeQuad(e,t,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const n=this.evaluatedMeshParams.sprite,{rect:a}=n,c=a.x+o.hM,l=a.y+o.hM,h=a.x+a.width-o.hM,u=a.y+a.height-o.hM,d=e.vertexCount();e.recordBounds(i,s,64,64);const f={texXmin:c,texYmin:l,texXmax:h,texYmax:u,angle:r};for(let o=0;o<4;o++)this._writeVertex(e,t,i,s,f);e.indexEnsureSize(6),e.indexWrite(d),e.indexWrite(d+1),e.indexWrite(d+2),e.indexWrite(d+1),e.indexWrite(d+3),e.indexWrite(d+2)}}var m=i(81320),y=i(13308),_=i(33346),g=i(13720),v=i(88075),x=i(38550),M=i(9410),b=i(57156),P=i(98112),w=i(87663),A=i(94967),k=i(98006),S=i(19555),I=i(59422),z=i(72745),L=i(98618),D=i(1484),E=i(71447),R=i(23758),T=i(19358),B=i(19385),G=i(77555);function F(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function N(e,t){return Math.sqrt(e*e+t*t)}function C(e){const t=N(e[0],e[1]);e[0]/=t,e[1]/=t}function O(e,t){return N(e[0]-t[0],e[1]-t[1])}function W(e){return e.length-1}function Z(e){let t=0;for(let i=0;i<W(e);i++)t+=j(e,i);return t}function j(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,[s,r]=function(e,t){return e[t+1]}(e,t);return[s,r]=[Math.round(s),Math.round(r)],Math.sqrt(s*s+r*r)*i}class V{constructor(e,t,i,s,r){this._segments=e,this._index=t,this._distance=i,this._xStart=s,this._yStart=r,this._done=!1}static create(e){return new V(e,0,0,e[0][0],e[0][1])}clone(){return new V(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){const e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length);let i=Math.acos(t);return e>0&&(i=2*Math.PI-i),i}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:e,dy:t}=this;return Math.sqrt(e*e+t*t)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<W(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,t){const i=this.backwardLength;if(e<=i)return this._distance=(i-e)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>e)return this._seekBackwards(e-s);s+=this.length}return this._distance=0,t?this:null}seek(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let i=this.remainingLength;for(;this.next();){if(i+this.length>e)return this.seek(e-i,t);i+=this.length}return this._distance=1,t?this:null}}function q(e,t,i){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=Z(e),n=V.create(e),o=r/2;if(!s)return n.seek(o),void(Math.abs(n.x)<G.$u&&Math.abs(n.y)<G.$u&&i(n.clone(),0,o+0*t,r));const a=Math.max((r-t)/2,0),c=Math.floor(a/t),l=o-c*t;n.seek(l);for(let h=-c;h<=c;h++)Math.abs(n.x)<G.$u&&Math.abs(n.y)<G.$u&&i(n.clone(),h,o+h*t,r),n.seek(t)}function Y(e,t){const i=t;for(let s=0;s<e.length;s++){let t=e[s];Q(t,i);const r=[];r.push(t[0]);for(let e=1;e<t.length;e++){const[i,s]=t[e-1],[n,o]=t[e],a=n-i,c=o-s;r.push([a,c])}e[s]=r,t=r}return e}function Q(e,t){const i=1e-6;if(t<=0)return;const s=e.length;if(s<3)return;const r=[];let n=0;r.push(0);for(let u=1;u<s;u++)n+=O(e[u],e[u-1]),r.push(n);t=Math.min(t,.2*n);const o=[];o.push(e[0][0]),o.push(e[0][1]);const a=e[s-1][0],c=e[s-1][1],l=F([0,0],e[0],e[1]);C(l),e[0][0]+=t*l[0],e[0][1]+=t*l[1],F(l,e[s-1],e[s-2]),C(l),e[s-1][0]+=t*l[0],e[s-1][1]+=t*l[1];for(let u=1;u<s;u++)r[u]+=t;r[s-1]+=t;const h=.5*t;for(let u=1;u<s-1;u++){let n=0,a=0,c=0;for(let s=u-1;s>=0&&!(r[s+1]<r[u]-h);s--){const o=h+r[s+1]-r[u],l=r[s+1]-r[s],d=r[u]-r[s]<h?1:o/l;if(Math.abs(d)<i)break;const f=d*d,p=d*o-.5*f*l,m=d*l/t,y=e[s+1],_=e[s][0]-y[0],g=e[s][1]-y[1];n+=m/p*(y[0]*d*o+.5*f*(o*_-l*y[0])-f*d*l*_/3),a+=m/p*(y[1]*d*o+.5*f*(o*g-l*y[1])-f*d*l*g/3),c+=m}for(let o=u+1;o<s&&!(r[o-1]>r[u]+h);o++){const s=h-r[o-1]+r[u],l=r[o]-r[o-1],d=r[o]-r[u]<h?1:s/l;if(Math.abs(d)<i)break;const f=d*d,p=d*s-.5*f*l,m=d*l/t,y=e[o-1],_=e[o][0]-y[0],g=e[o][1]-y[1];n+=m/p*(y[0]*d*s+.5*f*(s*_-l*y[0])-f*d*l*_/3),a+=m/p*(y[1]*d*s+.5*f*(s*g-l*y[1])-f*d*l*g/3),c+=m}o.push(n/c),o.push(a/c)}o.push(a),o.push(c);for(let u=0,d=0;u<s;u++)e[u][0]=o[d++],e[u][1]=o[d++]}var X=i(81615);const H=(0,w.Bj)((e=>{let t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t}));class $ extends X.G8{constructor(){super(...arguments),this._zoomLevel=0}_write(e,t,i,s){if(this._zoomLevel=s||0,null!=i)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(t.geometryType){case"esriGeometryPoint":{const i=t.readXForDisplay(),s=t.readYForDisplay();this._writePoint(e,i,s,t);break}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const i=t.readCentroidForDisplay();if(!i)return;const[s,r]=i.coords;this._writePoint(e,s,r,t);break}case"esriGeometryPolyline":this._writeLines(e,t)}}_getMetricDir(){const{horizontalAlignment:e,verticalAlignment:t}=this.evaluatedMeshParams;return["center"===e?0:"right"===e?-1:1,"middle"===t?0:"bottom"===t?-1:1]}_createLineLabelMetric(e,t,i,s){var r,n,o,a;const c=(0,R.Q4)(e),[l,h]=this._getMetricDir(),u=null!==(r=null===(n=this.evaluatedMeshParams.scaleInfo)||void 0===n?void 0:n.maxScale)&&void 0!==r?r:0,d=null!==(o=null===(a=this.evaluatedMeshParams.scaleInfo)||void 0===a?void 0:a.minScale)&&void 0!==o?o:0;return new B.f(c,t,i,l,h,u,d,null!==s&&void 0!==s?s:null)}_writePoint(e,t,i,s){var r,n,o,a;const c=this._getShaping();if(!c)return;const l=s.getDisplayId(),h=(0,E.xy)(this.evaluatedMeshParams.horizontalAlignment),u=(0,E.UD)(this.evaluatedMeshParams.verticalAlignment),d=null!==(r=null===(n=this.evaluatedMeshParams.scaleInfo)||void 0===n?void 0:n.maxScale)&&void 0!==r?r:0,f=null!==(o=null===(a=this.evaluatedMeshParams.scaleInfo)||void 0===a?void 0:a.minScale)&&void 0!==o?o:0,p=(0,R.Q4)(s.getDisplayId()),m=this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0};e.metricStart(new B.f(p,t,i,h,u,d,f,m)),this._writeGlyphs(e,l,t,i,c,0,m),e.metricBoxWrite(c.boundsT),e.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const e of this._references){const t=e.getBoundsInfo();if(t)return t}return null}_writeLines(e,t){const{scaleInfo:i,verticalAlignment:s}=this.evaluatedMeshParams,r=this.evaluatedMeshParams.repeatLabelDistance||128,n=this._getShaping("middle");if(!n)return;const o=(e,t,i,s)=>this._placeSubdivGlyphs(e,t,i,s),c=(n.bounds.width+r)/2;this._current={out:e,id:t.getDisplayId(),shaping:n,zoomRange:(0,a.My)(i,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0},offsetDirection:null},this._verticalPlacement="bottom"===s?"above":"top"===s?"below":null,this._verticalPlacement?this._writeAboveAndBelowAlong(t,o,c):this._writeCenterAlong(t,o,c)}_writeAboveAndBelowAlong(e,t,i){const{repeatLabel:s}=this.evaluatedMeshParams,{shaping:r}=this._current,n=r.bounds.halfHeight,o=e.readGeometryForDisplay();if(!o)return;const a=new D.A;(0,L.kz)(a,o,!1,!1,"esriGeometryPolyline",1);const c=J(new D.A,a,n),l=J(new D.A,a,-n),h=(0,L.zv)(l,"esriGeometryPolyline",!1,!1),u=Y((0,L.zv)(c,"esriGeometryPolyline",!1,!1).paths,r.bounds.width),d=Y(h.paths,r.bounds.width);this._current.offsetDirection="above";for(const f of u)q(f,i,t,!!s);this._current.offsetDirection="below";for(const f of d)q(f,i,t,!!s)}_writeCenterAlong(e,t,i){const{repeatLabel:s}=this.evaluatedMeshParams,{shaping:r}=this._current,n=Y(e.readLegacyGeometryForDisplay().paths,r.bounds.width);for(const o of n)q(o,i,t,!!s)}_placeSubdivGlyphs(e,t,i,s){const{allowOverrun:r,labelPosition:n,repeatLabelDistance:o}=this.evaluatedMeshParams,a=this._current.zoomRange[0],c=H(t),l=this._current.shaping.bounds.width/2,h=Math.sqrt(o||128)/2,u=Math.min(i,s-i),d=this._current.shaping.isMultiline?X.GJ:Math.log2(u/(h+l/2)),f=0===t?d:Math.min(c,d),p=Math.max(a,this._zoomLevel+1-f),m=this._zoomLevel-p,y=this._current.shaping.bounds.width/2*2**m;this._current.shaping.isMultiline?0===t&&this._placeStraight(e,p):r&&m<0?this._placeStraightAlong(e,a):"parallel"===n?this._placeStraightAlong(e,p):"curved"===n&&this._placeCurved(e,p,y)}_placeStraight(e,t){const{out:i,id:s,shaping:r,referenceBounds:n}=this._current,{x:o,y:a}=e;i.metricStart(this._createLineLabelMetric(s,o,a)),i.metricBoxWrite(r.boundsT);const c=e.angle*(180/Math.PI)%360,l=(e.angle*(180/Math.PI)+180)%360;this._writeGlyphs(i,s,o,a,r,0,n,{clipAngle:c,mapAligned:!0,isLineLabel:!0,minZoom:t}),this._writeGlyphs(i,s,o,a,r,0,n,{clipAngle:l,mapAligned:!0,isLineLabel:!0,minZoom:t}),i.metricEnd()}_placeCurved(e,t,i){const{out:s,id:r}=this._current;s.metricStart(this._createLineLabelMetric(r,e.x,e.y));const n=e.clone(),o=e.angle*(180/Math.PI)%360,a=(e.angle*(180/Math.PI)+180)%360;this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||(this._placeFirst(n,t,1,o),this._placeBack(e,n,t,i,1,o),this._placeForward(e,n,t,i,1,o)),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||(this._placeFirst(n,t,0,a),this._placeBack(e,n,t,i,0,a),this._placeForward(e,n,t,i,0,a)),s.metricEnd()}_placeStraightAlong(e,t){const{out:i,id:s,shaping:r,zoomRange:o,referenceBounds:a}=this._current,{boxBorderLineColor:c,boxBackgroundColor:l}=this.evaluatedMeshParams,h=e.clone(),u=e.angle*(180/Math.PI)%360,d=(e.angle*(180/Math.PI)+180)%360,f=r.glyphs.length>0&&!(!c&&!l);if(i.metricStart(this._createLineLabelMetric(s,e.x,e.y)),f){const c=Math.max(t,o[0],0),l=Math.min(X.GJ,o[1]),h=(0,A.$0)((0,k.vt)(),-e.angle),f={minZoom:c,maxZoom:l,clipAngle:u,mapAligned:!0,isLineLabel:!0},p=(0,n.Lz)(this.evaluatedMeshParams.offsetX),m=(0,n.Lz)(this.evaluatedMeshParams.offsetY);if(!this._verticalPlacement||this._verticalPlacement===this._current.offsetDirection){const t=(0,I.fA)(p,-1*m),[n,o]=r.shapeBackground((0,A.Tl)((0,k.vt)(),h,t));i.recordStart(this.instanceId,this.attributeLayout,r.glyphs[0].textureBinding);const c=2*Math.max(n.width,n.height);i.recordBounds(e.x+n.x,e.y+n.y,c,c),this._writeTextBox(i,s,e.x,e.y,o,a,f),i.recordEnd()}if(!this._verticalPlacement||this._verticalPlacement!==this._current.offsetDirection){const t=(0,I.fA)(p,m),[n,o]=r.shapeBackground((0,A.Tl)((0,k.vt)(),h,t));f.clipAngle=d,i.recordStart(this.instanceId,this.attributeLayout,r.glyphs[0].textureBinding);const c=2*Math.max(n.width,n.height);i.recordBounds(e.x+n.x,e.y+n.y,c,c),this._writeTextBox(i,s,e.x,e.y,o,a,f),i.recordEnd()}}this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||this._placeFirst(h,t,1,u,!0),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||this._placeFirst(h,t,0,d,!0),i.metricEnd()}_placeBack(e,t,i,s,r,n){const o=e.clone();let a=e.backwardLength+0;for(;o.prev()&&!(a>=s);)this._placeOnSegment(o,t,a,i,-1,r,n),a+=o.length+0}_placeForward(e,t,i,s,r,n){const o=e.clone();let a=e.remainingLength+0;for(;o.next()&&!(a>=s);)this._placeOnSegment(o,t,a,i,1,r,n),a+=o.length+0}_placeFirst(e,t,i,s){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{out:o,id:a,shaping:c,zoomRange:l,referenceBounds:h}=this._current,u=c.glyphs,d=(0,n.Lz)(this.evaluatedMeshParams.offsetX),f=(0,n.Lz)(this.evaluatedMeshParams.offsetY),p=(0,I.fA)(d,f),m=(0,A.$0)((0,k.vt)(),-e.angle);(0,S.l0)(p,p,m);for(const n of u){const u=n.x>c.bounds.x?i:1-i,d=u*e.remainingLength+(1-u)*e.backwardLength,f=Math.abs(n.x+n.width/2-c.bounds.x),m=Math.max(0,this._zoomLevel+Math.log2(f/(d+0))),y=Math.max(t,r?0:m);if(n.maxZoom=Math.min(l[1],X.GJ),n.angle=e.angle+(1-i)*Math.PI,n.minZoom=Math.max(l[0],y),this._writeLineGlyph(o,a,e.x,e.y,c.bounds,n,s,h,!0),(i||this._current.offsetDirection)&&this._isVisible(n.minZoom,n.maxZoom)){const e=new T.A(n.bounds.x+p[0],n.bounds.y+p[1],n.bounds.width,n.bounds.height);o.metricBoxWrite(e)}}}_placeOnSegment(e,t,i,s,r,o,a){const{out:c,id:l,shaping:h,referenceBounds:u}=this._current,d=h.glyphs,f=e.dx/e.length,p=e.dy/e.length,m={x:e.x+i*-r*f,y:e.y+i*-r*p},y=(0,n.Lz)(this.evaluatedMeshParams.offsetX),_=(0,n.Lz)(this.evaluatedMeshParams.offsetY),g=(0,I.fA)(y,_),v=(0,A.$0)((0,k.vt)(),-e.angle);(0,S.l0)(g,g,v);for(const n of d){const t=n.x>h.bounds.x?o:1-o;if(!(t&&1===r||!t&&-1===r))continue;const d=Math.abs(n.x+n.width/2-h.bounds.x),f=Math.max(0,this._zoomLevel+Math.log2(d/i)-.1),p=Math.max(s,this._zoomLevel+Math.log2(d/(i+e.length+0)));if(0!==f&&(n.angle=e.angle+(1-o)*Math.PI,n.minZoom=p,n.maxZoom=f,this._writeLineGlyph(c,l,m.x,m.y,h.bounds,n,a,u,!0),(o||this._current.offsetDirection)&&this._isVisible(n.minZoom,n.maxZoom))){const e=new T.A(n.bounds.x+g[0],n.bounds.y+g[1],n.bounds.width,n.bounds.height);c.metricBoxWrite(e)}}}_writeLineGlyph(e,t,i,s,r,n,o,c,l){const h=i+r.x,u=s+r.y,d=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),f=Math.max(r.width,r.height)*d;e.recordStart(this.instanceId,this.attributeLayout,n.textureBinding),e.recordBounds(h,u,f,f);const{texcoords:p,offsets:m}=n,{fontSize:y,haloSize:_,outlineSize:g}=this._textMeshTransformProps;this._writeQuad(e,t,i,s,{texcoords:p,offsets:m,fontSize:y,haloSize:_,outlineSize:g,color:(0,a.Jb)(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:c,minZoom:Math.max(this._current.zoomRange[0],n.minZoom),maxZoom:Math.min(this._current.zoomRange[1],n.maxZoom),clipAngle:o,mapAligned:l,isLineLabel:!0}),e.recordEnd()}_isVisible(e,t){const i=Math.floor(this._zoomLevel*o.fq)/o.fq;return e<=i&&i<=t}}function J(e,t,i){const{coords:s,lengths:r}=t,n=(0,z.vt)(),o=(0,z.vt)(),a=(0,z.vt)(),c=(0,z.vt)(),l=(0,z.vt)(),h=(0,z.vt)();let u=0;for(let d=0;d<r.length;d++){const t=r[d];for(let r=0;r<t;r++){const d=2*(r+u-1),f=2*(r+u),p=2*(r+u+1);r>0?(0,S.hZ)(n,s[d],s[d+1]):(0,S.hZ)(n,0,0),(0,S.hZ)(o,s[f],s[f+1]),r<t-1?(0,S.hZ)(a,s[p],s[p+1]):(0,S.hZ)(a,0,0),0===r?(0,S.hZ)(c,0,0):((0,S.jb)(c,o,n),(0,S.S8)(c,c),(0,S.hZ)(c,c[1],-c[0])),r===t-1?(0,S.hZ)(l,0,0):((0,S.jb)(l,a,o),(0,S.S8)(l,l),(0,S.hZ)(l,l[1],-l[0])),(0,S.WQ)(h,c,l),(0,S.S8)(h,h);const m=h[0]*l[0]+h[1]*l[1];0!==m&&(0,S.hs)(h,h,m),(0,S.hs)(h,h,i),e.coords.push(o[0]+h[0],o[1]+h[1])}e.lengths.push(t),u+=t}return e}var U=i(29300),K=i(64346),ee=i(26455),te=i(4480),ie=i(18690),se=i(50076),re=i(53084),ne=i(76460),oe=i(98976),ae=i(95776),ce=i(62484);function le(e){return e instanceof he?e:"object"==typeof e&&"type"in e?pe[e.type].hydrate(e):new ue(e)}class he{constructor(e){this.inputs=e}encode(){const e=[];for(const t of this.inputs)e.push(...t.encode());return e.push(...this.instructions),e}}class ue extends he{constructor(e){super([]),this.value=e}simplify(){return this}get instructions(){if(Array.isArray(this.value)){const[e,t,i,s]=this.value;return null!=s?ce.GA.vector4.encode([e,t||0,i||0,s]):ce.GA.vector3.encode([e,t||0,i||0])}return ce.GA.scalar.encode(this.value)}}class de extends he{constructor(e,t){super([t]),this._config=e,this._parent=t}static hydrate(e){return new de(e,le(e.parent))}simplify(){if(this._config.relativeTranslation||this._config.absoluteScale)return this;const e=this._parent.simplify();if(!(e instanceof ue))return this;const[t,i,s,r]=e.value,n=this._config.translation.from[0],o=this._config.translation.from[1],a=this._config.rotation.from,c=this._config.scale.from;if(n===this._config.translation.to[0]&&o===this._config.translation.to[1]&&a===this._config.rotation.to&&c===this._config.scale.to){const e=s+a,l=r*c,h=Math.sin(s),u=Math.cos(s);return new ue([u*r*n-h*r*o+t,h*r*n+u*r*o+i,e,l])}return new de(this._config,e)}get instructions(){return ce.GA.animatedTransform.encode(this._config)}}class fe extends he{constructor(e,t){super([t]),this._config=e,this._parent=t}static hydrate(e){return new fe(e,le(e.parent))}simplify(){const e=this._parent.simplify();if(!(e instanceof ue))return this;const[t,i,s,r]=e.value,n=this._config.color.from[0],o=this._config.color.from[1],a=this._config.color.from[2];let c=this._config.color.from[3];const l=this._config.opacity.from;return n===this._config.color.to[0]&&o===this._config.color.to[1]&&a===this._config.color.to[2]&&c===this._config.color.to[3]&&l===this._config.opacity.to?(c*=l,new ue([t*n,i*o,s*a,r*c])):new fe(this._config,e)}get instructions(){return ce.GA.animatedColor.encode(this._config)}}const pe={AnimatedTransform:de,AnimatedColor:fe};var me=i(69539);function ye(e){return ge(e.map((e=>xe(e))).map((e=>le(e).simplify())))}function _e(e){const t=[];return t.push(e.transform),t.push(e.fromColor),t.push(e.toColor),t.push(e.colorMix),t.push(e.toOpacity),t.push(e.opacityMix),t}function ge(e){const t=[],i=[];let s=0;for(const r of e){const n=[...r.encode(),...ce.GA.ret.encode()];t.push([s+e.length,0,0,0]),i.push(...n),s+=n.length}return[...t,...i]}async function ve(e,t){const i=e;let s;if("number"==typeof i||"string"==typeof i||"boolean"==typeof i)s=i;else if(Array.isArray(i))s=await Promise.all(i.map((e=>ve(e,t))));else if("object"==typeof i)if("valueExpressionInfo"in i){const{valueExpressionInfo:e}=i,{expression:n}=e;s=(0,r.A)((0,r.A)({},i),{},{computed:await t.createComputedField({expression:n})})}else{s={};for(const e in i)s[e]=await ve(i[e],t)}return s}function xe(e,t,i){const s=e;let r;if("number"==typeof s||"string"==typeof s||"boolean"==typeof s)r=s;else if(Array.isArray(s))r=s.map((e=>xe(e,t,i)));else if("object"==typeof s)if("type"in s&&null!=s.type&&"Process"===s.type)switch(s.op){case"ArcadeColor":{const e=xe(s.value,t,i);be(Array.isArray(e)&&4===e.length),r=[e[0]/255,e[1]/255,e[2]/255,e[3]]}break;case"Transparency":{const e=xe(s.value,t,i);be("number"==typeof e),r=1-e/100}break;case"Divide":case"Add":{const e=xe(s.left,t,i);be("number"==typeof e);const n=xe(s.right,t,i);switch(be("number"==typeof n),s.op){case"Divide":r=e/n;break;case"Add":r=e+n}}break;case"Random":{const e=xe(s.seed,t,i),n=xe(s.min,t,i),o=xe(s.max,t,i),a=t.getObjectId(),c=(0,ae.A)(a||0);r=n+(0,ae.J)(c,e)*(o-n)}break;case"Cond":{const e=xe(s.condition,t,i),n=xe(s.ifTrue,t,i),o=xe(s.ifFalse,t,i);r=e?n:o}break;case"MatchWinding":{const e=xe(s.sign,t,i);let n=xe(s.angle,t,i);if(e>0)for(;n<0;)n+=2*Math.PI;else for(;n>0;)n-=2*Math.PI;r=n}}else if("computed"in s)r=function(e){if(!("computed"in e))return e;let s=e.computed.readWithDefault(t,i,[255*e.defaultValue[0],255*e.defaultValue[1],255*e.defaultValue[2],e.defaultValue[3]]);if("string"==typeof s){const e=me.A.fromString(s);e&&(s=[e.r,e.g,e.b,e.a])}return s}(s);else{r={};for(const e in s)r[e]=xe(s[e],t,i)}return r}function*Me(e){const t=e;if(Array.isArray(t))for(const i of t)yield*Me(i);else if("object"==typeof t)if("type"in t&&null!=t.type&&"Process"===t.type)switch(t.op){case"ArcadeColor":case"Transparency":yield*Me(t.value);break;case"Divide":case"Add":yield*Me(t.left),yield*Me(t.right);break;case"Random":yield*Me(t.seed),yield*Me(t.min),yield*Me(t.max);break;case"Cond":yield*Me(t.condition),yield*Me(t.ifTrue),yield*Me(t.ifFalse);break;case"MatchWinding":yield*Me(t.sign),yield*Me(t.angle)}else if("computed"in t)yield t.computed;else for(const i in t)yield*Me(t[i])}function be(e){if(!e)throw new Error("Assertion failed.")}var Pe=i(27534),we=i(74014);async function Ae(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{defaultValue:s,valueExpressionInfo:n,value:o}=t;if(n){const{expression:o}=n,a=await e.createComputedField({expression:o},i);return a?(0,r.A)((0,r.A)({},t),{},{computed:a,defaultValue:s}):null}return(0,r.A)((0,r.A)({},t),{},{computed:new we.G(o),defaultValue:s})}async function ke(e,t){const{valueExpressionInfo:i}=t,{expression:s}=i,n=await e.createComputedField({expression:s});return n?(0,r.A)((0,r.A)({},t),{},{computed:n}):null}function Se(e){return"object"==typeof e&&null!=e&&(!(!("valueExpressionInfo"in e)||!e.valueExpressionInfo)||"type"in e&&"Process"===e.type&&"op"in e&&"Random"===e.op)}function Ie(e){if(Array.isArray(e))for(const t of e)if(Ie(t))return!0;if("object"==typeof e){if(Se(e))return!0;for(const t in e)if(Ie(e[t]))return!0}return!1}class ze{static async create(e,t,i){const s={},r=new Map,n=new Map,o=new Map,a=new Map,c=new Map,l=new Map;for(const d in i){const f=i[d];if(null!=f&&"object"==typeof f)if(Array.isArray(f)){if("object"==typeof f[0])throw new Error("InternalError: Cannot handle ".concat(d,". Nested array params are not supported"));s[d]=f}else if("valueExpressionInfo"in f){if(f.value){s[d]=f.value;continue}const t=await ke(e,f);if(!t){s[d]=f.defaultValue;continue}r.set(d,t),s[d]=null}else switch(f.type){case"cim-effect-infos":if(f.effectInfos.some((e=>e.overrides.length))){n.set(d,{effects:await Promise.all(f.effectInfos.map((async t=>{const i=t.overrides.map((t=>Ae(e,t)));return{effect:t.effect,compiledOverrides:(await Promise.all(i)).filter(ie.Ru)}})))});break}s[d]=f.effectInfos.map((e=>e.effect));break;case"cim-marker-placement-param":f.overrides.length&&o.set(d,{placementInfo:f,compiledOverrides:(await Promise.all(f.overrides.map((t=>Ae(e,t))))).filter(ie.Ru)}),s[d]=f.placement;break;case"text-rasterization-param":{var h;if(f.overrides.length){const t=f.overrides.map((t=>Ae(e,t,f.useLegacyLabelEvaluationRules)));a.set(d,{compiledOverrides:(await Promise.all(t)).filter(ie.Ru),rasterizationParam:f,objectIdToResourceId:new Map});continue}const i={type:"cim-rasterization-info",resource:f.resource};s[d]=null!==(h=await t.fetchResourceImmediate(i))&&void 0!==h?h:null;break}case"sprite-rasterization-param":{var u;if(f.overrides.length){const t=f.overrides.map((t=>Ae(e,t)));a.set(d,{compiledOverrides:(await Promise.all(t)).filter(ie.Ru),rasterizationParam:f,objectIdToResourceId:new Map});continue}if("animated"===f.resource.type){a.set(d,{compiledOverrides:[],rasterizationParam:f,objectIdToResourceId:new Map});continue}const i={type:"cim-rasterization-info",resource:f.resource};s[d]=null!==(u=await t.fetchResourceImmediate(i))&&void 0!==u?u:null;break}case"cim-marker-transform-param":{const{params:t}=f;if(Ie(t)){const i={compiledMarkerInfos:[]};await Promise.all(t.map((async t=>{const s={props:{}};for(const i in t)if(Se(t[i])){const r=await ke(e,t[i]);s.compiledExpressionMap||(s.compiledExpressionMap=new Map);const n=s.compiledExpressionMap;r&&n.set(i,r)}else s.props[i]=t[i];i.compiledMarkerInfos.push(s)}))),c.set(d,i)}else s[d]={type:"cim-marker-transform-info",infos:t};break}case"animation-params":{const{params:i}=f,r=_e(i);if(Ie(r)){const t=await Promise.all(r.map((t=>ve(t,e))));l.set(d,{params:t,propertyIdToResourceId:new Map,key:d})}else{const e=ye(r),i=await t.fetchResourceImmediate({type:"animation-info",resource:e});null!=i&&"sprite"===i.type&&(s[d]={dataRow:i.rect.y,dataColumn:i.rect.x})}break}default:s[d]=f}else s[d]=f}return new ze(i,s,r,n,o,a,c,l)}constructor(e,t,i,s,r,n,o,a){this.inputMeshParams=e,this._resolvedMeshParams=t,this._dynamicProperties=i,this._dynamicEffectProperties=s,this._dynamicPlacementProperties=r,this._dynamicAsyncProperties=n,this._dynamicTransformProperties=o,this._dynamicAsyncAnimations=a,this.evaluator=e=>e,this._arcadeDependencies=new Set;for(const c of this._expressions())(0,oe.QY)(this._arcadeDependencies,c)}get hasDynamicProperties(){return!!(this._dynamicProperties.size||this._dynamicAsyncProperties.size||this._dynamicEffectProperties.size||this._dynamicTransformProperties.size||this._dynamicPlacementProperties.size||this._dynamicAsyncAnimations.size)}get evaluatedMeshParams(){return this._evaluatedMeshParams||(this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams)),this._evaluatedMeshParams}enqueueRequest(e,t,i){for(const s of this._dynamicAsyncProperties.values()){const r=(0,re.o8)(s.rasterizationParam.resource);"animated"===s.rasterizationParam.resource.type&&s.rasterizationParam.resource.randomizeStartTime&&(r.primitiveName="__RESERVED__PRIMITIVE__NAME__",r.startGroup=(0,ae.A)(t.getObjectId()||0));for(const{primitiveName:e,propertyName:o,computed:a,defaultValue:c,valueExpressionInfo:l}of s.compiledOverrides)try{const n="animated"===s.rasterizationParam.resource.type?r.primitiveName:e;(0,Pe.Ph)(r,n,o,a,t,i,c)}catch(N){ne.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.mesh.MeshWriterInputEvaluator").errorOnce(new se.A("invalid-arcade-expression","Encountered an error when evaluating the arcade expression '".concat(null===l||void 0===l?void 0:l.expression,"' (primitive: '").concat(e,"', property: '").concat(o,"')"),N))}const n=e.enqueueRequest({type:"cim-rasterization-info",resource:r});s.objectIdToResourceId.set(t.getObjectId(),n)}for(const s of this._dynamicAsyncAnimations.values()){const r=s.params.map((e=>xe(e,t,i))).map(le).map((e=>e.simplify())),n=ge(r),o=e.enqueueRequest({type:"animation-info",resource:n});s.propertyIdToResourceId.set(t.getObjectId()+"."+s.key,o)}}evaluateMeshParams(e,t,i){for(const[s,r]of this._dynamicProperties.entries())this._resolvedMeshParams[s]=r.computed.readWithDefault(t,i,r.defaultValue);for(const[s,r]of this._dynamicPlacementProperties.entries())for(const{computed:e,defaultValue:n,propertyName:o}of r.compiledOverrides){const a=e.readWithDefault(t,i,n);r.placementInfo.placement[o]=a,this._resolvedMeshParams[s]=r.placementInfo.placement}for(const[s,r]of this._dynamicEffectProperties.entries())for(const e of r.effects){for(const{computed:s,defaultValue:r,propertyName:n}of e.compiledOverrides){const o=s.readWithDefault(t,i,r);e.effect[n]=o}this._resolvedMeshParams[s]=r.effects.map((e=>e.effect))}for(const[s,n]of this._dynamicTransformProperties.entries()){const e={type:"cim-marker-transform-info",infos:[]};for(const s of n.compiledMarkerInfos){const n=(0,r.A)({},s.props);if(s.compiledExpressionMap)for(const[e,r]of s.compiledExpressionMap){const s=r.computed.readWithDefault(t,i,r.defaultValue);n[e]="number"==typeof s||"boolean"==typeof s?s:r.defaultValue}e.infos.push(n)}this._resolvedMeshParams[s]=e}for(const[s,r]of this._dynamicAsyncProperties.entries()){const i=r.objectIdToResourceId.get(t.getObjectId());if(null==i)continue;const n=e.getResource(i);this._resolvedMeshParams[s]=n}for(const[s,r]of this._dynamicAsyncAnimations.entries()){const i=r.propertyIdToResourceId.get(t.getObjectId()+"."+s);if(null==i)continue;const n=e.getResource(i);this._resolvedMeshParams[s]={dataRow:n.rect.y,dataColumn:n.rect.x}}return this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams),this.evaluatedMeshParams}hasArcadeDependency(e){return this._arcadeDependencies.has(e)}*_expressions(){for(const e of this._dynamicProperties.values())yield e.computed;for(const e of this._dynamicEffectProperties.values())for(const t of e.effects)for(const e of t.compiledOverrides)yield e.computed;for(const e of this._dynamicPlacementProperties.values())for(const t of e.compiledOverrides)yield t.computed;for(const e of this._dynamicAsyncProperties.values())for(const t of e.compiledOverrides)yield t.computed;for(const e of this._dynamicTransformProperties.values())for(const t of e.compiledMarkerInfos)if(null!=t.compiledExpressionMap)for(const e of t.compiledExpressionMap.values())yield e.computed;for(const e of this._dynamicAsyncAnimations.values())for(const t of e.params)yield*Me(t)}}var Le=i(41406);class De{async createMeshWriter(e,t,i,s){const r=this._getMeshWriter(s.techniqueType),n=await ze.create(e,t,s.inputParams),o=new r(s.id,n,s.optionalAttributes,i);return await o.loadDependencies(),o}_getMeshWriter(e){switch(e){case s.N.Fill:return g.Y;case s.N.DotDensity:return m.k;case s.N.ComplexFill:return y.KE;case s.N.PatternFill:return M.m;case s.N.GradientFill:return v.S;case s.N.OutlineFill:return x.w0;case s.N.PatternOutlineFill:return b.Q;case s.N.ComplexOutlineFill:return _.O;case s.N.Marker:return te.H;case s.N.PieChart:return Le.v;case s.N.Text:return X.G8;case s.N.Line:return K.Bw;case s.N.TexturedLine:return ee.K;case s.N.GradientStroke:return U.F;case s.N.Heatmap:return P.h;case s.N.Label:return $;case s.N.AnimatedMarker:return p;default:throw new Error("Internal Error: Mesh writer not in the registry")}}}},74014:(e,t,i)=>{i.d(t,{G:()=>r});var s=i(33219);class r extends s.L{constructor(e){super(),this._value=e}resize(e){}read(e,t){return this._value}readWithDefault(e,t,i){return this._value}hasArcadeDependency(e){return!1}}},95776:(e,t,i)=>{i.d(t,{A:()=>n,J:()=>r});var s=i(88685);function r(e,t){let i;if("string"==typeof e)i=(0,s.Wm)(e+"-seed(".concat(t,")"));else{let s=12;i=e^t;do{i=107*(i>>8^i)+s|0}while(0!=--s)}return(1+i/(1<<31))/2}function n(e){return Math.floor(r(e,o)*a)}const o=53290320,a=10}}]);
//# sourceMappingURL=7560.9f29b20c.chunk.js.map
"use strict";(self.webpackChunkhousing_dashboard=self.webpackChunkhousing_dashboard||[]).push([[3814],{11668:(e,t,r)=>{r.d(t,{K:()=>p,Q:()=>i});var a=r(53986),n=r(67061);const l=["loadContext"],o=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function i(e,t){var r;const o=t||{},{loadContext:i}=o,u=(0,a.A)(o,l),s=i?await i.fetchServiceMetadata(e,u):await(0,n.V)(e,u);v(s),c(s);const d={serviceJSON:s};if((null!==(r=s.currentVersion)&&void 0!==r?r:0)<10.5)return d;const y="".concat(e,"/layers"),p=i?await i.fetchServiceMetadata(y,u):await(0,n.V)(y,u);return v(p),c(p),d.layersJSON={layers:p.layers,tables:p.tables},d}function u(e){const{type:t}=e;return!!t&&o.has(t)}function s(e){return"Table"===e.type}function c(e){var t,r;e.layers=null===(t=e.layers)||void 0===t?void 0:t.filter(u),e.tables=null===(r=e.tables)||void 0===r?void 0:r.filter(s)}function d(e){e.type||(e.type="Feature Layer")}function y(e){e.type||(e.type="Table")}function v(e){var t,r;null!==(t=e.layers)&&void 0!==t&&t.forEach(d),null===(r=e.tables)||void 0===r||r.forEach(y)}function p(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},39323:(e,t,r)=>{r.d(t,{L:()=>d});var a=r(89379),n=r(55171),l=r(3825),o=r(50076),i=r(50346),u=r(13096),s=r(65308),c=r(70652);async function d(e,t){var r,d;const p=(0,u.qg)(e);if(!p)throw new o.A("invalid-url","Invalid scene service url");const f=(0,a.A)((0,a.A)({},t),{},{sceneServerUrl:p.url.path,layerId:null!==(r=p.sublayer)&&void 0!==r?r:void 0});if(null!==(d=f.sceneLayerItem)&&void 0!==d||(f.sceneLayerItem=await async function(e){const t=(await y(e)).serviceItemId;if(!t)return null;const r=new c.default({id:t,apiKey:e.apiKey}),a=await async function(e){const t=null===n.id||void 0===n.id?void 0:n.id.findServerInfo(e.sceneServerUrl);if(null!==t&&void 0!==t&&t.owningSystemUrl)return t.owningSystemUrl;const r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const t=(await(0,l.A)(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(t)return t}catch(m){(0,i.QP)(m)}return null}(e);null!=a&&(r.portal=new s.A({url:a}));try{return await r.load({signal:e.signal})}catch(h){return(0,i.QP)(h),null}}(f)),null==f.sceneLayerItem)return v(f.sceneServerUrl.replace("/SceneServer","/FeatureServer"),f);const m=await async function(e){let{sceneLayerItem:t,signal:r}=e;if(!t)return null;try{const e=(await t.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:r})).find((e=>"Feature Service"===e.type))||null;if(!e)return null;const a=new c.default({portal:e.portal,id:e.id});return await a.load(),a}catch(a){return(0,i.QP)(a),null}}(f);if(null===m||void 0===m||!m.url)throw new o.A("related-service-not-found","Could not find feature service through portal item relationship");f.featureServiceItem=m;const h=await v(m.url,f);return h.portalItem=m,h}async function y(e){if(e.rootDocument)return e.rootDocument;const t={query:(0,a.A)((0,a.A)({f:"json"},e.customParameters),{},{token:e.apiKey}),responseType:"json",signal:e.signal};try{const r=await(0,l.A)(e.sceneServerUrl,t);e.rootDocument=r.data}catch(r){e.rootDocument={}}return e.rootDocument}async function v(e,t){var r,n,i;const s=(0,u.qg)(e);if(!s)throw new o.A("invalid-feature-service-url","Invalid feature service url");const c=s.url.path,d=t.layerId;if(null==d)return{serverUrl:c};const v=y(t),p=t.featureServiceItem?await t.featureServiceItem.fetchData("json"):null,f=null===(r=(null===p||void 0===p||null===(n=p.layers)||void 0===n?void 0:n[0])||(null===p||void 0===p||null===(i=p.tables)||void 0===i?void 0:i[0]))||void 0===r?void 0:r.customParameters,m=e=>{const r={query:(0,a.A)({f:"json"},f),responseType:"json",authMode:e,signal:t.signal};return(0,l.A)(c,r)},h=m("anonymous").catch((()=>m("no-prompt"))),[w,g]=await Promise.all([h,v]),b=null===g||void 0===g?void 0:g.layers,I=w.data&&w.data.layers;if(!Array.isArray(I))throw new Error("expected layers array");if(Array.isArray(b)){for(let a=0;a<Math.min(b.length,I.length);a++)if(b[a].id===d)return{serverUrl:c,layerId:I[a].id}}else if(null!=d&&d<I.length)return{serverUrl:c,layerId:I[d].id};throw new Error("could not find matching associated sublayer")}},64130:(e,t,r)=>{r.d(t,{Ju:()=>s,K8:()=>y,XH:()=>c,_r:()=>l,bO:()=>o,l:()=>d,nu:()=>v,pJ:()=>i,rc:()=>u});var a=r(39323),n=r(11668);function l(e){const t={id:e.id,name:e.name},r=(0,n.K)(e.type);return"FeatureLayer"!==r&&(t.layerType=r),t}async function o(e,t,r){var a,n;if(null==(null===(a=e)||void 0===a?void 0:a.layers)||null==(null===(n=e)||void 0===n?void 0:n.tables)){var o,u,s;const a=await r.fetchServiceMetadata(t,{customParameters:null===(o=i(e))||void 0===o?void 0:o.customParameters});(e=e||{}).layers=e.layers||(null===a||void 0===a||null===(u=a.layers)||void 0===u?void 0:u.map(l)),e.tables=e.tables||(null===a||void 0===a||null===(s=a.tables)||void 0===s?void 0:s.map(l))}return e}function i(e){if(!e)return null;const{layers:t,tables:r}=e;return null!==t&&void 0!==t&&t.length?t[0]:null!==r&&void 0!==r&&r.length?r[0]:null}function u(e,t){return null==t?null:[...e.layers||[],...e.tables||[]].find((e=>e.id===t))}function s(e,t){return[...e.layers||[],...e.tables||[]].filter((e=>{let{layerType:r}=e;return r?t.includes(r):t.includes("ArcGISFeatureLayer")}))}function c(e){var t,r,a,n;return(null!==(t=null===e||void 0===e||null===(r=e.layers)||void 0===r?void 0:r.length)&&void 0!==t?t:0)+(null!==(a=null===e||void 0===e||null===(n=e.tables)||void 0===n?void 0:n.length)&&void 0!==a?a:0)}function d(e){switch(e){case"catalog":return["CatalogLayer"];case"feature":return["ArcGISFeatureLayer"];case"oriented-imagery":return["OrientedImageryLayer"];case"subtype-group":return["SubtypeGroupLayer","SubtypeGroupTable"]}return null}function y(e){switch(e){case"CatalogLayer":return"CatalogLayer";case"OrientedImageryLayer":return"OrientedImageryLayer";case"SubtypeGroupLayer":case"SubtypeGroupTable":return"SubtypeGroupLayer"}return"FeatureLayer"}async function v(e,t,r){var n;if(null===e||void 0===e||!e.url)return null!==t&&void 0!==t?t:{};if(null!==t&&void 0!==t||(t={}),!t.layers){var o;const a=await r.fetchServiceMetadata(e.url);t.layers=null===(o=a.layers)||void 0===o?void 0:o.map(l)}const{serverUrl:u,portalItem:s}=await(0,a.L)(e.url,{sceneLayerItem:e,customParameters:null===(n=i(t))||void 0===n?void 0:n.customParameters}).catch((()=>({serverUrl:null,portalItem:null})));if(null==u)return t.tables=[],t;if(!t.tables&&s){const e=await s.fetchData().catch((()=>null));if(null!==e&&void 0!==e&&e.tables)t.tables=e.tables.map(l);else{var c,d;const a=await r.fetchServiceMetadata(u,{customParameters:null===(c=i(e))||void 0===c?void 0:c.customParameters}).catch((()=>null));t.tables=null===a||void 0===a||null===(d=a.tables)||void 0===d?void 0:d.map(l)}}if(t.tables)for(const a of t.tables)a.url="".concat(u,"/").concat(a.id);return t}},67061:(e,t,r)=>{r.d(t,{V:()=>l});var a=r(89379),n=r(3825);async function l(e,t){const{data:r}=await(0,n.A)(e,{responseType:"json",query:(0,a.A)((0,a.A)({f:"json"},null===t||void 0===t?void 0:t.customParameters),{},{token:null===t||void 0===t?void 0:t.apiKey})});return r}},73814:(e,t,r)=>{r.d(t,{load:()=>v});var a=r(50076),n=r(13096),l=r(11668),o=r(77491),i=r(65308),u=r(79942),s=r(64130),c=r(72945),d=r(81589),y=r(67061);async function v(e,t){const r=e.instance.portalItem;if(null!==r&&void 0!==r&&r.id)return await r.load(t),function(e){const t=e.instance.portalItem;if(null===t||void 0===t||!t.type||!e.supportedTypes.includes(t.type))throw new a.A("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:null===t||void 0===t?void 0:t.type,expectedType:e.supportedTypes.join(", ")})}(e),e.validateItem&&e.validateItem(r),async function(e,t){var r;const n=e.instance,i=n.portalItem;if(!i)return;const{url:v,title:f}=i,h=(0,u.v)(i,"portal-item");if("group"===n.type)return async function(e,t,r){const n=e.portalItem;if(!e.sourceIsPortalItem)return;const{title:i,type:d}=n;if("Group Layer"===d){if(!(0,c.Y)(n,"Map"))throw new a.A("portal:invalid-layer-item-typekeyword","'Group Layer' item without 'Map' type keyword is not supported");return async function(e,t){var r;const n=e.portalItem,l=await n.fetchData("json");if(!l)return;if(!t.populateGroupLayer)throw new a.A("portal:missing-populate-group-layer","Missing populate group layer");const o=(0,u.v)(n,"web-map");e.read(l,o),await t.populateGroupLayer(e,l,{context:o}),e.resourceReferences={portalItem:n,paths:null!==(r=o.readResourcePaths)&&void 0!==r?r:[]}}(e,r)}return e.read({title:i},t),async function(e,t){let r;const{portalItem:n}=e;if(!n)return;const i=n.type,u=t.layerModuleTypeMap;if(!u)throw new a.A("portal:missing-layer-module-type-map","Layer module type map is required to construct sub layers");switch(i){case"Feature Service":case"Feature Collection":r=u.FeatureLayer;break;case"Stream Service":r=u.StreamLayer;break;case"Scene Service":r=u.SceneLayer;break;default:throw new a.A("portal:unsupported-item-type-as-group","The item type '".concat(i,"' is not supported as a 'IGroupLayer'"))}const c=new o.v;let[d,v]=await Promise.all([r(),m(t,c)]),f=()=>d;if("Feature Service"===i){var h;const t=null===(h=(0,s.pJ)(v))||void 0===h?void 0:h.customParameters;v=n.url?await(0,s.bO)(v,n.url,c):{},f=await async function(e,t){const{layers:r,tables:a}=e,n=[...null!==r&&void 0!==r?r:[],...null!==a&&void 0!==a?a:[]];if(!n.length)return;const l=new Set,o=[];for(const{layerType:c}of n){const e=null!==c&&void 0!==c?c:"ArcGISFeatureLayer";if(l.has(e))continue;l.add(e);const r=t[(0,s.K8)(e)];o.push(r())}const i=await Promise.all(o),u=new Map;return Array.from(l).forEach(((e,t)=>{u.set(e,i[t])})),e=>{let{layerType:t}=e;const r=null!==t&&void 0!==t?t:"ArcGISFeatureLayer";return u.get(r)}}(v,u)||f;const r=await async function(e,t){const{layersJSON:r}=await(0,l.Q)(e,t);if(!r)return null;const a=[...r.layers,...r.tables];return e=>a.find((t=>t.id===e.id))}(n.url,{customParameters:t,loadContext:c});return await p(e,f,f,v,u,r)}return"Scene Service"===i&&n.url&&(v=await(0,s.nu)(n,v,c)),(0,s.XH)(v)>0?await p(e,f,null,v,u):await async function(e,t,r){var a,n;const{portalItem:l}=e;if(null===l||void 0===l||!l.url)return;const o=await(0,y.V)(l.url);o&&p(e,t,null,{layers:null===(a=o.layers)||void 0===a?void 0:a.map(s._r),tables:null===(n=o.tables)||void 0===n?void 0:n.map(s._r)},r)}(e,f,u)}(e,r)}(n,h,e);v&&"media"!==n.type&&n.read({url:v},h);const w=new o.v,g=await m(e,w,t);return g&&n.read(g,h),n.resourceReferences={portalItem:i,paths:null!==(r=h.readResourcePaths)&&void 0!==r?r:[]},"subtype-group"!==n.type&&n.read({title:f},h),(0,d.L)(n,h)}(e,t)}async function p(e,t,r,a,n,l){var o;let i=a.layers||[];const u=a.tables||[];if("Feature Collection"===(null===(o=e.portalItem)||void 0===o?void 0:o.type)?(i.forEach(((e,t)=>{var r;e.id=t,"Table"===(null===e||void 0===e||null===(r=e.layerDefinition)||void 0===r?void 0:r.type)&&u.push(e)})),i=i.filter((e=>{var t;return"Table"!==(null===e||void 0===e||null===(t=e.layerDefinition)||void 0===t?void 0:t.type)}))):(i.reverse(),u.reverse()),i.forEach((r=>{const n=null===l||void 0===l?void 0:l(r);if(n||!l){const l=f(e,t(r),a,r,n);e.add(l)}})),u.length){const t=r?null:await n.FeatureLayer();u.forEach((n=>{const o=null===l||void 0===l?void 0:l(n);if(o||!l){const l=f(e,r?r(n):t,a,n,o);e.tables.add(l)}}))}}function f(e,t,r,a,n){const l=e.portalItem,o={portalItem:l.clone(),layerId:a.id};null!=a.url&&(o.url=a.url);const u=new t(o);if("sourceJSON"in u&&(u.sourceJSON=n),"subtype-group"!==u.type&&"catalog"!==u.type&&(u.sublayerTitleMode="service-name"),"Feature Collection"===l.type){const e={origin:"portal-item",portal:l.portal||i.A.getDefault()};u.read(a,e);const t=r.showLegend;null!=t&&u.read({showLegend:t},e)}return u}async function m(e,t,r){if(!1===e.supportsData)return;const a=e.instance,l=a.portalItem;if(!l)return;let o=null;try{o=await l.fetchData("json",r)}catch(d){}if(function(e){return"stream"!==e.type&&"layerId"in e}(a)){var i,u;let e=null;const r=await async function(e,t,r){var a,l,o,i,u,c,d,y,v;if(null!==t&&void 0!==t&&t.layers&&null!==t&&void 0!==t&&t.tables)return(0,s.XH)(t);const p=(0,n.qg)(e.url);if(!p)return 1;const f=await r.fetchServiceMetadata(p.url.path,{customParameters:null===(a=(0,s.pJ)(t))||void 0===a?void 0:a.customParameters}).catch((()=>null));return(null!==(l=null!==(o=null===t||void 0===t||null===(i=t.layers)||void 0===i?void 0:i.length)&&void 0!==o?o:null===f||void 0===f||null===(u=f.layers)||void 0===u?void 0:u.length)&&void 0!==l?l:0)+(null!==(c=null!==(d=null===t||void 0===t||null===(y=t.tables)||void 0===y?void 0:y.length)&&void 0!==d?d:null===f||void 0===f||null===(v=f.tables)||void 0===v?void 0:v.length)&&void 0!==c?c:0)}(l,o,t);if((null!==(i=o)&&void 0!==i&&i.layers||null!==(u=o)&&void 0!==u&&u.tables)&&r>0){var c;if(null==a.layerId){const e=(0,s.l)(a.type),t=null!==e&&void 0!==e&&e.length?(0,s.Ju)(o,e)[0]:(0,s.pJ)(o);t&&(a.layerId=t.id)}e=function(e,t){var r,a;const{layerId:n}=t,l=(null===(r=e.layers)||void 0===r?void 0:r.find((e=>e.id===n)))||(null===(a=e.tables)||void 0===a?void 0:a.find((e=>e.id===n)));return l&&function(e,t){const r="layerType"in e&&e.layerType,{type:a}=t;return!("feature"===a&&r&&"ArcGISFeatureLayer"!==e.layerType||"catalog"===a&&!r||"oriented-imagery"===a&&!r||"subtype-group"===a&&!r)}(l,t)?l:null}(o,a),"OrientedImageryLayer"===(null===(c=e)||void 0===c?void 0:c.layerType)&&"oriented-imagery"===a.type&&a.supportedSourceTypes.add("Feature Layer"),e&&null!=o.showLegend&&(e.showLegend=o.showLegend)}return r>1&&"sublayerTitleMode"in a&&"service-name"!==a.sublayerTitleMode&&(a.sublayerTitleMode="item-title-and-service-name"),e}return o}},77491:(e,t,r)=>{r.d(t,{v:()=>n});var a=r(67061);class n{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}async fetchServiceMetadata(e,t){const r=this._serviceMetadatas.get(e);if(r)return r;const n=await(0,a.V)(e,t);return this._serviceMetadatas.set(e,n),n}async fetchItemData(e){const{id:t}=e;if(!t)return null;const{_itemDatas:r}=this;if(r.has(t))return r.get(t);const a=await e.fetchData();return r.set(t,a),a}async fetchCustomParameters(e,t){const r=await this.fetchItemData(e);return r&&"object"==typeof r&&(t?t(r):r.customParameters)||null}}},79942:(e,t,r)=>{r.d(t,{m:()=>i,v:()=>o});var a=r(89379),n=r(90534),l=r(65308);function o(e,t){return(0,a.A)((0,a.A)({},u(e,t)),{},{readResourcePaths:[]})}function i(e,t,r){const l=(0,n.An)(e.itemUrl);return(0,a.A)((0,a.A)({},u(e,t)),{},{messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:l?{rootPath:l.path,writtenUrls:[]}:null,resources:r?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null})}function u(e,t){return{origin:t,url:(0,n.An)(e.itemUrl),portal:e.portal||l.A.getDefault(),portalItem:e}}},81589:(e,t,r)=>{r.d(t,{L:()=>o});var a=r(98773),n=r(50346),l=r(62754);async function o(e,t,r){const o=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(o&&"unique-value"===o.type&&o.styleOrigin){const i=await(0,a.Ke)(o.populateFromStyle());if((0,n.Te)(r),!1===i.ok){const r=i.error;null!==t&&void 0!==t&&t.messages&&t.messages.push(new l.A("renderer:style-reference","Failed to create unique value renderer from style reference: ".concat(r.message),{error:r,context:t})),e.clear("renderer",null===t||void 0===t?void 0:t.origin)}}}}}]);
//# sourceMappingURL=3814.b65bffba.chunk.js.map
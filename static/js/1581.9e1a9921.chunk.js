"use strict";(self.webpackChunkhousing_dashboard=self.webpackChunkhousing_dashboard||[]).push([[1581,4429],{3289:(t,e,i)=>{i.d(e,{Dr:()=>V,EM:()=>A,Gn:()=>y,IQ:()=>T,Jk:()=>d,NZ:()=>S,TY:()=>c,Zi:()=>f,gF:()=>m,mp:()=>x,oF:()=>g});var o=i(89379),s=i(401),r=i(13442),n=i(28808),a=i(32151),l=i(15698),u=i(74075);function c(t){var e,i;return t.minScale||t.maxScale?{minScale:null!==(e=t.minScale)&&void 0!==e?e:0,maxScale:null!==(i=t.maxScale)&&void 0!==i?i:0}:null}function p(t){if(null==t)return null;if(Array.isArray(t)){const[e,i,o,s]=t;return[e,i,o,255*s]}return"string"==typeof t?t:(0,o.A)((0,o.A)({},t),{},{defaultValue:p(null===t||void 0===t?void 0:t.defaultValue)})}async function d(t,e){const{cimResourceManager:i,cimAnalyzer:o,scaleExpression:r}=e.schemaOptions;await Promise.all(s.wp.fetchResources(t.symbol,i,[]));const n=o.analyzeSymbolReference(t,!1),a={scaleInfo:c(t),scaleExpression:r},l=[];for(const s of n)switch(s.type){case"marker":l.push(...h(s,e,a));break;case"fill":l.push(...v(s,e,a));break;case"gradientFill":l.push(...b(s,e,a));break;case"line":l.push(...w(s,e,a));break;case"gradientStroke":l.push(...z(s,e,a));break;case"text":l.push(...P(s,e,a))}return l}function h(t,e,i){const{uniforms:s,schemaOptions:r}=e,{store:n}=r,u=t.isOutline?(0,o.A)((0,o.A)({},l.Dk),{},{visualVariableSizeScaleStops:s.visualVariableSizeOutlineScaleStops}):{visualVariableColor:s.visualVariableColor,visualVariableOpacity:s.visualVariableOpacity,visualVariableSizeMinMaxValue:s.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:s.visualVariableSizeScaleStops,visualVariableSizeStops:s.visualVariableSizeStops,visualVariableSizeUnitValue:s.visualVariableSizeUnitValue,visualVariableRotation:s.visualVariableRotation};return t.animationParams?m(n.ensureInstance(a.YS.animatedMarker,{uniforms:u,optionalAttributes:{zoomRange:!0}}),t,l.Dk,i):f(n.ensureInstance(a.YS.marker,{uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,s,i)}function m(t,e,i,o){return e.animationParams?[t.createMeshInfo({pixelDimensions:e.pixelDimensions,texelDimensions:e.texelDimensions,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,sprite:e.spriteRasterizationParam,animations:e.animationParams,scaleInfo:o.scaleInfo,scaleSymbolsProportionally:e.scaleSymbolsProportionally,strokeWidth:e.outlineWidth,isMapAligned:e.alignment===n.C1.MAP,colorLocked:e.colorLocked,isStroke:e.isStroke,baseSize:e.baseSize,referenceSize:e.referenceSize,angleToLine:!!e.markerPlacement&&e.markerPlacement.placement&&"angleToLine"in e.markerPlacement.placement&&e.markerPlacement.placement.angleToLine,sizeRatio:e.sizeRatio})]:[]}function f(t,e,i,o){var s,n;let{scaleInfo:a,scaleExpression:c}=o;const d=(0,u.I)(i);return[t.createMeshInfo({size:e.size,scaleX:e.scaleX,anchorX:e.anchorPoint.x,anchorY:e.anchorPoint.y,angle:e.rotation,color:null!==(s=p(e.color))&&void 0!==s?s:[0,0,0,0],colorLocked:e.colorLocked,frameHeight:e.frameHeight,widthRatio:e.widthRatio,scaleInfo:a,offsetX:e.offsetX,offsetY:e.offsetY,outlineColor:null!==(n=p(e.outlineColor))&&void 0!==n?n:[0,0,0,0],outlineSize:e.outlineWidth,referenceSize:e.referenceSize||r.D.CIMVectorMarker.size,rotateClockwise:e.rotateClockwise,scaleFactor:null!==c&&void 0!==c?c:1,sizeRatio:e.sizeRatio,alignment:e.alignment,isAbsoluteAnchorPoint:e.isAbsoluteAnchorPoint,scaleSymbolsProportionally:e.scaleSymbolsProportionally,sprite:e.spriteRasterizationParam,hasSizeVV:d,placement:e.markerPlacement,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,transforms:e.transform,minPixelBuffer:(0,l.j0)(i)})]}function y(t,e,i){var o;let{scaleInfo:s}=i;return[t.createMeshInfo({color:null!==(o=p(e.color))&&void 0!==o?o:[0,0,0,0],scaleInfo:s,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function v(t,e,i){if(!t.spriteRasterizationParam)return function(t,e,i){const{uniforms:o,schemaOptions:s}=e,{store:r}=s;return y(r.ensureInstance(a.YS.fill,{uniforms:{visualVariableColor:t.colorLocked?null:o.visualVariableColor,visualVariableOpacity:o.visualVariableOpacity},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}(t,e,i);const{uniforms:o,schemaOptions:s}=e,{store:r}=s;return g(r.ensureInstance(a.YS.complexFill,{uniforms:{visualVariableColor:t.colorLocked?null:o.visualVariableColor,visualVariableOpacity:o.visualVariableOpacity},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,null!=o.visualVariableColor,i)}function g(t,e,i,o){var s;let{scaleInfo:r}=o;if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const n=!!e.hasUnresolvedReplacementColor&&(!i||e.colorLocked),a=e.sampleAlphaOnly&&!n,l=e.spriteRasterizationParam;return[t.createMeshInfo({color:null!==(s=p(e.color))&&void 0!==s?s:[0,0,0,0],height:e.height,aspectRatio:e.scaleX,offsetX:e.offsetX,offsetY:e.offsetY,scaleX:1,scaleY:1,angle:e.angle,applyRandomOffset:e.applyRandomOffset,sampleAlphaOnly:a,scaleProportionally:"CIMHatchFill"===l.resource.type,sprite:l,scaleInfo:r,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function b(t,e,i){const{uniforms:o,schemaOptions:s}=e,{store:r}=s;return x(r.ensureInstance(a.YS.gradientFill,{uniforms:{visualVariableColor:null,visualVariableOpacity:o.visualVariableOpacity},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}function x(t,e,i){var o;let{scaleInfo:s}=i;if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const r=e.spriteRasterizationParam;return[t.createMeshInfo({color:null!==(o=p(e.color))&&void 0!==o?o:[0,0,0,0],angle:e.angle,gradientMethod:e.gradientMethod,gradientSize:e.gradientSize,gradientSizeUnits:e.gradientSizeUnits,gradientType:e.gradientType,sprite:r,scaleInfo:s,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null})]}function w(t,e,i){const{uniforms:s,schemaOptions:r}=e,{store:n}=r,u=t.isOutline?(0,o.A)((0,o.A)({},l.Dk),{},{visualVariableSizeScaleStops:s.visualVariableSizeOutlineScaleStops}):{visualVariableColor:t.colorLocked?null:s.visualVariableColor,visualVariableOpacity:s.visualVariableOpacity,visualVariableSizeMinMaxValue:s.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:s.visualVariableSizeScaleStops,visualVariableSizeStops:s.visualVariableSizeStops,visualVariableSizeUnitValue:s.visualVariableSizeUnitValue},c={uniforms:u,optionalAttributes:{zoomRange:!!i.scaleInfo}},p=!!(u.visualVariableSizeMinMaxValue||u.visualVariableSizeScaleStops||u.visualVariableSizeStops||u.visualVariableSizeUnitValue);return t.spriteRasterizationParam?A(n.ensureInstance(a.YS.texturedLine,c),t,p,i):S(n.ensureInstance(a.YS.line,c),t,p,i)}function _(t,e,i){var o;let{scaleInfo:s}=i;return{color:null!==(o=p(t.color))&&void 0!==o?o:[0,0,0,0],width:t.width,referenceWidth:t.referenceWidth,capType:t.cap,joinType:t.join,miterLimit:t.miterLimit,scaleInfo:s,hasSizeVV:e,effects:t.effects?{type:"cim-effect-infos",effectInfos:t.effects}:null}}function S(t,e,i,o){if(e.spriteRasterizationParam)throw new Error("InternalError: Sprite should not be defined");const s=_(e,i,o);return[t.createMeshInfo(s)]}function A(t,e,i,s){var r;const{spriteRasterizationParam:n,scaleDash:a,sampleAlphaOnly:l}=e;if(!n)throw new Error("InternalError: Sprite should be defined");return[t.createMeshInfo((0,o.A)((0,o.A)({},_(e,i,s)),{},{offsetAlongLine:null!==(r=e.offsetAlongLine)&&void 0!==r?r:0,shouldScaleDash:null!==a&&void 0!==a&&a,shouldSampleAlphaOnly:l,isSDF:"CIMPictureStroke"!==n.resource.type&&"CIMGradientStroke"!==n.resource.type,sprite:n}))]}function z(t,e,i){const{uniforms:s,schemaOptions:r}=e,{store:n}=r;return V(n.ensureInstance(a.YS.gradientStroke,{uniforms:t.isOutline?(0,o.A)((0,o.A)({},l.Dk),{},{visualVariableSizeScaleStops:s.visualVariableSizeOutlineScaleStops}):{visualVariableColor:null,visualVariableOpacity:s.visualVariableOpacity,visualVariableSizeMinMaxValue:s.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:s.visualVariableSizeScaleStops,visualVariableSizeStops:s.visualVariableSizeStops,visualVariableSizeUnitValue:s.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!!i.scaleInfo}}),t,i)}function V(t,e,i){if(!e.spriteRasterizationParam)throw new Error("InternalError: Sprite should always be defined");const s=e.spriteRasterizationParam;return[t.createMeshInfo((0,o.A)((0,o.A)({},_(e,!1,i)),{},{gradientMethod:e.gradientMethod,gradientSize:e.gradientSize,gradientSizeUnits:e.gradientSizeUnits,gradientType:e.gradientType,sprite:s,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null}))]}function P(t,e,i){const{uniforms:o,schemaOptions:s}=e,{store:r}=s;return T(r.ensureInstance(a.YS.text,{uniforms:{visualVariableColor:t.colorLocked?null:o.visualVariableColor,visualVariableOpacity:o.visualVariableOpacity,visualVariableRotation:o.visualVariableRotation,visualVariableSizeMinMaxValue:o.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:o.visualVariableSizeScaleStops,visualVariableSizeStops:o.visualVariableSizeStops,visualVariableSizeUnitValue:o.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!!i.scaleInfo,referenceSymbol:!1,clipAngle:!1}}),t,o,i)}function T(t,e,i,o){var s,r,n,a,u,c,d;let{scaleInfo:h,scaleExpression:m}=o;return[t.createMeshInfo({boxBackgroundColor:p(e.backgroundColor),boxBorderLineColor:p(e.borderLineColor),boxBorderLineSize:null!==(s=e.borderLineWidth)&&void 0!==s?s:0,color:null!==(r=p(e.color))&&void 0!==r?r:[0,0,0,0],offsetX:e.offsetX,offsetY:e.offsetY,postAngle:e.angle,fontSize:e.size,referenceSize:e.referenceSize,decoration:e.decoration,haloColor:null!==(n=p(e.haloColor))&&void 0!==n?n:[0,0,0,0],haloSize:null!==(a=e.haloSize)&&void 0!==a?a:0,outlineColor:null!==(u=p(e.outlineColor))&&void 0!==u?u:[0,0,0,0],outlineSize:e.outlineSize,lineWidth:e.lineWidth||512,lineHeightRatio:1,horizontalAlignment:null!==(c=e.horizontalAlignment)&&void 0!==c?c:"center",verticalAlignment:null!==(d=e.verticalAlignment)&&void 0!==d?d:"baseline",useCIMAngleBehavior:!1,glyphs:e.textRasterizationParam,scaleInfo:h,effects:e.effects?{type:"cim-effect-infos",effectInfos:e.effects}:null,placement:e.markerPlacement,transforms:e.transform,scaleFactor:null!==m&&void 0!==m?m:1,minPixelBuffer:(0,l.j0)(i),repeatLabel:null,repeatLabelDistance:null,allowOverrun:null,labelPosition:null})]}},4037:(t,e,i)=>{i.d(e,{Q:()=>s,m:()=>o});const o={linear:0,rectangular:1,circular:2},s={isAbsolute:0,isDiscrete:1}},13618:(t,e,i)=>{i.d(e,{Jz:()=>d,T9:()=>l,uH:()=>u});var o=i(18690),s=i(92045),r=i(61551),n=i(18943),a=i(9685);function l(t,e){return{type:"simple",filters:e,capabilities:{maxTextureSize:(0,a.C)().maxTextureSize},bindings:p(t)}}function u(t,e){const i=(0,a.C)();return{type:"multi",target:"feature",keyField:s.EA,filters:e,capabilities:{maxTextureSize:i.maxTextureSize},bindings:{[s.t0.TrackLine]:p(t.trackLines.renderer),[s.t0.LatestObservation]:p(t.latestObservations.renderer),[s.t0.PreviousObservation]:p(t.previousObservations.renderer)}}}function c(t){switch(t){case"opacity":return r.Gn.OPACITY;case"color":return r.Gn.COLOR;case"rotation":return r.Gn.ROTATION;case"size":return r.Gn.SIZE;default:return null}}function p(t){if(!t)return[];switch(t.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return d(t);case"dot-density":return function(t){const e=[];for(const i of t.attributes)e.push({binding:e.length,expression:i.valueExpression,field:i.field});return e}(t);case"pie-chart":return function(t){const e=d(t);let i=4;for(const o of t.attributes)e.push({binding:i++,expression:o.valueExpression,field:o.field});return e}(t);case"heatmap":return function(t){let{valueExpression:e,field:i}=t;return e||i?[{binding:0,expression:e,field:i}]:[]}(t)}}function d(t){var e;return"visualVariables"in t&&null!==(e=t.visualVariables)&&void 0!==e&&e.length?(0,n.R)(t.visualVariables).map((t=>function(t){switch(t.type){case"size":return function(t){return"$view.scale"===t.valueExpression?null:{binding:c(t.type),field:t.field,normalizationField:t.normalizationField,expression:t.valueExpression,valueRepresentation:t.valueRepresentation}}(t);case"color":case"opacity":return function(t){return{binding:c(t.type),field:t.field,normalizationField:t.normalizationField,expression:t.valueExpression}}(t);case"rotation":return function(t){return{binding:c(t.type),expression:t.valueExpression,field:t.field}}(t)}}(t))).filter(o.Ru):[]}},15698:(t,e,i)=>{i.d(e,{Dk:()=>w,K4:()=>S,j0:()=>_});var o=i(89379),s=(i(81806),i(76931)),r=i(31633),n=i(3454),a=i(5095),l=i(90113),u=i(81608),c=i(18943);const p=1.25,d=128,h=128;function m(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;const i=t.stops.sort(((t,e)=>t.value-e.value)),o=(0,u.r)(i,8),s=o.map((t=>{let{value:e}=t;return e})),r=o.map((t=>{let{color:e}=t;return(0,u.p)(e)}));return{values:s,colors:r}}function f(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;const i=t.stops.sort(((t,e)=>t.value-e.value)),o=(0,u.r)(i,8);return{opacityValues:o.map((t=>{let{value:e}=t;return e})),opacities:o.map((t=>{let{opacity:e}=t;return e}))}}function y(t){return{rotationType:"geographic"===t.rotationType?l.H_.Geographic:l.H_.Arithmatic}}function v(t){var e;if(null===(e=t.stops)||void 0===e||!e.length)return null;if(t.stops.some((t=>t.useMaxValue||t.useMinValue)))return(e,i)=>{const o=e.statisticsByLevel.get(i.key.level),r=t.stops.map((e=>{var i,r,n,l;return{value:e.useMaxValue?null!==(i=null===o||void 0===o||null===(r=o.get(t.field))||void 0===r?void 0:r.maxValue)&&void 0!==i?i:0:e.useMinValue?null!==(n=null===o||void 0===o||null===(l=o.get(t.field))||void 0===l?void 0:l.minValue)&&void 0!==n?n:0:e.value,size:e.size?(0,s.Lz)(e.size):a.qM}})).sort(((t,e)=>t.value-e.value)),n=(0,u.r)(r,8);return{values:n.map((t=>{let{value:e}=t;return e})),sizes:n.map((t=>{let{size:e}=t;return e}))}};const i=t.stops.sort(((t,e)=>t.value-e.value)),o=(0,u.r)(i,8);return{values:o.map((t=>{let{value:e}=t;return e})),sizes:o.map((t=>{let{size:e}=t;return(0,s.Lz)(e)}))}}function g(t){return e=>{var i;const{state:o}=e;return{unitValueToPixelsRatio:(0,r.GA)(o.spatialReference)/n.j[null!==(i=t.valueUnit)&&void 0!==i?i:"meters"]/o.resolution}}}function b(t,e){const i=e.length;if(t<e[0].value||1===i)return e[0].size;for(let o=1;o<i;o++)if(t<e[o].value){const i=(t-e[o-1].value)/(e[o].value-e[o-1].value);return e[o-1].size+i*(e[o].size-e[o-1].size)}return e[i-1].size}function x(t){const{minDataValue:e,maxDataValue:i,minSize:o,maxSize:r}=t;if("object"==typeof o&&"object"==typeof r)return(t,n)=>{const a=t.state.scale,l=(0,s.Lz)(b(a,o.stops)),u=(0,s.Lz)(b(a,r.stops));return{minMaxValueAndSize:[e,i,l,u]}};if("object"==typeof o||"object"==typeof r)throw new Error("InternalError: Found a partial VisualVariableSizeMinMaxValue");return{minMaxValueAndSize:[e,i,(0,s.Lz)(o),(0,s.Lz)(r)]}}const w={visualVariableColor:null,visualVariableOpacity:null,visualVariableRotation:null,visualVariableSizeStops:null,visualVariableSizeScaleStops:null,visualVariableSizeOutlineScaleStops:null,visualVariableSizeUnitValue:null,visualVariableSizeMinMaxValue:null};function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;if(t.visualVariableSizeMinMaxValue)return t.visualVariableSizeMinMaxValue instanceof Function?d:Math.max(t.visualVariableSizeMinMaxValue.minMaxValueAndSize[3]*i,e);if(t.visualVariableSizeScaleStops){if(t.visualVariableSizeScaleStops instanceof Function)return d;const o=t.visualVariableSizeScaleStops.sizes;return Math.max(o[o.length-1]*i,e)}if(t.visualVariableSizeStops){if(t.visualVariableSizeStops instanceof Function)return d;const o=t.visualVariableSizeStops.sizes;return Math.max(o[o.length-1]*i,e)}return t.visualVariableSizeUnitValue?2*d:0}function S(t){const e=(0,o.A)({},w);if(!t||!("visualVariables"in t)||!t.visualVariables)return e;for(const i of(0,c.R)(t.visualVariables))switch(i.type){case"color":e.visualVariableColor=m(i);break;case"opacity":e.visualVariableOpacity=f(i);break;case"rotation":e.visualVariableRotation=y(i);break;case"size":switch(A(i)){case"field-stops":e.visualVariableSizeStops=v(i);break;case"scale-stops":"outline"===i.target?e.visualVariableSizeOutlineScaleStops=v(i):e.visualVariableSizeScaleStops=v(i);break;case"min-max":e.visualVariableSizeMinMaxValue=x(i);break;case"unit-value":e.visualVariableSizeUnitValue=g(i)}}return e}function A(t){return"number"==typeof t.minDataValue&&"number"==typeof t.maxDataValue&&null!=t.minSize&&null!=t.maxSize?"min-max":"$view.scale"===(null===t||void 0===t?void 0:t.valueExpression)&&Array.isArray(t.stops)?"scale-stops":null==t.field&&"$view.scale"===(null===t||void 0===t?void 0:t.valueExpression)||!(Array.isArray(t.stops)||"levels"in t&&t.levels)?null!=t.field||"$view.scale"!==(null===t||void 0===t?void 0:t.valueExpression)?"unit-value":null:"field-stops"}},16946:(t,e,i)=>{i.d(e,{g:()=>l});var o=i(89339),s=i(64780),r=i(93345),n=i(21812);const a={position:{type:r.pe.SHORT,count:2}};class l extends s.e{static create(t,e){const i=[];let{stride:s}=e;if(null==s){s=0;for(const[t,{count:i,type:r,offset:n}]of Object.entries(e.layout)){if(null!=n)throw new Error("Stride cannot be computed automatically when attribute offsets are supplied explicitly.");s+=i*o.I[r]}}let r=0;for(const[l,{count:d,offset:h,type:m,normalized:f}]of Object.entries(e.layout)){null!=h&&(r=h);const t=new n._(l,d,m,r,s,null!=f&&f,0);i.push(t),r+=d*o.I[m]}const a={primitive:e.primitive};null!=e.index&&(a.index="indexData");let{count:u}=e;if(null==u&&(u=e.index?e.index.length:e.vertex.byteLength/s,Math.floor(u)!==u))throw new Error("The byte length of vertex data must be an exact multiple of the stride, which is ".concat(s,"."));const c={start:0,count:u,group:0,primitive:e.primitive},p={vertex:{vertexData:{data:e.vertex,attributes:i}},parts:[c],groups:[a]};return null!=e.index&&(p.index={indexData:{data:e.index}}),new l(t,p,e.layout)}static fromVertexStream(t,e){return l.create(t,{primitive:r.WR.TRIANGLE_STRIP,vertex:new Uint16Array(e),layout:a})}constructor(t,e,i){super(t,e),this._spec=i}bind(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super.bind(t,e,i)}}},18943:(t,e,i)=>{i.d(e,{R:()=>c,e:()=>d});var o=i(50076),s=i(76460),r=i(76931),n=i(9685);const a=8,l=a-2,u=()=>s.A.getLogger("esri.views.2d.layers.features.support.rendererUtils");function c(t){return t.map((t=>function(t){return("size"===t.type||"color"===t.type||"opacity"===t.type)&&null!=t.stops}(t)?function(t){var e;return t.stops=function(t,e){return e.length<=a?e:(u().warn("Found ".concat(e.length," Visual Variable stops, but MapView only supports ").concat(a,". Displayed stops will be simplified.")),e.length>2*a?function(t,e){const[i,...o]=e,s=o.pop(),n=o[0].value,a=o[o.length-1].value,u=(a-n)/l,c=[];for(let l=n;l<a;l+=u){let i=0;for(;l>=o[i].value;)i++;const s=o[i],n=e[i-1],a=l-n.value,u=s.value===n.value?1:a/(s.value-n.value);if("color"===t){const t=o[i],s=e[i-1],r=t.color.clone();r.r=p(s.color.r,r.r,u),r.g=p(s.color.g,r.g,u),r.b=p(s.color.b,r.b,u),r.a=p(s.color.a,r.a,u),c.push({value:l,color:r,label:t.label})}else if("size"===t){const t=o[i],s=e[i-1],n=(0,r.cr)(t.size),a=p((0,r.cr)(s.size),n,u);c.push({value:l,size:a,label:t.label})}else{const t=o[i],s=p(e[i-1].opacity,t.opacity,u);c.push({value:l,opacity:s,label:t.label})}}return[i,...c,s]}(t,e):function(t){const[e,...i]=t,o=i.pop();for(;i.length>l;){let t=0,e=0;for(let o=1;o<i.length;o++){const s=i[o-1],r=i[o],n=Math.abs(r.value-s.value);n>e&&(e=n,t=o)}i.splice(t,1)}return[e,...i,o]}(e))}(t.type,null!==(e=t.stops)&&void 0!==e?e:[]),t}(t.clone()):t))}function p(t,e,i){return(1-i)*t+i*e}function d(t){if(!t)return!0;switch(t.type){case"dot-density":break;case"heatmap":if(!function(){const{supportsColorBufferFloat:t,supportsColorBufferFloatBlend:e,supportsColorBufferHalfFloat:i}=(0,n.C)();return t&&e||i}()){const t=(0,n.C)(),e=["supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter((e=>!t[e])).join(", ");return u().errorOnce(new o.A("webgl-missing-extension","Missing WebGL2 requirements for Heatmap: ".concat(e))),!1}}return!0}},23758:(t,e,i)=>{i.d(e,{KQ:()=>o,Q4:()=>r,Ss:()=>n});const o=8388607,s=8388608,r=t=>t&o;function n(t,e){return((e?s:0)|t)>>>0}},29494:(t,e,i)=>{i.d(e,{H:()=>s});var o=i(81806);const s=new class{get forceStaticPath(){return"disabled"===(0,o.A)("esri-cim-animations-enable-status")}get forceAnimatedPath(){return"forced"===(0,o.A)("esri-cim-animations-enable-status")}get freezeGlobalTime(){const t=(0,o.A)("esri-cim-animations-freeze-time");return null!==t&&void 0!==t&&t}get spotlightAnimatedSymbols(){return!!(0,o.A)("esri-cim-animations-spotlight")}get forceGlobalTimeOrigin(){return!1!==(0,o.A)("esri-cim-animations-freeze-time")}}},32151:(t,e,i)=>{i.d(e,{YS:()=>Xe,n_:()=>Je,Wn:()=>$e});var o=i(61551),s=i(32743),r=i(89379),n=i(35143),a=i(29494),l=i(6951),u=i(60984),c=i(62484);class p extends l.k2{}(0,n._)([(0,l.Pi)(u.nt)],p.prototype,"globalTime",void 0),(0,n._)([(0,l.Pi)(u.ZY)],p.prototype,"animationTextureSize",void 0),(0,n._)([(0,l.Pi)(u.z7)],p.prototype,"animationTexture",void 0),(0,n._)([(0,l.Pi)(u.U)],p.prototype,"toScreen",void 0),(0,n._)([(0,l.Pi)(u.U)],p.prototype,"toNdc",void 0),(0,n._)([(0,l.Pi)(u.nt)],p.prototype,"mapRotation",void 0),(0,n._)([(0,l.Pi)(u.nt)],p.prototype,"pixelRatio",void 0);var d=i(5095),h=i(81806),m=i(60853);class f extends l.k2{getVisualVariableData(t){if(!this._vvData){const e=this.getAttributeDataCoords(t);this._vvData=(0,u.US)(this.visualVariableData,e).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(t){if(!this._uv){const e=(0,m.Kt)(t),i=this.size,o=(0,u.Wh)(e.x),s=(0,u.Wh)(e.y).multiply((0,u.Wh)(256)),r=(0,u.Wh)(e.z).multiply((0,u.Wh)(256)).multiply((0,u.Wh)(256)),n=(0,u.fV)(o.add(s).add(r)),a=(0,u.zi)(n,i),l=n.subtract(a).divide(i);this._uv=new u.ZY(a,l).add(.5).divide(i)}return this._uv}getFilterData(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.filterFlags,e).setDebugName("storage0")}getAnimationData(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.animation,e).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.dataDriven0,e).setDebugName("storage30")}getDataDrivenData1(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.dataDriven1,e).setDebugName("storage31")}getDataDrivenData2(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.dataDriven2,e).setDebugName("storage32")}getGPGPUData(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.gpgpu,e).setDebugName("storage4")}getLocalTimeOrigin(t){const e=this.getAttributeDataCoords(t);return(0,u.US)(this.localTimeOrigin,e).x.setDebugName("storage5")}getFilterFlags(t){return(0,h.A)("webgl-ignores-sampler-precision")?(0,u.mk)(this.getFilterData(t).x.multiply((0,u.fV)(255))):this.getFilterData(t).x.multiply((0,u.fV)(255))}getLabelVisibility(t){const e=this.getFilterData(t).y.multiply(255);return new u.nt(1).subtract(e)}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}}(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"filterFlags",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"animation",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"gpgpu",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"localTimeOrigin",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"visualVariableData",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"dataDriven0",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"dataDriven1",void 0),(0,n._)([(0,l.Pi)(u.z7)],f.prototype,"dataDriven2",void 0),(0,n._)([(0,l.Pi)(u.nt)],f.prototype,"size",void 0);class y extends l.k2{}(0,n._)([(0,l.Pi)(u.nt)],y.prototype,"activeReasons",void 0),(0,n._)([(0,l.Pi)(u.nt)],y.prototype,"highlightAll",void 0);class v extends l.k2{}(0,n._)([(0,l.Pi)(u.ZY)],v.prototype,"position",void 0),(0,n._)([(0,l.Pi)(u.nt)],v.prototype,"distance",void 0),(0,n._)([(0,l.Pi)(u.nt)],v.prototype,"smallSymbolDistance",void 0),(0,n._)([(0,l.Pi)(u.nt)],v.prototype,"smallSymbolSizeThreshold",void 0);class g extends l.k2{}(0,n._)([(0,l.Pi)(u.U)],g.prototype,"displayViewScreenMat3",void 0),(0,n._)([(0,l.Pi)(u.U)],g.prototype,"displayViewMat3",void 0),(0,n._)([(0,l.Pi)(u.U)],g.prototype,"displayMat3",void 0),(0,n._)([(0,l.Pi)(u.U)],g.prototype,"viewMat3",void 0),(0,n._)([(0,l.Pi)(u.U)],g.prototype,"tileMat3",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"displayZoomFactor",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"requiredZoomFactor",void 0),(0,n._)([(0,l.Pi)(u.ZY)],g.prototype,"tileOffset",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"currentScale",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"currentZoom",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"metersPerSRUnit",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"rotation",void 0),(0,n._)([(0,l.Pi)(u.nt)],g.prototype,"pixelRatio",void 0);class b extends l.ZA{}(0,n._)([(0,l.C5)(0,u.eB)],b.prototype,"id",void 0),(0,n._)([(0,l.C5)(1,u.nt)],b.prototype,"bitset",void 0),(0,n._)([(0,l.C5)(2,u.ZY)],b.prototype,"pos",void 0);class x extends l.Y7{}(0,n._)([(0,l.C5)(14,u.ZY)],x.prototype,"nextPos1",void 0),(0,n._)([(0,l.C5)(15,u.ZY)],x.prototype,"nextPos2",void 0);class w extends l.HS{}class _ extends l.A{clip(t,e){let i=new u.nt(0);const o=this.storage.getFilterFlags(t);if(i=i.add((0,u.fV)(2).multiply((0,u.fV)(1).subtract((0,m.i6)(o,0)))),this.inside?i=i.add((0,u.fV)(2).multiply((0,u.fV)(1).subtract((0,m.i6)(o,1)))):this.outside?i=i.add((0,u.fV)(2).multiply((0,m.i6)(o,1))):this.highlight&&(i=i.add((0,u.fV)(2).multiply((0,u.fV)(1).subtract(this._checkHighlight(o))))),null!=e){const t=new u.nt(1).subtract((0,u.PM)(e.x,this.view.currentZoom)),o=(0,u.PM)(e.y,this.view.currentZoom);i=i.add(new u.nt(2).multiply(t.add(o)))}return i}getFragmentOutput(t,e){var i,o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.nt(1/255);const r=new l.mm;return r.fragColor=null!==(i=null!==(o=this._maybeWriteHittest(e))&&void 0!==o?o:this._maybeHighlight(t,s))&&void 0!==i?i:t,r}_maybeHighlight(t,e){return this.highlight?new u.Zb(t.rgb,(0,u.PM)(e,t.a)):null}_checkHighlight(t){let e=this._checkHighlightBit(t,0);for(let i=1;i<d.U5;i++)e=e.add(this._checkHighlightBit(t,i));return(0,u.PM)(new u.nt(.1),e.add(this.highlight.highlightAll))}_checkHighlightBit(t,e){return(0,m.yS)(t,e).multiply((0,m.mh)(this.highlight.activeReasons,e))}maybeRunHittest(t,e,i){if(null==this.hittestRequest)return null;const o=this.hittest(t,e,i);let s=(0,u.Tk)((0,u.MM)(o,this.hittestRequest.distance),new u.nt(2),new u.nt(0));const r=this.storage.getAttributeDataCoords(t.id),n=(0,m.nb)(r);s=s.add(this.clip(t.id,t.zoomRange));const a=new u.Zb(new u.nt(1/255),0,0,0);return{glPointSize:new u.nt(1),glPosition:new u.Zb(n,s,1),color:a}}_maybeWriteHittest(t){return null!=this.hittestRequest?t.color:null}}(0,n._)([l.E8],_.prototype,"inside",void 0),(0,n._)([l.E8],_.prototype,"outside",void 0),(0,n._)([(0,l.uK)(y)],_.prototype,"highlight",void 0),(0,n._)([(0,l.Pi)(f)],_.prototype,"storage",void 0),(0,n._)([(0,l.Pi)(g)],_.prototype,"view",void 0),(0,n._)([(0,l.uK)(v)],_.prototype,"hittestRequest",void 0);var S,A=i(90113);class z extends l.k2{}(0,n._)([(0,l.Pi)(u.ZY)],z.prototype,"size",void 0),(0,n._)([(0,l.Pi)(u.z7)],z.prototype,"texture",void 0);class V extends l.k2{getColor(t,e,i){return(0,u.j1)([(0,u.or)((0,m.M8)(t),i),e],[(0,u.$5)(t,this.values.first()),this.colors.first()],[(0,u.aX)(t,this.values.last()),this.colors.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,u.MM)(e,t))),i=this.values.get(e),o=e.subtract(1),s=this.values.get(o),r=t.subtract(s).divide(i.subtract(s));return(0,u.jh)(this.colors.get(o),this.colors.get(e),r)}])}}(0,n._)([(0,l.Pi)(u.My.ofType(u.Zb,8))],V.prototype,"colors",void 0),(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],V.prototype,"values",void 0);class P extends l.k2{getOpacity(t){return(0,u.j1)([(0,m.M8)(t),new u.nt(1)],[(0,u.$5)(t,this.opacityValues.first()),this.opacities.first()],[(0,u.aX)(t,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const e=this.opacityValues.findIndex((e=>(0,u.MM)(e,t))),i=this.opacityValues.get(e),o=e.subtract(1),s=this.opacityValues.get(o),r=t.subtract(s).divide(i.subtract(s));return(0,u.jh)(this.opacities.get(o),this.opacities.get(e),r)}])}}(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],P.prototype,"opacities",void 0),(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],P.prototype,"opacityValues",void 0);class T extends l.k2{getVVRotationMat4(t){return(0,u.Tk)((0,m.M8)(t),u.$I.identity(),(()=>{const e=this.getNormalizedAngle(t).multiply(A.os),i=(0,u.F8)(e),o=(0,u.gn)(e);return new u.$I(o,i,0,0,i.multiply(new u.nt(-1)),o,0,0,0,0,1,0,0,0,0,1)}))}getVVRotationMat3(t){return(0,u.Tk)((0,m.M8)(t),u.U.identity(),(()=>{const e=this.getNormalizedAngle(t).multiply(A.os),i=(0,u.F8)(e),o=(0,u.gn)(e);return new u.U(o,i,0,i.multiply(new u.nt(-1)),o,0,0,0,1)}))}getNormalizedAngle(t){const e=(0,u.LC)(this.rotationType,new u.nt(A.H_.Arithmatic));return(0,u.Tk)(e,new u.nt(90).subtract(t),t)}}(0,n._)([(0,l.Pi)(u.nt)],T.prototype,"rotationType",void 0);class C extends l.k2{getSize(t,e){const i=this.minMaxValueAndSize.xy,o=this.minMaxValueAndSize.zw;return(0,u.Tk)((0,m.M8)(t),e,(()=>{const e=t.subtract(i.x).divide(i.y.subtract(i.x)),s=(0,u.qE)(e,new u.nt(0),new u.nt(1));return o.x.add(s.multiply(o.y.subtract(o.x)))}))}}(0,n._)([(0,l.Pi)(u.Zb)],C.prototype,"minMaxValueAndSize",void 0);class M extends l.k2{getSizeForViewScale(t){return(0,u.j1)([(0,u.$5)(t,this.values.first()),this.sizes.first()],[(0,u.aX)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,u.MM)(e,t))),i=this.values.get(e),o=e.subtract(1),s=this.values.get(o),r=t.subtract(s).divide(i.subtract(s));return(0,u.jh)(this.sizes.get(o),this.sizes.get(e),r)}])}}(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],M.prototype,"sizes",void 0),(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],M.prototype,"values",void 0);class O extends l.k2{getSize(t,e){const i=(0,u.j1)([(0,m.M8)(t),e],[(0,u.$5)(t,this.values.first()),this.sizes.first()],[(0,u.aX)(t,this.values.last()),this.sizes.last()],[!0,()=>{const e=this.values.findIndex((e=>(0,u.MM)(e,t))),i=this.values.get(e),o=e.subtract(1),s=this.values.get(o),r=t.subtract(s).divide(i.subtract(s));return(0,u.jh)(this.sizes.get(o),this.sizes.get(e),r)}]);return(0,u.Tk)((0,m.M8)(i),e,i)}}(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],O.prototype,"sizes",void 0),(0,n._)([(0,l.Pi)(u.My.ofType(u.nt,8))],O.prototype,"values",void 0);class R extends l.k2{getSize(t,e){return(0,u.Tk)((0,m.M8)(t),e,t.multiply(this.unitValueToPixelsRatio))}}function F(t){return null!=t.visualVariableSizeMinMaxValue||null!=t.visualVariableSizeScaleStops||null!=t.visualVariableSizeStops||null!=t.visualVariableSizeUnitValue}function D(t,e,i){if(F(t)){var o,s,r,n,a,l,u;const c=t.storage.getSizeValue(e);return null!==(o=null!==(s=null!==(r=null===(n=t.visualVariableSizeMinMaxValue)||void 0===n?void 0:n.getSize(c,i))&&void 0!==r?r:null===(a=t.visualVariableSizeScaleStops)||void 0===a?void 0:a.getSizeForViewScale(t.view.currentScale))&&void 0!==s?s:null===(l=t.visualVariableSizeStops)||void 0===l?void 0:l.getSize(c,i))&&void 0!==o?o:null===(u=t.visualVariableSizeUnitValue)||void 0===u?void 0:u.getSize(c,i)}return i}function I(t,e,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new u.x(!1);if(null==t.visualVariableColor)return i;const s=t.storage.getColorValue(e);return t.visualVariableColor.getColor(s,i,o)}function k(t,e){if(null==t.visualVariableOpacity)return new u.nt(1);const i=t.storage.getOpacityValue(e);return t.visualVariableOpacity.getOpacity(i)}function E(t,e){if(null==t.visualVariableRotation)return u.U.identity();const i=t.storage.getRotationValue(e);return t.visualVariableRotation.getVVRotationMat3(i)}(0,n._)([(0,l.Pi)(u.nt)],R.prototype,"unitValueToPixelsRatio",void 0);class Z extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],Z.prototype,"animationPointerAndBaseSizeAndReferenceSize",void 0),(0,n._)([(0,l.C5)(4,u.ZY)],Z.prototype,"zoomRange",void 0);class L extends w{}class B extends _{_getScreenPosition(t){const{pos:e,translation:i,rotation:o,scale:s,offset:r,id:n,vvScale:a}=t,l=function(t,e){if(null==t.visualVariableRotation)return new u.nt(0);const i=t.storage.getRotationValue(e);return t.visualVariableRotation.getNormalizedAngle(i)}(this,n).multiply(Math.PI/180),c=i.x.multiply(4/3),p=i.y.multiply(-1).multiply(4/3),d=(0,u.F8)(l),h=(0,u.gn)(l),m=h.multiply(c).add((0,u.ze)(d).multiply(p)),f=d.multiply(c).add(h.multiply(p)),y=(0,u.F8)(o.subtract(l)),v=(0,u.gn)(o.subtract(l)),g=new u.nt(0),b=new u.nt(1),{pixelRatio:x}=this.animationInfo,w=new u.U(b,g,g,g,b,g,m.multiply(x),f.multiply(x),b),_=new u.U(v,y.multiply(-1),g,y,v,g,0,0,b),S=s.multiply(a).multiply(x).multiply(4/3),A=_.multiply(S),z=this.animationInfo.toScreen.multiply(new u.eB(e,1)),V=w.multiply(z).xy,P=A.multiply(new u.eB(r,0)).xy;return V.add(P)}_clip(t,e){let i=super.clip(t,e);const o=(0,u.$5)(this._getLocalTimeOrigin(t),new u.nt(0));return a.H.forceGlobalTimeOrigin||(i=i.add((0,u.j1)([o,()=>new u.nt(2)],[!0,()=>new u.nt(0)]))),i}_getLocalTimeOrigin(t){return this.storage.getLocalTimeOrigin(t)}_toNdc(t){return this.animationInfo.toNdc.multiply(new u.eB(t,1)).xy}_getEvalParams(t,e){const{globalTime:i,animationTextureSize:o,animationTexture:s}=this.animationInfo;return{globalTime:i,localTimeOrigin:this._getLocalTimeOrigin(t.id),animationTextureSize:o,animationTexture:s,pixelDimensions:e}}_getColor(t,e){return(0,u.Tk)((0,u.LC)(e.isSDF,new u.nt(1)),this._getSDFColor(t,e),this._getSpriteColor(t,e))}_getSpriteColor(t,e){return(0,u.US)(this.mosaicInfo.texture,t).multiply(e.color)}_getSDFColor(t,e){const i=(0,u.US)(this.mosaicInfo.texture,t),o=new u.nt(.5).subtract((0,m.Rj)(i)).multiply(e.distanceToPx).multiply(A.V5),s=(0,u.qE)(new u.nt(.5).subtract(o),new u.nt(0),new u.nt(1)),r=e.color.multiply(s),n=e.outlineSize.multiply(.5),a=(0,u.tn)(o).subtract(n),l=(0,u.qE)(new u.nt(.5).subtract(a),new u.nt(0),new u.nt(1)),c=e.outlineColor.multiply(l);return new u.nt(1).subtract(c.a).multiply(r).add(c)}}function U(t,e,i){const o=t.add(new u.ZY(e,0)),s=(0,u.US)(i.animationTexture,o.add(.5).divide(i.animationTextureSize)).xy;return t=t.add(s),(0,u.om)((0,r.A)({animationPointer:t},i),u.Zb,null,(t=>{const{out:e}=t;if(!e)throw new Error("out is null");return(0,c.DW)((0,r.A)((0,r.A)({},t),{},{out:e}))}))}(0,n._)([(0,l.Pi)(z)],B.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(p)],B.prototype,"animationInfo",void 0),(0,n._)([(0,l.uK)(V)],B.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],B.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,l.uK)(C)],B.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,l.uK)(M)],B.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,l.uK)(O)],B.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,l.uK)(R)],B.prototype,"visualVariableSizeUnitValue",void 0),(0,n._)([(0,l.uK)(T)],B.prototype,"visualVariableRotation",void 0),function(t){t[t.transform=0]="transform",t[t.fromColor=1]="fromColor",t[t.toColor=2]="toColor",t[t.colorMix=3]="colorMix",t[t.toOpacity=4]="toOpacity",t[t.opacityMix=5]="opacityMix"}(S||(S={}));var N=i(43282);function Y(t,e,i){const o=i.subtract(e),s=function(t,e){return(0,u.Om)(t,(0,u.S8)(e))}(t.subtract(e),o),r=(0,u.qE)(s.divide((0,u.Bw)(o)),new u.nt(0),new u.nt(1));return(0,u.Io)(t,e.add(r.multiply(i.subtract(e))))}function q(t){const e=(0,u.tn)(t);return(0,u.PM)(e.x.add(e.y).add(e.z),new u.nt(1.05))}function H(t,e,i,o){const s=new u.U(i.x.multiply(o.y).subtract(o.x.multiply(i.y)),o.x.multiply(e.y).subtract(e.x.multiply(o.y)),e.x.multiply(i.y).subtract(i.x.multiply(e.y)),i.y.subtract(o.y),o.y.subtract(e.y),e.y.subtract(i.y),o.x.subtract(i.x),e.x.subtract(o.x),i.x.subtract(e.x)),r=e.x.multiply(i.y.subtract(o.y)),n=i.x.multiply(o.y.subtract(e.y)),a=o.x.multiply(e.y.subtract(i.y)),l=r.add(n).add(a);return new u.nt(1).divide(l).multiply(s.multiply(new u.eB(1,t)))}function j(t,e,i,o){return(0,u.LC)(q(H(t,e,i,o)),new u.nt(1))}function K(t,e,i,o){const s=i.subtract(e),r=o.subtract(e),n=(0,m.tL)(s,r),a=(0,u.Uo)((0,u.Xe)(n,new u.nt(A.M)),(0,u.MM)(n,new u.nt(-.05)));return(0,u.j1)([(0,u.Uo)((0,u.AU)(a),j(t.xy,e,i,o)),new u.nt(-1)],[!0,()=>{const s=Y(t,e,i),r=Y(t,i,o),n=Y(t,o,e);return(0,u.jk)((0,u.jk)(s,r),n)}])}function Q(t){return t.distance.add(1)}function G(t,e,i){const{viewMat3:o,tileMat3:s}=t.view,r=o.multiply(s),n=r.multiply(new u.eB(e.pos,1)),a=r.multiply(new u.eB(i.nextPos1,1)),l=r.multiply(new u.eB(i.nextPos2,1));return K(t.hittestRequest.position,n.xy,a.xy,l.xy)}class W extends Z{}(0,n._)([(0,l.C5)(5,u.ZY)],W.prototype,"offset",void 0),(0,n._)([(0,l.C5)(6,u.ZY)],W.prototype,"uv",void 0),(0,n._)([(0,l.C5)(7,u.Zb)],W.prototype,"sizing",void 0),(0,n._)([(0,l.C5)(8,u.nt)],W.prototype,"angle",void 0);class X extends l.Y7{}(0,n._)([(0,l.C5)(12,u.ZY)],X.prototype,"offsetNextVertex1",void 0),(0,n._)([(0,l.C5)(13,u.ZY)],X.prototype,"offsetNextVertex2",void 0),(0,n._)([(0,l.C5)(14,u.ZY)],X.prototype,"textureUVNextVertex1",void 0),(0,n._)([(0,l.C5)(15,u.ZY)],X.prototype,"textureUVNextVertex2",void 0);function $(t,e,i,o){return e.multiply(t.x).add(i.multiply(t.y)).add(o.multiply(t.z))}class J extends B{constructor(){super(...arguments),this.type="AnimatedMarkerShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"],uv:["textureUVNextVertex1","textureUVNextVertex2"]}}_vertexPreamble(t){const{id:e,pos:i,offset:o,animationPointerAndBaseSizeAndReferenceSize:s,uv:r,sizing:n,angle:a}=t,l=s.xy,c=s.z,p=s.w,d=n.xy,h=n.z,f=(0,m.mh)(t.bitset,N.c.bitset.isStroke),y=n.w,v=(0,m.mh)(t.bitset,N.c.bitset.scaleSymbolsProportionally),g=this._getEvalParams(t,d),b=U(l,S.transform,g),x=(0,u.j1)([(0,u.LC)((0,m.mh)(t.bitset,N.c.bitset.isMapAligned),new u.nt(1)),this.view.rotation.divide(180).multiply(Math.PI)],[!0,new u.nt(0)]),w=new u.Ny((0,u.gn)(x),(0,u.F8)(x.multiply(-1)),(0,u.F8)(x),(0,u.gn)(x)).multiply(b.xy),_=b.z.subtract(x).subtract(a.multiply(A.rp)),z=b.w,V=(0,m.mh)(t.bitset,N.c.bitset.isSDF),P=D(this,e,new u.nt(p)).divide(new u.nt(p));return{baseSize:c,animationPointer:l,strokeWidth:h,isOutline:f,unscaledDistanceToPx:y,scaleSymbolsProportionally:v,isSDF:V,position:this._getScreenPosition({id:e,pos:i,offset:o,referenceSize:p,translation:w,rotation:_,scale:z,vvScale:P}),uv:r,evalParams:g,vvScale:P,scale:z}}vertex(t,e){const{position:i,animationPointer:o,evalParams:s,isOutline:n,unscaledDistanceToPx:a,vvScale:l,uv:c,strokeWidth:p,scaleSymbolsProportionally:d,scale:h,isSDF:f,baseSize:y}=this._vertexPreamble(t),v=this._toNdc(i);let g=U(o,S.fromColor,s);g=new u.Zb(g.rgb.multiply(g.a),g.a);let b=U(o,S.toColor,s);b=new u.Zb(b.rgb.multiply(b.a),b.a);let x=U(o,S.colorMix,s);x=new u.Zb(x.rgb.multiply(x.a),x.a);const w=U(o,S.toOpacity,s).a,_=U(o,S.opacityMix,s).a,A=I(this,t.id,g,(0,u.or)((0,m.K5)(t.bitset,N.c.bitset.colorLocked),new u.x(n))),z=(0,u.jh)(A,b,x),V=k(this,t.id),P=(0,u.jh)(V,w,_),T=z.multiply(P),C=this.clip(t.id,t.zoomRange),M=a.multiply(l);return(0,r.A)({glPosition:new u.Zb(v,C,1),uv:c.divide(this.mosaicInfo.size),color:T.multiply(new u.nt(1).subtract(n)),outlineColor:T.multiply(n),distanceToPx:M,strokeWidth:p.multiply((0,u.jh)(new u.nt(1),h,d)),isOutline:n,isSDF:f},this.maybeRunHittest(t,e,{pos:t.pos,size:y,sizeCorrection:new u.nt(1),isMapAligned:new u.nt(1),vvRotationMat3:new u.U(1,0,0,0,1,0,0,0,1),placementMat3:new u.U(1,0,0,0,1,0,0,0,1),outlineSize:new u.nt(1),distanceToPx:M,isSDF:f}))}fragment(t){let e=this._getColor(t.uv,{color:t.color,distanceToPx:t.distanceToPx,isSDF:t.isSDF,outlineColor:t.outlineColor,outlineSize:t.strokeWidth});return a.H.spotlightAnimatedSymbols&&(e=e.add(new u.Zb(0,.3,0,.3))),this.getFragmentOutput(e,t)}hittest(t,e,i){return(0,u.Tk)((0,u.Xe)(i.size,this.hittestRequest.smallSymbolSizeThreshold),this._hittestSmallMarker(t,e,i),this._hittestMarker(t,e,i))}_hittestSmallMarker(t,e,i){const{position:o,distance:s,smallSymbolDistance:r}=this.hittestRequest,n=s.subtract(r),{viewMat3:a,tileMat3:l}=this.view,c=a.multiply(l).multiply(new u.eB(i.pos,1)).xy,p=i.size.multiply(.5);return(0,u.Io)(c,o).subtract(p).add(n)}_hittestMarker(t,e,i){const o=this._vertexPreamble((0,r.A)({},t)).position,s=this._vertexPreamble((0,r.A)((0,r.A)({},t),{},{offset:e.offsetNextVertex1,uv:e.textureUVNextVertex1})).position,n=this._vertexPreamble((0,r.A)((0,r.A)({},t),{},{offset:e.offsetNextVertex2,uv:e.textureUVNextVertex2})).position,a=this.hittestRequest.position,l=this.hittestRequest.distance,c=K(a,o,s,n);return(0,u.Tk)((0,u.MM)(c,l),c,this._hittestSamples(o,s,n,t,e,i))}_hittestSamples(t,e,i,o,s,r){const{outlineSize:n,isSDF:a,distanceToPx:l}=r,c=this.hittestRequest.position,p=this.hittestRequest.distance,d=H(c.add(new u.ZY((0,u.ze)(p),(0,u.ze)(p))),t,e,i),h=H(c.add(new u.ZY(0,(0,u.ze)(p))),t,e,i),m=H(c.add(new u.ZY(p,(0,u.ze)(p))),t,e,i),f=H(c.add(new u.ZY((0,u.ze)(p),0)),t,e,i),y=H(c,t,e,i),v=H(c.add(new u.ZY(p,0)),t,e,i),g=H(c.add(new u.ZY((0,u.ze)(p),p)),t,e,i),b=H(c.add(new u.ZY(0,p)),t,e,i),x=H(c.add(new u.ZY(p,p)),t,e,i),w=o.uv.divide(this.mosaicInfo.size),_=s.textureUVNextVertex1.divide(this.mosaicInfo.size),S=s.textureUVNextVertex2.divide(this.mosaicInfo.size),A={color:new u.Zb(1,1,1,1),outlineSize:n,outlineColor:new u.Zb(1,1,1,1),isSDF:a,distanceToPx:l};let z=new u.nt(0);return z=z.add(q(d).multiply(this._getColor($(d,w,_,S),A).a)),z=z.add(q(h).multiply(this._getColor($(h,w,_,S),A).a)),z=z.add(q(m).multiply(this._getColor($(m,w,_,S),A).a)),z=z.add(q(f).multiply(this._getColor($(f,w,_,S),A).a)),z=z.add(q(y).multiply(this._getColor($(y,w,_,S),A).a)),z=z.add(q(v).multiply(this._getColor($(v,w,_,S),A).a)),z=z.add(q(g).multiply(this._getColor($(g,w,_,S),A).a)),z=z.add(q(b).multiply(this._getColor($(b,w,_,S),A).a)),z=z.add(q(x).multiply(this._getColor($(x,w,_,S),A).a)),(0,u.PM)(z,new u.nt(.05)).multiply(Q(this.hittestRequest))}}(0,n._)([(0,n.a)(0,(0,l.hF)(W)),(0,n.a)(1,(0,l.hF)(X))],J.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends L{}))],J.prototype,"fragment",null);var tt=i(63919),et=i(85827),it=i(70479);class ot extends it.j{constructor(){super(...arguments),this.symbologyPlane=o.uC.FILL,this._input=null}}var st=i(63584);class rt extends ot{render(t,e){const{context:i,painter:o}=t,{target:s}=e,{freezeGlobalTime:n}=a.H,l=o.textureManager.animationStore.getTexture(i,0),u=[2/t.state.size[0],0,0,0,-2/t.state.size[1],0,-1,1,1],c=Array.from((0,tt.B8)((0,et.vt)(),u)),p=Array.from((0,tt.lw)((0,et.vt)(),c,s.transforms.displayViewScreenMat3)),d=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,d.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey,!0),animationInfo:{globalTime:!1===n?t.time/1e3:n,animationTextureSize:[l.descriptor.width,l.descriptor.height],animationTexture:{unit:6,texture:l},toScreen:p,toNdc:u,mapRotation:t.state.rotation,pixelRatio:t.state.pixelRatio}}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:{zoomRange:!0},useComputeBuffer:!0}),o.setPipelineState((0,r.A)({},(0,st.Qu)(t))),o.submitDraw(t,e),!1===n&&s.requestRender()}}class nt extends l.ZA{}(0,n._)([(0,l.C5)(0,u.ZY)],nt.prototype,"pos",void 0);class at extends l.k2{}(0,n._)([(0,l.Pi)(u.nt)],at.prototype,"dotSize",void 0);class lt extends l.k2{}(0,n._)([(0,l.Pi)(u.z7)],lt.prototype,"locations",void 0),(0,n._)([(0,l.Pi)(u.nt)],lt.prototype,"pixelRatio",void 0),(0,n._)([(0,l.Pi)(u.nt)],lt.prototype,"tileZoomFactor",void 0);class ut extends l.A{constructor(){super(...arguments),this.type="DotDensityPointShader"}vertex(t){const e=new u.U(1,0,0,0,-1,0,0,1,1).multiply(new u.eB(t.pos.xy.divide(d.CQ),1)),i=(0,u.US)(this.draw.locations,e.xy),o=(0,u.T9)(this.instance.dotSize.divide(2),new u.nt(1));let s=new u.nt(0);s=s.add((0,u.PM)(i.a,new u.nt(1e-6)).multiply(2));let r=o.add(this.instance.dotSize);const n=this.view.displayViewScreenMat3.multiply(new u.eB(t.pos.add(.5),1)),a=new u.Zb(n.xy,s,1),l=this.instance.dotSize.divide(r),c=new u.nt(-1).divide(o.divide(r));return r=r.multiply(this.draw.pixelRatio.multiply(this.draw.tileZoomFactor)),{glPosition:a,glPointSize:r,color:i,ratio:l,invEdgeRatio:c}}fragment(t){const e=(0,u.Bw)(t.glPointCoord.subtract(.5)).multiply(2),i=(0,u.TF)(new u.nt(0),new u.nt(1),t.invEdgeRatio.multiply(e.subtract(t.ratio)).add(1)),o=new l.mm;return o.fragColor=t.color.multiply(i),o}}(0,n._)([(0,l.Pi)(at)],ut.prototype,"instance",void 0),(0,n._)([(0,l.Pi)(lt)],ut.prototype,"draw",void 0),(0,n._)([(0,l.Pi)(g)],ut.prototype,"view",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(nt))],ut.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],ut.prototype,"fragment",null);class ct extends b{}(0,n._)([(0,l.C5)(3,u.nt)],ct.prototype,"inverseArea",void 0);class pt extends l.k2{}(0,n._)([(0,l.Pi)(u.My.ofType(u.Zb,2))],pt.prototype,"isActive",void 0),(0,n._)([(0,l.Pi)(u.My.ofType(u.Zb,8))],pt.prototype,"colors",void 0),(0,n._)([(0,l.Pi)(u.nt)],pt.prototype,"dotValue",void 0);class dt extends l.k2{}(0,n._)([(0,l.Pi)(u.z7)],dt.prototype,"dotTexture0",void 0),(0,n._)([(0,l.Pi)(u.z7)],dt.prototype,"dotTexture1",void 0),(0,n._)([(0,l.Pi)(u.nt)],dt.prototype,"tileZoomFactor",void 0),(0,n._)([(0,l.Pi)(u.nt)],dt.prototype,"pixelRatio",void 0),(0,n._)([(0,l.Pi)(u.nt)],dt.prototype,"tileDotsOverArea",void 0);class ht extends _{constructor(){super(...arguments),this.type="DotDensityPolygonShader"}_dotThreshold(t,e,i){return t.divide(e).divide(i)}vertex(t){const e=new u.U(2/d.CQ,0,0,0,-2/d.CQ,0,-1,1,1).multiply(new u.eB(t.pos,1)),i=this.clip(t.id),o=new u.Zb(e.xy,i,1),s=this.storage.getVVData(t.id).multiply(this.instance.isActive.get(0)).multiply(t.inverseArea),r=this.storage.getDataDrivenData0(t.id).multiply(this.instance.isActive.get(1)).multiply(t.inverseArea),n=this.draw.tileZoomFactor.multiply(d.CQ).divide(this.draw.pixelRatio),a=this._dotThreshold(s,this.instance.dotValue,this.draw.tileDotsOverArea),l=this._dotThreshold(r,this.instance.dotValue,this.draw.tileDotsOverArea),c=t.pos.add(.5).divide(n);return{glPosition:o,color:new u.Zb(0,0,0,0),textureCoords:c,thresholds0:a,thresholds1:l}}fragment(t){const e=new l.mm,i=(0,u.US)(this.draw.dotTexture0,t.textureCoords),o=(0,u.US)(this.draw.dotTexture1,t.textureCoords),s=t.thresholds0.subtract(i),r=t.thresholds1.subtract(o);let n;const a=u.$I.fromColumns(this.instance.colors[0],this.instance.colors[1],this.instance.colors[2],this.instance.colors[3]),c=u.$I.fromColumns(this.instance.colors[4],this.instance.colors[5],this.instance.colors[6],this.instance.colors[7]);if(this.blending){const t=(0,u.PM)(new u.nt(0),s),e=(0,u.PM)(new u.nt(0),r),i=(0,u.Om)(t,s).add((0,u.Om)(e,r)),o=(0,u.PM)(i,new u.nt(0)),l=new u.nt(1).subtract(o),p=i.add(o),d=s.multiply(t).divide(p),h=r.multiply(e).divide(p),m=a.multiply(d).add(c.multiply(h));n=l.multiply(m)}else{const t=(0,u.T9)((0,m.xf)(s),(0,m.xf)(r)),e=(0,u.PM)(t,new u.nt(0)),i=new u.nt(1).subtract(e),o=(0,u.PM)(t,s),l=(0,u.PM)(t,r),p=a.multiply(o).add(c.multiply(l));n=i.multiply(p)}return e.fragColor=n,e}hittest(t){return Q(this.hittestRequest)}}(0,n._)([l.E8],ht.prototype,"blending",void 0),(0,n._)([(0,l.Pi)(pt)],ht.prototype,"instance",void 0),(0,n._)([(0,l.Pi)(dt)],ht.prototype,"draw",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(ct))],ht.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(w))],ht.prototype,"fragment",null);var mt=i(47249),ft=i(16946),yt=i(93345),vt=i(12331),gt=i(62881),bt=i(88800),xt=i(80895),wt=i(96673);const _t={pos:{count:2,type:yt.pe.UNSIGNED_SHORT}};class St{constructor(){this._dotTextureSize=0,this._dotTextures=null,this._dotMesh=null}destroy(){this._disposeTextures(),this._dotFBO&&this._dotFBO.dispose(),this._dotMesh&&this._dotMesh.destroy()}getFBO(t){if(null==this._dotFBO){const e=d.CQ,i=d.CQ,o=new wt.R(e,i);o.samplingMode=yt.Cj.NEAREST,o.wrapMode=yt.pF.CLAMP_TO_EDGE;const s=new gt.l(t,new bt.q(yt.yQ.DEPTH_STENCIL,e,i));this._dotFBO=new vt.H(t,o,s)}return this._dotFBO}getDotDensityMesh(t){if(null==this._dotMesh){const e=d.CQ,i=e*e,o=2,s=new Int16Array(i*o);for(let t=0;t<e;t++)for(let i=0;i<e;i++)s[o*(i+t*e)]=i,s[o*(i+t*e)+1]=t;this._dotMesh=ft.g.create(t,{primitive:yt.WR.POINTS,vertex:s,count:i,layout:_t})}return this._dotMesh}getDotDensityTextures(t,e,i){if(this._dotTextureSize===e&&this._seed===i||(this._disposeTextures(),this._dotTextureSize=e,this._seed=i),null===this._dotTextures){const o=new mt.A(i);this._dotTextures=[this._allocDotDensityTexture(t,e,o),this._allocDotDensityTexture(t,e,o)]}return this._dotTextures}_disposeTextures(){if(this._dotTextures){for(let t=0;t<this._dotTextures.length;t++)this._dotTextures[t].dispose();this._dotTextures=null}}_allocDotDensityTexture(t,e,i){const o=new Float32Array(e*e*4);for(let r=0;r<o.length;r++)o[r]=i.getFloat();const s=new wt.R;return s.dataType=yt.ld.FLOAT,s.samplingMode=yt.Cj.NEAREST,s.width=e,s.height=e,new xt.g(t,s,o)}}class At extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],At.prototype,"color",void 0),(0,n._)([(0,l.C5)(4,u.ZY)],At.prototype,"zoomRange",void 0);class zt extends _{constructor(){super(...arguments),this.type="FillShader",this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const i=k(this,t.id),o=I(this,t.id,t.color).multiply(i),s=this.view.displayViewScreenMat3.multiply(new u.eB(t.pos.xy,1)),n=this.clip(t.id,t.zoomRange);return(0,r.A)({glPosition:new u.Zb(s.xy,n,1),color:o},this.maybeRunHittest(t,e,null))}fragment(t){return this.getFragmentOutput(t.color,t,new u.nt(0))}hittest(t,e){return G(this,t,e)}}(0,n._)([(0,l.uK)(V)],zt.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],zt.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(At)),(0,n.a)(1,(0,l.hF)(x))],zt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(w))],zt.prototype,"fragment",null);class Vt extends l.k2{getPatternOffsetAtTileOrigin(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.nt(0),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new u.nt(1);const o=new u.ZY(A.YV).divide(t);let s=t.multiply((0,u.jc)(this.maxIntsToLocalOrigin.multiply(o))).add(this.tileOffsetFromLocalOrigin).subtract(new u.nt(.5).multiply(t));return s=new u.ZY(s.x.multiply(i).subtract(s.y.multiply(e)),s.x.multiply(e).add(s.y.multiply(i))),(0,u.zi)(s,t)}}(0,n._)([(0,l.Pi)(u.ZY)],Vt.prototype,"tileOffsetFromLocalOrigin",void 0),(0,n._)([(0,l.Pi)(u.ZY)],Vt.prototype,"maxIntsToLocalOrigin",void 0);class Pt extends At{}(0,n._)([(0,l.C5)(5,u.Zb)],Pt.prototype,"tlbr",void 0),(0,n._)([(0,l.C5)(6,u.nt)],Pt.prototype,"width",void 0),(0,n._)([(0,l.C5)(7,u.nt)],Pt.prototype,"height",void 0),(0,n._)([(0,l.C5)(8,u.ZY)],Pt.prototype,"offset",void 0),(0,n._)([(0,l.C5)(9,u.ZY)],Pt.prototype,"scale",void 0),(0,n._)([(0,l.C5)(10,u.nt)],Pt.prototype,"angle",void 0);function Tt(t,e){const i=t.view.requiredZoomFactor,o=new u.ZY(e.width,e.height),s=o.multiply(e.scale).multiply(i),r=e.angle.multiply(A.rp),n=(0,u.F8)(r),a=(0,u.gn)(r),l=function(t,e,i,o,s){const r=(0,u.LC)((0,m.mh)(s,A.Fz),(0,u.fV)(1)),n=(0,m.Rj)(new u.Zb(t,0));return(0,u.Tk)(r,(0,u.w0)(o.divide(e.x),i.divide(e.y),0,(0,u.ze)(i.divide(e.x)),o.divide(e.y),0,(0,m._9)((0,u.Zc)(n,0)),(0,m._9)((0,u.Zc)(0,n)),1),(0,u.w0)(o.divide(e.x),i.divide(e.y),0,(0,u.ze)(i.divide(e.x)),o.divide(e.y),0,0,0,1))}(e.id,s,n,a,e.bitset),c=t.localTileOffset.getPatternOffsetAtTileOrigin(o,n,a),p=i.multiply(e.scale).multiply(e.offset.subtract(c)).divide(s),d=new u.eB(e.pos,1),h=l.multiply(d).xy.subtract(p),f=e.tlbr.divide(t.mosaicInfo.size.xyxy);let y=(0,m.mh)(e.bitset,A.cn);return null!=t.visualVariableColor&&(y=(0,u.Tk)((0,m.M8)(t.storage.getColorValue(e.id)),new u.nt(0),y)),{tileTextureCoord:h,tlbr:f,sampleAlphaOnly:y}}function Ct(t,e){const i=(0,u.zi)(e.tileTextureCoord,new u.nt(1)),o=(0,u.jh)(e.tlbr.xy,e.tlbr.zw,i);let s=(0,u.US)(t.mosaicInfo.texture,o);return s=(0,u.Tk)((0,u.MM)(e.sampleAlphaOnly,new u.nt(.5)),s.aaaa,s),e.color.multiply(s)}class Mt extends zt{constructor(){super(...arguments),this.type="ComplexFillShader"}vertex(t,e){return(0,r.A)((0,r.A)({},super.vertex(t,e)),Tt(this,t))}fragment(t){const e=Ct(this,t);return this.getFragmentOutput(e,t,new u.nt(0))}}(0,n._)([(0,l.Pi)(z)],Mt.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(Vt)],Mt.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Pt)),(0,n.a)(1,(0,l.hF)(x))],Mt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],Mt.prototype,"fragment",null);function Ot(t){const e=1/t;return{antialiasing:e,blur:0+e}}class Rt extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],Rt.prototype,"color",void 0),(0,n._)([(0,l.C5)(4,u.ZY)],Rt.prototype,"offset",void 0),(0,n._)([(0,l.C5)(5,u.ZY)],Rt.prototype,"normal",void 0),(0,n._)([(0,l.C5)(6,u.nt)],Rt.prototype,"halfWidth",void 0),(0,n._)([(0,l.C5)(7,u.nt)],Rt.prototype,"referenceHalfWidth",void 0),(0,n._)([(0,l.C5)(8,u.ZY)],Rt.prototype,"zoomRange",void 0);class Ft extends w{}class Dt extends l.k2{}function It(t){return(0,u.T9)(new u.nt(A.Fb).multiply((0,u.PM)(t,new u.nt(A.J5))),new u.nt(1))}function kt(t,e){const{halfWidth:i,normal:o}=t,s=It(i),r=(0,u.Bw)(o).multiply(i);return(0,u.qE)(s.multiply(i.subtract(r)).divide(e.add(s).subtract(new u.nt(1))),new u.nt(0),new u.nt(1))}function Et(t,e){const{id:i,offset:o,pos:s,normal:r,zoomRange:n}=e,{displayViewScreenMat3:a,displayViewMat3:l}=t.view,c=I(t,i,e.color),p=k(t,i),d=function(t,e){const{id:i,halfWidth:o,referenceHalfWidth:s}=e;if(F(t)){const e=D(t,i,new u.nt(2).multiply(s));return new u.nt(.5).multiply(o.divide((0,u.T9)(s,new u.nt(A.Ni)))).multiply(e)}return o}(t,e),h=new u.nt(.5).multiply(t.antialiasingControls.antialiasing),m=(0,u.T9)(d.add(h),new u.nt(.45)).add(new u.nt(.1).multiply(h)),f=It(m).multiply(m).multiply(o),y=l.multiply(new u.eB(f,new u.nt(0))),v=a.multiply(new u.eB(s,new u.nt(1))).add(y),g=new u.nt(2).multiply((0,u.PM)(d,new u.nt(0))).add(t.clip(i,n)),b=new u.Zb(v.xy,g,1);return{color:c,opacity:p,halfWidth:m,normal:r,scaledOffset:f,scaledHalfWidth:d,glPosition:new u.Zb(b.xy,g,1)}}function Zt(t,e){const{opacity:i,color:o}=t,s=kt(t,e);return i.multiply(o).multiply(s)}(0,n._)([(0,l.Pi)(u.nt)],Dt.prototype,"antialiasing",void 0),(0,n._)([(0,l.Pi)(u.nt)],Dt.prototype,"blur",void 0);class Lt extends _{constructor(){super(...arguments),this.type="LineShader",this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){const i=Et(this,t);return(0,r.A)((0,r.A)({},i),this.maybeRunHittest(t,e,i.halfWidth))}fragment(t){const e=Zt(t,this.antialiasingControls.blur);return this.getFragmentOutput(e,t)}hittest(t,e,i){const{viewMat3:o,tileMat3:s}=this.view,r=o.multiply(s),n=r.multiply(new u.eB(t.pos,1)),a=r.multiply(new u.eB(e.nextPos1,1)),l=r.multiply(new u.eB(e.nextPos2,1)),{distance:c,smallSymbolDistance:p,smallSymbolSizeThreshold:d}=this.hittestRequest,h=(0,u.PM)(i,d.multiply(.5)).multiply(c.subtract(p)),m=this.hittestRequest.position;return(0,u.jk)(Y(m,n.xy,a.xy),Y(m,n.xy,l.xy)).subtract(i).add(h)}}(0,n._)([(0,l.Pi)(Dt)],Lt.prototype,"antialiasingControls",void 0),(0,n._)([(0,l.uK)(V)],Lt.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],Lt.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,l.uK)(C)],Lt.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,l.uK)(M)],Lt.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,l.uK)(O)],Lt.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,l.uK)(R)],Lt.prototype,"visualVariableSizeUnitValue",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Rt)),(0,n.a)(1,(0,l.hF)(x))],Lt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(Ft))],Lt.prototype,"fragment",null);class Bt extends b{}(0,n._)([(0,l.C5)(3,u.ZY)],Bt.prototype,"offset",void 0),(0,n._)([(0,l.C5)(4,u.Zb)],Bt.prototype,"color",void 0),(0,n._)([(0,l.C5)(5,u.ZY)],Bt.prototype,"normal",void 0),(0,n._)([(0,l.C5)(6,u.nt)],Bt.prototype,"halfWidth",void 0),(0,n._)([(0,l.C5)(7,u.nt)],Bt.prototype,"referenceHalfWidth",void 0),(0,n._)([(0,l.C5)(8,u.ZY)],Bt.prototype,"zoomRange",void 0);class Ut extends Ft{}function Nt(t,e,i){const{id:o,bitset:s}=e,n=(0,m.mh)(s,A.Xx),a=(0,u.MM)(n,new u.nt(.5)),l=Et(t,e),c=(0,u.Tk)(a,l.halfWidth,new u.nt(0)),p=k(t,o),d=I(t,o,e.color),h=(0,u.Tk)(a,e.color,d.multiply(p)),f=t.view.displayViewScreenMat3.multiply(new u.eB(e.pos.xy,1)),y=t.clip(e.id),v=new u.Zb(f.xy,y,1),g=(0,u.Tk)(a,l.glPosition,v),b=i&&t.maybeRunHittest(e,i,a);return(0,r.A)({isOutline:n,color:h,opacity:new u.nt(1),halfWidth:c,normal:l.normal,glPosition:g},b)}class Yt extends _{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,n._)([(0,l.Pi)(Dt)],Yt.prototype,"antialiasingControls",void 0),(0,n._)([(0,l.uK)(V)],Yt.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],Yt.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,l.uK)(C)],Yt.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,l.uK)(M)],Yt.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,l.uK)(O)],Yt.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,l.uK)(R)],Yt.prototype,"visualVariableSizeUnitValue",void 0);class qt extends Yt{constructor(){super(...arguments),this.type="OutlineFillShader"}vertex(t,e){return Nt(this,t,e)}fragment(t){const{color:e,isOutline:i}=t,o=(0,u.MM)(i,new u.nt(.5)),s=Zt(t,this.antialiasingControls.blur),r=(0,u.Tk)(o,s,e),n=(0,u.Tk)(o,new u.nt(1/255),new u.nt(0));return this.getFragmentOutput(r,t,n)}hittest(t,e,i){return(0,u.Tk)(i,Q(this.hittestRequest),G(this,t,e))}}(0,n._)([(0,n.a)(0,(0,l.hF)(Bt)),(0,n.a)(1,(0,l.hF)(x))],qt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(Ut))],qt.prototype,"fragment",null);class Ht extends At{}(0,n._)([(0,l.C5)(5,u.Zb)],Ht.prototype,"tlbr",void 0),(0,n._)([(0,l.C5)(6,u.nt)],Ht.prototype,"inverseRasterizationScale",void 0);function jt(t,e){const i=e.tlbr.xy,o=e.tlbr.zw,s=o.x.subtract(i.x),r=i.y.subtract(o.y),n=new u.ZY(s,r).multiply(e.inverseRasterizationScale),a=n.multiply(t.view.requiredZoomFactor),l=function(t){const e=new u.nt(1),i=new u.nt(0);return new u.U(e.divide(t.x),i.divide(t.y),0,(0,u.ze)(i.divide(t.x)),e.divide(t.y),0,0,0,1)}(a),c=t.localTileOffset.getPatternOffsetAtTileOrigin(n).divide(a),p=new u.eB(e.pos,1);return{tileTextureCoord:l.multiply(p).xy.subtract(c),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function Kt(t,e){const i=(0,u.zi)(t.tileTextureCoord,new u.nt(1)),o=(0,u.jh)(t.tlbr.xy,t.tlbr.zw,i),s=(0,u.US)(e.texture,o);return t.color.multiply(s)}class Qt extends zt{constructor(){super(...arguments),this.type="PatternFillShader"}vertex(t,e){return(0,r.A)((0,r.A)({},super.vertex(t,e)),jt(this,t))}fragment(t){const e=Kt(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new u.nt(0))}}(0,n._)([(0,l.Pi)(z)],Qt.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(Vt)],Qt.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Ht)),(0,n.a)(1,(0,l.hF)(x))],Qt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],Qt.prototype,"fragment",null);class Gt extends Bt{}(0,n._)([(0,l.C5)(9,u.Zb)],Gt.prototype,"tlbr",void 0),(0,n._)([(0,l.C5)(10,u.nt)],Gt.prototype,"inverseRasterizationScale",void 0);class Wt extends Ut{}class Xt extends qt{constructor(){super(...arguments),this.type="PatternOutlineFillShader"}vertex(t,e){return(0,r.A)((0,r.A)({},Nt(this,t,e)),jt(this,t))}fragment(t){const{isOutline:e}=t,i=(0,u.MM)(e,new u.nt(.5)),o=Zt(t,this.antialiasingControls.blur),s=Kt(t,this.mosaicInfo),r=(0,u.Tk)(i,o,s),n=(0,u.Tk)(i,new u.nt(1/255),new u.nt(0));return this.getFragmentOutput(r,t,n)}}(0,n._)([(0,l.Pi)(z)],Xt.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(Vt)],Xt.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Gt)),(0,n.a)(1,(0,l.hF)(x))],Xt.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(Wt))],Xt.prototype,"fragment",null);const $t=1/A.cZ;class Jt extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],Jt.prototype,"color",void 0),(0,n._)([(0,l.C5)(4,u.Zb)],Jt.prototype,"tlbr",void 0),(0,n._)([(0,l.C5)(5,u.nt)],Jt.prototype,"angle",void 0),(0,n._)([(0,l.C5)(6,u.nt)],Jt.prototype,"aux1",void 0),(0,n._)([(0,l.C5)(7,u.nt)],Jt.prototype,"aux2",void 0),(0,n._)([(0,l.C5)(8,u.ZY)],Jt.prototype,"aux3",void 0),(0,n._)([(0,l.C5)(9,u.ZY)],Jt.prototype,"aux4",void 0),(0,n._)([(0,l.C5)(10,u.ZY)],Jt.prototype,"zoomRange",void 0);class te extends Yt{constructor(){super(...arguments),this.type="ComplexOutlineFillShader"}vertex(t,e){const{aux1:i,aux2:o,aux3:s,aux4:n}=t,a=(0,r.A)((0,r.A)({},t),{},{width:i,height:o,offset:s,scale:n.multiply($t)}),l=Nt(this,(0,r.A)((0,r.A)({},t),{},{halfWidth:i,referenceHalfWidth:o,offset:s,normal:n.subtract(A.v9).multiply($t)})),c=Tt(this,a),p=(0,u.MM)(l.isOutline,new u.nt(.5));return(0,r.A)((0,r.A)((0,r.A)({},l),c),this.maybeRunHittest(t,e,p))}fragment(t){const{isOutline:e}=t,i=(0,u.MM)(e,new u.nt(.5)),o=Zt(t,this.antialiasingControls.blur),s=Ct(this,t),r=(0,u.Tk)(i,o,s),n=(0,u.Tk)(i,new u.nt(1/255),new u.nt(0));return this.getFragmentOutput(r,t,n)}hittest(t,e,i){return(0,u.Tk)(i,Q(this.hittestRequest),G(this,t,e))}}(0,n._)([(0,l.Pi)(z)],te.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(Vt)],te.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Jt)),(0,n.a)(1,(0,l.hF)(x))],te.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends Wt{}))],te.prototype,"fragment",null);var ee=i(4037);class ie extends At{}(0,n._)([(0,l.C5)(5,u.Zb)],ie.prototype,"tlbr",void 0),(0,n._)([(0,l.C5)(6,u.ZY)],ie.prototype,"relativePosition",void 0),(0,n._)([(0,l.C5)(7,u.nt)],ie.prototype,"gradientMethod",void 0),(0,n._)([(0,l.C5)(8,u.ZY)],ie.prototype,"relativeGradientSize",void 0);class oe extends zt{constructor(){super(...arguments),this.type="GradientFillShader"}vertex(t,e){const{tlbr:i,relativePosition:o,gradientMethod:s,relativeGradientSize:n}=t,a=(0,u.Tk)((0,m.K5)(t.bitset,ee.Q.isAbsolute),this.view.displayZoomFactor,new u.nt(1));return(0,r.A)((0,r.A)({},super.vertex(t,e)),{},{tlbr:i,relativePosition:o,gradientMethod:s,gradientSize:n.multiply(a),isDiscrete:(0,m.mh)(t.bitset,ee.Q.isDiscrete)})}fragment(t){const{tlbr:e,relativePosition:i,gradientMethod:o,gradientSize:s,isDiscrete:r}=t,n=(0,u.Tk)((0,u.MM)(r,new u.nt(.5)),s.subtract(1),new u.ZY(0)),a=(0,u.j1)([(0,u.LC)(o,new u.nt(ee.m.rectangular)),()=>{const t=(0,u.tn)(i).add(n).divide(s);return(0,m.zb)((0,u.T9)(t.x,t.y))}],[(0,u.LC)(o,new u.nt(ee.m.circular)),(0,m.zb)((0,u.RZ)((0,u.Om)(i,i)).add(n.x).divide(s.x))],[!0,(0,m.zb)(i.x.add(n.x).divide(s.x))]),l=new u.ZY((0,u.qE)(a,new u.nt(0),new u.nt(1)),.5),c=(0,u.jh)(e.xy,e.zw,l).divide(this.mosaicInfo.size),p=(0,u.US)(this.mosaicInfo.texture,c),d=t.color.a;return this.getFragmentOutput(p.multiply(d),t,new u.nt(0))}}(0,n._)([(0,l.Pi)(z)],oe.prototype,"mosaicInfo",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(ie)),(0,n.a)(1,(0,l.hF)(x))],oe.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],oe.prototype,"fragment",null);var se=i(76460),re=i(30726),ne=i(50076);class ae{constructor(t,e,i,o){this.dataType=t,this.samplingMode=e,this.pixelFormat=i,this.internalFormat=o}}new ae(yt.ld.HALF_FLOAT,yt.Cj.NEAREST,yt.Ab.RGBA,yt.Ab.RGBA);class le{destroy(){this._accumulateFramebuffer=(0,re.WD)(this._accumulateFramebuffer),this._resolveGradientTexture=(0,re.WD)(this._resolveGradientTexture),this._prevGradientHash=null,this._qualityProfile=null}get initialized(){return null!=this._accumulateFramebuffer&&null!=this._resolveGradientTexture}get accumulateFramebuffer(){return this._accumulateFramebuffer}get resolveGradientTexture(){return this._resolveGradientTexture}loadQualityProfile(t){if(null==this._qualityProfile){const e=function(t,e){const{textureFloatLinear:i,colorBufferFloat:o}=t.capabilities,s=null===o||void 0===o?void 0:o.textureFloat,r=null===o||void 0===o?void 0:o.textureHalfFloat,n=null===o||void 0===o?void 0:o.floatBlend,a=t.driverTest.floatBufferBlend.result;if(!s&&!r)throw new ne.A("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(n&&a||r))throw new ne.A("heatmap:missing-float-blend","HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float."+(a?"":" This device claims support for EXT_float_blend, but does not actually support it."));const l=s&&n&&a,u=r,c=i,p=!(null===o||void 0===o||!o.R32F),d=!(null===o||void 0===o||!o.R16F);if(l&&c)return c||e.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),new ae(yt.ld.FLOAT,c?yt.Cj.LINEAR:yt.Cj.NEAREST,p?yt.Ab.RED:yt.Ab.RGBA,p?yt.H0.R32F:yt.Ab.RGBA);if(u)return new ae(yt.ld.HALF_FLOAT,yt.Cj.LINEAR,d?yt.Ab.RED:yt.Ab.RGBA,d?yt.H0.R16F:yt.Ab.RGBA);throw new ne.A("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.")}(t,se.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.heatmap.HeatmapResources"));this._qualityProfile=(0,r.A)((0,r.A)({},e),{},{defines:{usesHalfFloatPrecision:e.dataType!==yt.ld.FLOAT}})}return this._qualityProfile}ensureAccumulateFBO(t,e,i){if(null==this._accumulateFramebuffer){const{dataType:o,samplingMode:s,pixelFormat:r,internalFormat:n}=this.loadQualityProfile(t),a=new wt.R(e,i);a.pixelFormat=r,a.internalFormat=n,a.dataType=o,a.samplingMode=s,a.wrapMode=yt.pF.CLAMP_TO_EDGE;const l=new bt.q(yt.yQ.DEPTH_STENCIL,e,i);this._accumulateFramebuffer=new vt.H(t,a,l)}else{const{width:t,height:o}=this._accumulateFramebuffer;t===e&&o===i||this._accumulateFramebuffer.resize(e,i)}return this._accumulateFramebuffer}ensureResolveGradientTexture(t,e,i){if(null==this._resolveGradientTexture){const e=new wt.R;e.wrapMode=yt.pF.CLAMP_TO_EDGE,this._resolveGradientTexture=new xt.g(t,e),this._prevGradientHash=null}return this._prevGradientHash!==e&&(this._resolveGradientTexture.resize(i.length/4,1),this._resolveGradientTexture.setData(i),this._prevGradientHash=e),this._resolveGradientTexture}}function ue(t){return t?.25:1}class ce extends b{}(0,n._)([(0,l.C5)(5,u.ZY)],ce.prototype,"offset",void 0);class pe extends l.k2{}(0,n._)([(0,l.Pi)(u.nt)],pe.prototype,"radius",void 0),(0,n._)([(0,l.Pi)(u.nt)],pe.prototype,"isFieldActive",void 0);class de extends _{constructor(){super(...arguments),this.type="HeatmapAccumulateShader",this.usesHalfFloatPrecision=!1}vertex(t){const{radius:e,isFieldActive:i}=this.kernelControls,o=t.offset,s=i.multiply(this.storage.getVVData(t.id).x).add(new u.nt(1).subtract(i)),n=this.view.displayViewScreenMat3.multiply(new u.eB(t.pos,1)).add(this.view.displayViewMat3.multiply(new u.eB(o,0)).multiply(e)),a=this.clip(t.id);return(0,r.A)({glPosition:new u.Zb(n.xy,a,1),offset:o,fieldValue:s,color:new u.Zb(0)},this.maybeRunHittest(t,{},null))}fragment(t){const{offset:e,fieldValue:i}=t,o=(0,u.Bw)(e),s=(0,u.PM)(o,new u.nt(1)),r=new u.nt(1).subtract(o.multiply(o)),n=r.multiply(r),a=s.multiply(n).multiply(i).multiply(new u.nt(ue(this.usesHalfFloatPrecision)));return this.getFragmentOutput(new u.Zb(a),t)}hittest(t){const{viewMat3:e,tileMat3:i}=this.view;return function(t,e,i){return(0,u.Io)(t,i).subtract(e)}(e.multiply(i).multiply(new u.eB(t.pos,1)).xy,this.kernelControls.radius,this.hittestRequest.position)}}(0,n._)([l.E8],de.prototype,"usesHalfFloatPrecision",void 0),(0,n._)([(0,l.Pi)(pe)],de.prototype,"kernelControls",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(ce))],de.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],de.prototype,"fragment",null);class he extends l.ZA{}(0,n._)([(0,l.C5)(0,u.ZY)],he.prototype,"position",void 0);class me extends l.HS{}class fe extends l.k2{}(0,n._)([(0,l.Pi)(u.z7)],fe.prototype,"texture",void 0),(0,n._)([(0,l.Pi)(u.ZY)],fe.prototype,"minAndInvRange",void 0),(0,n._)([(0,l.Pi)(u.nt)],fe.prototype,"normalization",void 0);class ye extends l.k2{}(0,n._)([(0,l.Pi)(u.z7)],ye.prototype,"texture",void 0);class ve extends l.A{constructor(){super(...arguments),this.type="HeatmapResolveShader",this.usesHalfFloatPrecision=!1}vertex(t){return{glPosition:new u.Zb(t.position.multiply(2).subtract(1),1,1),uv:t.position}}fragment(t){const{accumulatedDensity:e,gradient:i}=this;let o=(0,u.US)(e.texture,t.uv).r.divide(new u.nt(ue(this.usesHalfFloatPrecision)));o=o.multiply(e.normalization),o=o.subtract(e.minAndInvRange.x).multiply(e.minAndInvRange.y);const s=(0,u.US)(i.texture,new u.ZY(o,.5)),r=new l.mm;return r.fragColor=new u.Zb(s.rgb.multiply(s.a),s.a),r}}(0,n._)([l.E8],ve.prototype,"usesHalfFloatPrecision",void 0),(0,n._)([(0,l.Pi)(fe)],ve.prototype,"accumulatedDensity",void 0),(0,n._)([(0,l.Pi)(ye)],ve.prototype,"gradient",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(he))],ve.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(me))],ve.prototype,"fragment",null);function ge(t){return t.key.level+1}const be={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:{write:!1,test:{ref:ge,compare:yt.MT.GEQUAL,mask:255,op:{fail:yt.eA.KEEP,zFail:yt.eA.KEEP,zPass:yt.eA.REPLACE}}}},xe=(0,r.A)((0,r.A)({},be),{},{stencil:!1}),we={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:!1};function _e(t,e){const{referenceScale:i,radius:o}=t.uniforms;return o*(0!==i?i/e.scale:1)}const Se=360/254;var Ae;!function(t){t[t.Color=0]="Color",t[t.Outline=1]="Outline",t[t.Halo=2]="Halo"}(Ae||(Ae={}));class ze extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],ze.prototype,"color",void 0),(0,n._)([(0,l.C5)(4,u.ZY)],ze.prototype,"offset",void 0),(0,n._)([(0,l.C5)(5,u.ZY)],ze.prototype,"textureUV",void 0),(0,n._)([(0,l.C5)(6,u.nt)],ze.prototype,"fontSize",void 0),(0,n._)([(0,l.C5)(7,u.nt)],ze.prototype,"referenceSize",void 0),(0,n._)([(0,l.C5)(8,u.Zb)],ze.prototype,"outlineColor",void 0),(0,n._)([(0,l.C5)(9,u.Zb)],ze.prototype,"haloColor",void 0),(0,n._)([(0,l.C5)(10,u.ZY)],ze.prototype,"outlineAndHaloSize",void 0),(0,n._)([(0,l.C5)(11,u.ZY)],ze.prototype,"zoomRange",void 0),(0,n._)([(0,l.C5)(12,u.nt)],ze.prototype,"clipAngle",void 0),(0,n._)([(0,l.C5)(13,u.Zb)],ze.prototype,"referenceSymbol",void 0);class Ve extends l.Y7{}(0,n._)([(0,l.C5)(14,u.ZY)],Ve.prototype,"offsetNextVertex1",void 0),(0,n._)([(0,l.C5)(15,u.ZY)],Ve.prototype,"offsetNextVertex2",void 0);class Pe extends _{constructor(){super(...arguments),this.type="TextShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"]},this.textRenderPassType=Ae.Color,this.isBackgroundPass=!1,this.isLabel=!1}clipLabel(t,e,i){const o=e.multiply(Se),s=(0,u.tn)(this.view.rotation.subtract(o)),r=(0,u.jk)(new u.nt(360).subtract(s),s);let n=new u.nt(0);const a=(0,u.RI)(this.view.currentZoom.multiply(d.fq)).divide(d.fq),l=t.x,c=t.y,p=new u.nt(1).subtract((0,u.PM)(l,a)).multiply(2),h=(0,u.PM)(new u.nt(90),r).multiply(2),m=new u.nt(2).multiply(new u.nt(1).subtract((0,u.PM)(a,c)));return n=n.add(i.multiply(p)),n=n.add(i.multiply(h)),n=n.add(m),n}vertex(t,e){const i=(0,m.mh)(t.bitset,A.bg),o=new u.nt(1).subtract(i);let s=t.fontSize,n=s.divide(A.au);const a=this.textRenderPassType===Ae.Outline?t.outlineColor:this.textRenderPassType===Ae.Halo?t.haloColor:this._getVertexColor(t),l=this.isLabel?this.storage.getLabelVisibility(t.id):new u.nt(1),c=this.isLabel?a.multiply(l):a,p=this.view.displayViewScreenMat3.multiply(new u.eB(t.pos,1));let h=t.offset,f=new u.nt(1),y=u.U.identity(),v=new u.ZY(0);if(this.isLabel){if(!t.referenceSymbol)throw new Error("InternalError: Optional attribute 'referenceSymbol' expected for labels");const e=t.referenceSymbol,i=e.xy,o=e.z,s=this._unpackDirection(e.w),r=D(this,t.id,o).divide(2),n=s.multiply(r.add(d.C2));v=i.add(n),h=h.add(v)}else f=D(this,t.id,t.referenceSize).divide(t.referenceSize),s=s.multiply(f),n=n.multiply(f),h=h.multiply(f),y=E(this,t.id),h=y.multiply(new u.eB(h,0)).xy;const g=(0,m.mh)(t.bitset,A.ti),b=this._getViewRotationMatrix(g).multiply(new u.eB(h,0));let x=this.isLabel?this.clipLabel(t.zoomRange,t.clipAngle,g):this.clip(t.id,t.zoomRange);x=this.isBackgroundPass?x.add(o.multiply(2)):x.add(i.multiply(2));let w=new u.nt(0);if(this.textRenderPassType===Ae.Outline&&(x=x.add((0,u.Tk)((0,u.LC)(t.outlineAndHaloSize.x,new u.nt(0)),new u.nt(2),new u.nt(0))),w=new u.nt(t.outlineAndHaloSize.x).divide(n).divide(A.$w)),this.textRenderPassType===Ae.Halo){const e=t.outlineAndHaloSize.x,i=new u.nt(t.outlineAndHaloSize.y);x=x.add((0,u.Tk)((0,u.LC)(i,new u.nt(0)),new u.nt(2),new u.nt(0))),w=i.add(e).divide(n).divide(A.$w)}const _=this.isLabel?(0,u.or)((0,u.MM)(x,new u.nt(1)),(0,u.$5)(l,new u.nt(0))):new u.x(!1);return(0,r.A)({glPosition:new u.Zb(p.xy.add(b.xy),x,1),color:c,size:n,textureUV:t.textureUV.divide(this.mosaicInfo.size),antialiasingWidth:new u.nt(.105*A.au).divide(s).divide(this.view.pixelRatio),outlineDistanceOffset:w},this.maybeRunHittest(t,e,{vvSizeAdjustment:f,vvRotation:y,labelOffset:v,labelClipped:_}))}_getViewRotationMatrix(t){const e=this.view.displayViewMat3,i=this.view.displayMat3,o=new u.nt(1).subtract(t);return e.multiply(t).add(i.multiply(o))}fragment(t){const e=new u.nt(2/8),i=new u.nt(1).subtract(e),o=(0,u.US)(this.mosaicInfo.texture,t.textureUV).a;let s=i.subtract(t.outlineDistanceOffset);this.highlight&&(s=s.divide(2));const r=t.antialiasingWidth,n=(0,u.TF)(s.subtract(r),s.add(r),o);return this.getFragmentOutput(t.color.multiply(n),t)}hittest(t,e,i){let o,s,r,{vvSizeAdjustment:n,vvRotation:a,labelOffset:l,labelClipped:c}=i;this.isLabel?(o=new u.eB(t.offset.add(l),0),s=new u.eB(e.offsetNextVertex1.add(l),0),r=new u.eB(e.offsetNextVertex2.add(l),0)):(o=a.multiply(new u.eB(t.offset.multiply(n),0)),s=a.multiply(new u.eB(e.offsetNextVertex1.multiply(n),0)),r=a.multiply(new u.eB(e.offsetNextVertex2.multiply(n),0)));const{viewMat3:p,tileMat3:d}=this.view,h=p.multiply(d).multiply(new u.eB(t.pos,1)),m=h.add(d.multiply(o)).xy,f=h.add(d.multiply(s)).xy,y=h.add(d.multiply(r)).xy,v=K(this.hittestRequest.position,m.xy,f.xy,y.xy);return this.isLabel?(0,u.Tk)(c,Q(this.hittestRequest),v):v}_unpackDirection(t){const e=new u.Ai(t),i=(0,u.Sj)(e,new u.Ai(2)),o=(0,u.nf)(e,new u.Ai(3));return new u.ZY(new u.nt(i).subtract(1),new u.nt(o).subtract(1))}_getVertexColor(t){let e=t.color;if(this.visualVariableColor){const i=this.storage.getColorValue(t.id);e=this.visualVariableColor.getColor(i,t.color,new u.x(!1))}if(this.visualVariableOpacity){const i=this.storage.getOpacityValue(t.id),o=this.visualVariableOpacity.getOpacity(i);e=e.multiply(o)}return e}}(0,n._)([(0,l.uK)(V)],Pe.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],Pe.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,l.uK)(T)],Pe.prototype,"visualVariableRotation",void 0),(0,n._)([(0,l.uK)(C)],Pe.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,l.uK)(M)],Pe.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,l.uK)(O)],Pe.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,l.uK)(R)],Pe.prototype,"visualVariableSizeUnitValue",void 0),(0,n._)([(0,l.Pi)(z)],Pe.prototype,"mosaicInfo",void 0),(0,n._)([l.E8],Pe.prototype,"textRenderPassType",void 0),(0,n._)([l.E8],Pe.prototype,"isBackgroundPass",void 0),(0,n._)([l.E8],Pe.prototype,"isLabel",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(ze)),(0,n.a)(1,(0,l.hF)(Ve))],Pe.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],Pe.prototype,"fragment",null);var Te=i(89657);class Ce extends Rt{}(0,n._)([(0,l.C5)(9,u.nt)],Ce.prototype,"accumulatedDistance",void 0),(0,n._)([(0,l.C5)(10,u.nt)],Ce.prototype,"totalLength",void 0),(0,n._)([(0,l.C5)(11,u.nt)],Ce.prototype,"gradientSize",void 0),(0,n._)([(0,l.C5)(12,u.ZY)],Ce.prototype,"segmentDirection",void 0),(0,n._)([(0,l.C5)(13,u.Zb)],Ce.prototype,"tlbr",void 0);class Me extends l.k2{}(0,n._)([(0,l.Pi)(u.nt)],Me.prototype,"isColorPass",void 0);class Oe extends Lt{constructor(){super(...arguments),this.type="GradientStrokeShader"}vertex(t,e){const{totalLength:i,gradientSize:o,segmentDirection:s,tlbr:n}=t,a=Et(this,t),l=(0,m.mh)(t.bitset,Te.Q.isAlongLine),c=i.divide(this.view.displayZoomFactor),p=(0,u.Tk)((0,m.K5)(t.bitset,Te.Q.isAbsoluteSize),(()=>{const t=(0,u.Tk)((0,u.MM)(l,new u.nt(.5)),c,a.halfWidth);return o.divide(t)}),o),d=t.accumulatedDistance.divide(this.view.displayZoomFactor).add((0,u.Om)(s,a.scaledOffset)).divide(c),h=n.divide(this.mosaicInfo.size.xyxy);return(0,r.A)((0,r.A)({},a),{},{tlbr:h,relativePositionAlongLine:d,relativeGradientSize:p,isAlongLine:(0,m.mh)(t.bitset,Te.Q.isAlongLine),isDiscrete:(0,m.mh)(t.bitset,Te.Q.isDiscrete)},this.maybeRunHittest(t,e,a.halfWidth))}fragment(t){const{isAlongLine:e,isDiscrete:i,relativePositionAlongLine:o,relativeGradientSize:s,normal:r,tlbr:n}=t,a=kt(t,this.antialiasingControls.blur),l=new u.nt(.5).multiply(r.y).add(new u.nt(.5)),c=(0,u.Tk)((0,u.MM)(e,new u.nt(.5)),o,l),p=(0,u.Tk)((0,u.MM)(i,new u.nt(.5)),s.subtract(1),new u.nt(0)),d=(0,m.zb)(c.add(p).divide(s)),f=(0,u.jh)(n.xy,n.zw,new u.ZY((0,u.qE)(d,new u.nt(0),new u.nt(1)),.5)),y=(0,u.US)(this.mosaicInfo.texture,f),v=t.opacity.multiply(a),g=this.getFragmentOutput(y.multiply(v),t),b=(0,u.PM)(new u.nt(.5),this.technique.isColorPass).multiply((0,h.A)("gradient-depth-epsilon")),x=(0,u.PM)(new u.nt(0),r.y).multiply(new u.nt((0,h.A)("gradient-depth-bias")).subtract(b));return g.glFragDepth=(0,u.qE)((0,u.Bw)(r).add(x),new u.nt(0),new u.nt(1)),g}}(0,n._)([(0,l.Pi)(z)],Oe.prototype,"mosaicInfo",void 0),(0,n._)([(0,l.Pi)(Me)],Oe.prototype,"technique",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(Ce)),(0,n.a)(1,(0,l.hF)(x))],Oe.prototype,"vertex",null);var Re=i(76931),Fe=i(77555);class De extends Rt{}(0,n._)([(0,l.C5)(9,u.nt)],De.prototype,"accumulatedDistance",void 0),(0,n._)([(0,l.C5)(10,u.ZY)],De.prototype,"segmentDirection",void 0),(0,n._)([(0,l.C5)(11,u.nt)],De.prototype,"offsetAlongLine",void 0),(0,n._)([(0,l.C5)(12,u.nt)],De.prototype,"capType",void 0),(0,n._)([(0,l.C5)(13,u.Zb)],De.prototype,"tlbr",void 0);class Ie extends Lt{constructor(){super(...arguments),this.type="TexturedLineShader"}_getDistanceRatio(t,e){const i=(0,m.mh)(t.bitset,A.kx);return i.multiply((0,u.T9)(e,new u.nt(.25)).multiply(new u.nt(2))).add(new u.nt(1).subtract(i).multiply((0,Re.Lz)(1)))}_getSDFAlpha(t){const{halfWidth:e,normal:i,tlbr:o,patternSize:s,accumulatedDistance:r,offsetAlongLine:n,dashToPx:a,capType:l}=t,c=s.x.divide(Fe.zA).multiply(a),p=(0,u.jc)(r.add(n).divide(c)),d=(0,u.jh)(o.xy,o.zw,new u.ZY(p,.5)),h=(0,m.Rj)((0,u.US)(this.mosaicInfo.texture,d)).multiply(2).subtract(1).multiply(Fe.gR).multiply(a),f=i.y.multiply(e),y=(0,u.j1)([(0,u.LC)(l,new u.nt(1)),h.subtract(e)],[(0,u.LC)(l,new u.nt(2)),(0,u.RZ)((0,u.n7)((0,u.T9)(h,new u.nt(0)),new u.nt(2)).add(f.multiply(f))).subtract(e)],[!0,h]),v=(0,u.qE)(new u.nt(.25).subtract(y),new u.nt(0),new u.nt(1));return new u.Zb(v)}_getPatternColor(t){const{halfWidth:e,normal:i,color:o,accumulatedDistance:s,patternSize:r,sampleAlphaOnly:n,tlbr:a}=t,l=r.y.multiply(new u.nt(2).multiply(e).divide(r.x)),c=(0,u.jc)(s.divide(l)),p=new u.nt(.5).multiply(i.y).add(new u.nt(.5)),d=(0,u.jh)(a.xy,a.zw,new u.ZY(p,c));let h=(0,u.US)(this.mosaicInfo.texture,d);return null!=this.visualVariableColor&&(h=(0,u.Tk)((0,u.MM)(n,new u.nt(.5)),new u.Zb(o.a),o)),h}vertex(t,e){const{segmentDirection:i,tlbr:o,bitset:s}=t,n=Et(this,t),a=t.accumulatedDistance.divide(this.view.displayZoomFactor).add((0,u.Om)(i,n.scaledOffset)),l=new u.ZY(o.z.subtract(o.x),o.w.subtract(o.y)),c=o.divide(this.mosaicInfo.size.xyxy),p=(0,m.mh)(s,A.b5),d=(0,m.mh)(s,A.cn),h=(0,u.Tk)((0,u.MM)(p,new u.nt(.5)),this._getDistanceRatio(t,n.scaledHalfWidth),new u.nt(1));return(0,r.A)((0,r.A)({},n),{},{tlbr:c,patternSize:l,accumulatedDistance:a,isSDF:p,sampleAlphaOnly:d,dashToPx:h,offsetAlongLine:t.offsetAlongLine,capType:t.capType},this.maybeRunHittest(t,e,n.halfWidth))}fragment(t){const{color:e,opacity:i,isSDF:o}=t,s=kt(t,this.antialiasingControls.blur),r=(0,u.Tk)((0,u.MM)(o,new u.nt(.5)),this._getSDFAlpha(t),this._getPatternColor(t)),n=e.multiply(i).multiply(s).multiply(r);return this.getFragmentOutput(n,t)}}(0,n._)([(0,l.Pi)(z)],Ie.prototype,"mosaicInfo",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(De)),(0,n.a)(1,(0,l.hF)(x))],Ie.prototype,"vertex",null);class ke extends b{}(0,n._)([(0,l.C5)(3,u.Zb)],ke.prototype,"color",void 0),(0,n._)([(0,l.C5)(4,u.Zb)],ke.prototype,"outlineColor",void 0),(0,n._)([(0,l.C5)(5,u.ZY)],ke.prototype,"offset",void 0),(0,n._)([(0,l.C5)(6,u.ZY)],ke.prototype,"textureUV",void 0),(0,n._)([(0,l.C5)(7,u.Zb)],ke.prototype,"sizing",void 0),(0,n._)([(0,l.C5)(8,u.nt)],ke.prototype,"placementAngle",void 0),(0,n._)([(0,l.C5)(9,u.nt)],ke.prototype,"sdfDecodeCoeff",void 0),(0,n._)([(0,l.C5)(10,u.ZY)],ke.prototype,"zoomRange",void 0);class Ee extends l.Y7{}(0,n._)([(0,l.C5)(12,u.ZY)],Ee.prototype,"offsetNextVertex1",void 0),(0,n._)([(0,l.C5)(13,u.ZY)],Ee.prototype,"offsetNextVertex2",void 0),(0,n._)([(0,l.C5)(14,u.ZY)],Ee.prototype,"textureUVNextVertex1",void 0),(0,n._)([(0,l.C5)(15,u.ZY)],Ee.prototype,"textureUVNextVertex2",void 0);function Ze(t,e,i,o){return e.multiply(t.x).add(i.multiply(t.y)).add(o.multiply(t.z))}function Le(t){return t.multiply(t).divide(128)}class Be extends _{constructor(){super(...arguments),this.type="MarkerShader",this.computeAttributes={offset:["offsetNextVertex1","offsetNextVertex2"],textureUV:["textureUVNextVertex1","textureUVNextVertex2"]}}vertex(t,e){const i=Le(t.sizing.x),o=Le(t.sizing.y),s=Le(t.sizing.z),n=t.placementAngle,a=(0,m.mh)(t.bitset,N.c.bitset.isSDF),l=(0,m.mh)(t.bitset,N.c.bitset.isMapAligned),c=(0,m.mh)(t.bitset,N.c.bitset.scaleSymbolsProportionally),p=(0,m.K5)(t.bitset,N.c.bitset.colorLocked),d=k(this,t.id),h=I(this,t.id,t.color,p).multiply(d),f=this.view.displayViewScreenMat3.multiply(new u.eB(t.pos.xy,1)),y=D(this,t.id,s).divide(s),v=i.multiply(y),g=t.offset.xy.multiply(y);let b=o.multiply(c.multiply(y.subtract(1)).add(1));b=(0,u.jk)(b,(0,u.T9)(v.subtract(.99),new u.nt(0)));const x=(0,u.T9)(b,new u.nt(1)),w=(0,u.jk)(b,new u.nt(1)),_=u.U.fromRotation(n.multiply(A.rp)),S=E(this,t.id),z=this._getViewRotationMatrix(l).multiply(S).multiply(_).multiply(new u.eB(g.xy,0)),V=this.clip(t.id,t.zoomRange),P=new u.Zb(f.xy.add(z.xy),V,1),T=t.textureUV.divide(this.mosaicInfo.size),C=t.outlineColor.multiply(w),M=(0,m.mh)(t.bitset,N.c.bitset.overrideOutlineColor),O=t.sdfDecodeCoeff.multiply(v);return(0,r.A)({glPosition:P,color:h,textureUV:T,outlineColor:C,outlineSize:x,distanceToPx:O,isSDF:a,overrideOutlineColor:M},this.maybeRunHittest(t,e,{pos:t.pos,size:v,sizeCorrection:y,isMapAligned:l,vvRotationMat3:S,placementMat3:_,outlineSize:x,distanceToPx:O,isSDF:a}))}fragment(t){const e=this._getColor(t.textureUV,t);return this.getFragmentOutput(e,t)}hittest(t,e,i){return(0,u.Tk)((0,u.Xe)(i.size,this.hittestRequest.smallSymbolSizeThreshold),this._hittestSmallMarker(t,e,i),this._hittestMarker(t,e,i))}_getViewRotationMatrix(t){const e=this.view.displayViewMat3,i=this.view.displayMat3,o=new u.nt(1).subtract(t);return e.multiply(t).add(i.multiply(o))}_getViewScreenMatrix(t){const e=this.view.viewMat3.multiply(this.view.tileMat3),i=this.view.tileMat3,o=new u.nt(1).subtract(t);return e.multiply(t).add(i.multiply(o))}_getColor(t,e){return(0,u.Tk)((0,u.LC)(e.isSDF,new u.nt(1)),this._getSDFColor(t,e),this._getSpriteColor(t,e))}_getSpriteColor(t,e){return(0,u.US)(this.mosaicInfo.texture,t).multiply(e.color)}_getSDFColor(t,e){const i=(0,u.US)(this.mosaicInfo.texture,t),o=new u.nt(.5).subtract((0,m.Rj)(i)).multiply(e.distanceToPx).multiply(A.V5),s=(0,u.qE)(new u.nt(.5).subtract(o),new u.nt(0),new u.nt(1)),r=e.color.multiply(s);let n=e.outlineSize;this.highlight&&(n=(0,u.T9)(n,e.overrideOutlineColor.multiply(4)));const a=n.multiply(.5),l=(0,u.tn)(o).subtract(a),c=(0,u.qE)(new u.nt(.5).subtract(l),new u.nt(0),new u.nt(1)),p=(0,u.jh)(e.outlineColor,e.color,e.overrideOutlineColor).multiply(c);return new u.nt(1).subtract(p.a).multiply(r).add(p)}_hittestSmallMarker(t,e,i){const{position:o,distance:s,smallSymbolDistance:r}=this.hittestRequest,n=s.subtract(r),{viewMat3:a,tileMat3:l}=this.view,c=a.multiply(l).multiply(new u.eB(i.pos,1)).xy,p=i.size.multiply(.5);return(0,u.Io)(c,o).subtract(p).add(n)}_hittestMarker(t,e,i){const{pos:o,sizeCorrection:s,isMapAligned:r}=i,n=new u.eB(t.offset.multiply(s),0),a=new u.eB(e.offsetNextVertex1.multiply(s),0),l=new u.eB(e.offsetNextVertex2.multiply(s),0),{viewMat3:c,tileMat3:p}=this.view,d=c.multiply(p).multiply(new u.eB(o,1)),h=this._getViewScreenMatrix(r).multiply(i.vvRotationMat3).multiply(i.placementMat3),m=d.add(h.multiply(n)).xy,f=d.add(h.multiply(a)).xy,y=d.add(h.multiply(l)).xy,v=this.hittestRequest.position,g=this.hittestRequest.distance,b=K(v,m,f,y);return(0,u.Tk)((0,u.MM)(b,g),b,this._hittestSamples(m,f,y,t,e,i))}_hittestSamples(t,e,i,o,s,r){const{outlineSize:n,isSDF:a,distanceToPx:l}=r,c=this.hittestRequest.position,p=this.hittestRequest.distance,d=H(c.add(new u.ZY((0,u.ze)(p),(0,u.ze)(p))),t,e,i),h=H(c.add(new u.ZY(0,(0,u.ze)(p))),t,e,i),m=H(c.add(new u.ZY(p,(0,u.ze)(p))),t,e,i),f=H(c.add(new u.ZY((0,u.ze)(p),0)),t,e,i),y=H(c,t,e,i),v=H(c.add(new u.ZY(p,0)),t,e,i),g=H(c.add(new u.ZY((0,u.ze)(p),p)),t,e,i),b=H(c.add(new u.ZY(0,p)),t,e,i),x=H(c.add(new u.ZY(p,p)),t,e,i),w=o.textureUV.divide(this.mosaicInfo.size),_=s.textureUVNextVertex1.divide(this.mosaicInfo.size),S=s.textureUVNextVertex2.divide(this.mosaicInfo.size),A={color:new u.Zb(1),outlineColor:new u.Zb(1),overrideOutlineColor:new u.nt(1),outlineSize:n,distanceToPx:l,isSDF:a};let z=new u.nt(0);return z=z.add(q(d).multiply(this._getColor(Ze(d,w,_,S),A).a)),z=z.add(q(h).multiply(this._getColor(Ze(h,w,_,S),A).a)),z=z.add(q(m).multiply(this._getColor(Ze(m,w,_,S),A).a)),z=z.add(q(f).multiply(this._getColor(Ze(f,w,_,S),A).a)),z=z.add(q(y).multiply(this._getColor(Ze(y,w,_,S),A).a)),z=z.add(q(v).multiply(this._getColor(Ze(v,w,_,S),A).a)),z=z.add(q(g).multiply(this._getColor(Ze(g,w,_,S),A).a)),z=z.add(q(b).multiply(this._getColor(Ze(b,w,_,S),A).a)),z=z.add(q(x).multiply(this._getColor(Ze(x,w,_,S),A).a)),(0,u.PM)(z,new u.nt(.05)).multiply(Q(this.hittestRequest))}}(0,n._)([(0,l.uK)(V)],Be.prototype,"visualVariableColor",void 0),(0,n._)([(0,l.uK)(P)],Be.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,l.uK)(T)],Be.prototype,"visualVariableRotation",void 0),(0,n._)([(0,l.uK)(C)],Be.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,l.uK)(M)],Be.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,l.uK)(O)],Be.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,l.uK)(R)],Be.prototype,"visualVariableSizeUnitValue",void 0),(0,n._)([(0,l.Pi)(z)],Be.prototype,"mosaicInfo",void 0),(0,n._)([(0,n.a)(0,(0,l.hF)(ke)),(0,n.a)(1,(0,l.hF)(Ee))],Be.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,l.hF)(class extends w{}))],Be.prototype,"fragment",null);var Ue=i(88685),Ne=i(78492);class Ye{constructor(){this.computeAttributes={}}get locationsMap(){const t=new Map;for(const e in this.locations)t.set(e,this.locations[e].index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set(Object.keys(this.options));this._optionPropertyKeys=t}return this._optionPropertyKeys}get _transformFeedbackBindings(){return[]}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map((t=>{let[e,i]=t;return"".concat(e,".").concat(i)})).join("."),i=(0,Ue.Wm)(e);this._locationInfo={hash:i,stringHash:e,locations:t,computeAttributeMap:this.computeAttributes}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const[e,i]of this.locationsMap.entries())t.set("a_"+e,i);return t}getShaderKey(t,e,i){return"".concat(Object.keys(t).map((e=>"".concat(e,".").concat(t[e]))).join("."),".").concat(Object.keys(i).filter((t=>i[t])).map((t=>"".concat(t,"_").concat(i[t].toString()))).join("."),".").concat(Object.keys(e).filter((t=>this.optionPropertyKeys.has(t))).join("."))}getProgram(t,e,i,o){let s="",r="";for(const n in i)if(i[n]){const t="boolean"==typeof i[n]?"#define ".concat(n,"\n"):"#define ".concat(n," ").concat(i[n],"\n");s+=t,r+=t}return s+=this.vertexShader,r+=this.fragmentShader,new Ne.K(s,r,this.renamedLocationsMap,this.locationInfo,this._getUniformBindings(e),this._transformFeedbackBindings)}_getUniformBindings(t){const e=[];for(const i in this.required){const t=this.required[i];e.push({uniformHydrated:null,shaderModulePath:i,uniformName:i,uniformType:t.type,uniformArrayElementType:qe(t),uniformArrayLength:He(t)})}for(const i in t){const o=this.options[i];if(t[i])for(const t in o){const s=o[t];e.push({uniformHydrated:null,shaderModulePath:"".concat(i,".").concat(t),uniformName:t,uniformType:s.type,uniformArrayElementType:qe(s),uniformArrayLength:He(s)})}}return e}}const qe=t=>{var e;return"array"===t.type?null===(e=t.elementType)||void 0===e?void 0:e.type:void 0},He=t=>"array"===t.type?t.size:void 0;var je=i(35206);const Ke={hittestDist:u.nt,hittestPos:u.ZY},Qe={filterFlags:u.z7,animation:u.z7,visualVariableData:u.z7,dataDriven0:u.z7,dataDriven1:u.z7,dataDriven2:u.z7,gpgpu:u.z7,size:u.nt},Ge={displayViewScreenMat3:u.U,displayViewMat3:u.U,displayMat3:u.U,viewMat3:u.U,tileMat3:u.U,displayZoomFactor:u.nt,requiredZoomFactor:u.nt,tileOffset:u.ZY,currentScale:u.nt,currentZoom:u.nt,metersPerSRUnit:u.nt};class We extends Ye{constructor(){super(...arguments),this.vertexShader=(0,je.Q)("materials/pie/pie.vert"),this.fragmentShader=(0,je.Q)("materials/pie/pie.frag"),this.required=(0,r.A)((0,r.A)((0,r.A)({},Qe),Ge),{},{outlineWidth:u.nt,colors:u.My,defaultColor:u.Zb,othersColor:u.Zb,outlineColor:u.Zb,donutRatio:u.nt,sectorThreshold:u.nt}),this.options={hittestUniforms:Ke,visualVariableSizeMinMaxValue:{minMaxValueAndSize:u.Zb},visualVariableSizeScaleStops:{sizes:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8}),values:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8})},visualVariableSizeStops:{sizes:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8}),values:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8})},visualVariableSizeUnitValue:{unitValueToPixelsRatio:u.nt},visualVariableOpacity:{opacities:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8}),opacityValues:(0,r.A)((0,r.A)({},u.My.ofType(u.nt,8)),{},{type:"array",elementType:u.nt,size:8})}},this.locations={pos:{index:0,type:u.ZY},id:{index:1,type:u.eB},bitset:{index:2,type:u.nt},offset:{index:3,type:u.ZY},texCoords:{index:4,type:u.ZY},size:{index:5,type:u.ZY},referenceSize:{index:6,type:u.nt},zoomRange:{index:7,type:u.ZY}},this.defines={VV_SIZE_MIN_MAX_VALUE:"boolean",VV_SIZE_SCALE_STOPS:"boolean",VV_SIZE_FIELD_STOPS:"boolean",VV_SIZE_UNIT_VALUE:"boolean",VV_OPACITY:"boolean",HITTEST:"boolean",numberOfFields:"number",highlight:"boolean",inside:"boolean",outside:"boolean"}}setNumberOfFields(t){this.required.colors=(0,r.A)((0,r.A)({},u.My.ofType(u.Zb,t)),{},{type:"array",elementType:u.Zb,size:t})}}const Xe={fill:new class extends ot{constructor(){super(...arguments),this.type=s.N.Fill,this.shaders={geometry:new zt}}render(t,e){const{painter:i}=t,o=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,o.uniforms)),(0,st.QA)(t,e.target)),defines:(0,st.vT)(t),optionalAttributes:o.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),i.setPipelineState((0,st.Qu)(t)),i.submitDraw(t,e)}},patternFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.PatternFill,this.shaders={geometry:new Qt}}render(t,e){const{context:i,painter:o}=t,s=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey),localTileOffset:(0,st.Pr)(e.target)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},complexFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.ComplexFill,this.shaders={geometry:new Mt}}render(t,e){const{context:i,painter:o}=t,s=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey),localTileOffset:(0,st.Pr)(e.target)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},gradientFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.GradientFill,this.shaders={geometry:new oe},this.symbologyPlane=o.uC.FILL}render(t,e){const{context:i,painter:o}=t,s=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},outlineFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.OutlineFill,this.shaders={geometry:new qt}}render(t,e){const{painter:i,pixelRatio:o}=t,s=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(o)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),i.setPipelineState((0,st.Qu)(t)),i.submitDraw(t,e)}},patternOutlineFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.PatternOutlineFill,this.shaders={geometry:new Xt}}render(t,e){const{context:i,painter:o,pixelRatio:s}=t,n=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,n.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(s),mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey),localTileOffset:(0,st.Pr)(e.target)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},complexOutlineFill:new class extends ot{constructor(){super(...arguments),this.type=s.N.ComplexOutlineFill,this.shaders={geometry:new te}}render(t,e){const{context:i,painter:o,pixelRatio:s}=t,n=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,n.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(s),mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey),localTileOffset:(0,st.Pr)(e.target)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},marker:new class extends ot{constructor(){super(...arguments),this.type=s.N.Marker,this.shaders={geometry:new Be},this.symbologyPlane=o.uC.MARKER}render(t,e){const{context:i,painter:o}=t,s=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey,!0)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},pieChart:new class extends ot{constructor(){super(...arguments),this.type=s.N.PieChart,this.shaders={geometry:new We},this.symbologyPlane=o.uC.MARKER}render(t,e){var i,o;const{painter:s}=t,{instance:n,target:a}=e,l=this.shaders.geometry,u=n.getInput(),c=u.uniforms.numberOfFields,p=(0,st.Eq)(t),d=(0,st.QA)(t,a),h=(0,st.vT)(t);l.setNumberOfFields(c),s.setShader({shader:l,uniforms:(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,u.uniforms.shader)),d.storage),d.view),{},{hittestUniforms:d.hittestRequest?{hittestDist:null===(i=d.hittestRequest)||void 0===i?void 0:i.distance,hittestPos:null===(o=d.hittestRequest)||void 0===o?void 0:o.position}:null}),defines:(0,r.A)((0,r.A)({VV_SIZE_MIN_MAX_VALUE:!!u.uniforms.shader.visualVariableSizeMinMaxValue,VV_SIZE_SCALE_STOPS:!!u.uniforms.shader.visualVariableSizeScaleStops,VV_SIZE_FIELD_STOPS:!!u.uniforms.shader.visualVariableSizeStops,VV_SIZE_UNIT_VALUE:!!u.uniforms.shader.visualVariableSizeUnitValue,VV_OPACITY:!!u.uniforms.shader.visualVariableOpacity,HITTEST:p,highlight:d.highlight?1:0},h),{},{numberOfFields:c}),optionalAttributes:{},useComputeBuffer:p}),s.setPipelineState((0,st.Qu)(t)),s.submitDraw(t,e)}},line:new class extends ot{constructor(){super(...arguments),this.type=s.N.Line,this.shaders={geometry:new Lt},this.symbologyPlane=o.uC.LINE}render(t,e){const{painter:i,pixelRatio:o}=t,s=e.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,s.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(o)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:s.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),i.setPipelineState((0,st.Qu)(t)),i.submitDraw(t,e)}},texturedLine:new class extends ot{constructor(){super(...arguments),this.type=s.N.TexturedLine,this.shaders={geometry:new Ie},this.symbologyPlane=o.uC.LINE}render(t,e){const{context:i,painter:o,pixelRatio:s}=t,n=e.instance.getInput();o.setShader({shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,n.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(s),mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey)}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e)}},gradientStroke:new class extends ot{constructor(){super(...arguments),this.type=s.N.GradientStroke,this.shaders={geometry:new Oe},this.symbologyPlane=o.uC.LINE}_getShaderOptions(t,e,i){const{context:o,painter:s,pixelRatio:n}=t,a=e.instance.getInput();return{shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,a.uniforms)),(0,st.QA)(t,e.target)),{},{antialiasingControls:Ot(n),mosaicInfo:s.textureManager.getMosaicInfo(o,e.textureKey),technique:{isColorPass:i}}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:a.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)}}render(t,e){const{painter:i}=t;if((0,st.Eq)(t)||(0,st.dJ)(t)){const o=(0,st.Qu)(t);return i.setPipelineState(o),i.setShader(this._getShaderOptions(t,e,1)),void i.submitDraw(t,e)}t.context.setClearDepth(1),t.context.clear(yt.NV.DEPTH);const o={color:!1,depth:{write:{zNear:0,zFar:1},test:yt.MT.LESS},stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:yt.MT.EQUAL,mask:255,op:{fail:yt.eA.KEEP,zFail:yt.eA.KEEP,zPass:yt.eA.KEEP}}}};i.setShader(this._getShaderOptions(t,e,0)),i.setPipelineState(o),i.submitDraw(t,e);const s={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:{write:!1,test:yt.MT.LEQUAL},stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:yt.MT.EQUAL,mask:255,op:{fail:yt.eA.KEEP,zFail:yt.eA.KEEP,zPass:yt.eA.KEEP}}}};i.setShader(this._getShaderOptions(t,e,1)),i.setPipelineState(s),i.submitDraw(t,e)}},text:new class extends ot{constructor(){super(...arguments),this.type=s.N.Text,this.shaders={geometry:new Pe},this.symbologyPlane=o.uC.TEXT}render(t,e){const{context:i,painter:o}=t,s=(0,st.vT)(t),n=e.instance.getInput(),a={shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,n.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey)}),defines:(0,r.A)((0,r.A)({},s),{},{isBackgroundPass:!0,isLabel:!1,textRenderPassType:Ae.Color}),optionalAttributes:n.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)};o.setShader(a),o.setPipelineState((0,st.Qu)(t)),o.submitDraw(t,e),o.setShader((0,r.A)((0,r.A)({},a),{},{defines:(0,r.A)((0,r.A)({},s),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:Ae.Halo})})),o.submitDraw(t,e),o.setShader((0,r.A)((0,r.A)({},a),{},{defines:(0,r.A)((0,r.A)({},s),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:Ae.Outline})})),o.submitDraw(t,e),o.setShader((0,r.A)((0,r.A)({},a),{},{defines:(0,r.A)((0,r.A)({},s),{},{isBackgroundPass:!1,isLabel:!1,textRenderPassType:Ae.Color})})),o.submitDraw(t,e)}},label:new class extends ot{constructor(){super(...arguments),this.type=s.N.Label,this.shaders={geometry:new Pe},this.drawPhase=o.S5.LABEL|o.S5.LABEL_ALPHA|o.S5.HITTEST,this.symbologyPlane=o.uC.TEXT}render(t,e){const{context:i,painter:o}=t,s=(0,st.vT)(t),n=(0,r.A)({},(0,st.Qu)(t)),a=e.instance.getInput(),l={shader:this.shaders.geometry,uniforms:(0,r.A)((0,r.A)((0,r.A)({},(0,st.r3)(t,e.target,a.uniforms)),(0,st.QA)(t,e.target)),{},{mosaicInfo:o.textureManager.getMosaicInfo(i,e.textureKey)}),defines:(0,r.A)((0,r.A)({},s),{},{textRenderPassType:Ae.Color,isBackgroundPass:!0,isLabel:!0}),optionalAttributes:a.optionalAttributes,useComputeBuffer:(0,st.Eq)(t)};o.setPipelineState(n),o.setShader(l),o.submitDraw(t,e),o.setShader((0,r.A)((0,r.A)({},l),{},{defines:(0,r.A)((0,r.A)({},s),{},{textRenderPassType:Ae.Halo,isBackgroundPass:!1,isLabel:!0})})),o.submitDraw(t,e),o.setShader((0,r.A)((0,r.A)({},l),{},{defines:(0,r.A)((0,r.A)({},s),{},{textRenderPassType:Ae.Color,isBackgroundPass:!1,isLabel:!0})})),o.submitDraw(t,e)}},heatmap:new class extends ot{constructor(){super(...arguments),this.type=s.N.Heatmap,this.drawPhase=o.S5.MAP|o.S5.HITTEST|o.S5.DEBUG,this.shaders={accumulate:new de,resolve:new ve},this._isBound=!1,this._resources=new Map}shutdown(t){var e;super.shutdown(t),null!==(e=this._resources.get(t))&&void 0!==e&&e.destroy(),this._resources.delete(t),this._prevFBO=null,this._unbind()}render(t,e){const{context:i,painter:o,state:s}=t,n=e.instance.getInput(),{isFieldActive:a}=n.uniforms,l=this._getOrCreateResourcesRecord(i),u=l.loadQualityProfile(i);(0,st.Eq)(t)||this._bind(t,l,n),o.setShader({shader:this.shaders.accumulate,uniforms:(0,r.A)((0,r.A)({},(0,st.QA)(t,e.target)),{},{kernelControls:{radius:_e(n,s),isFieldActive:a?1:0}}),defines:(0,r.A)((0,r.A)({},(0,st.vT)(t)),u.defines),optionalAttributes:{},useComputeBuffer:(0,st.Eq)(t)});const c=(0,st.Eq)(t)?xe:be;o.setPipelineState(c),o.submitDraw(t,e)}getStencilReference(t){return ge(t)}renderResolvePass(t,e){if((0,st.Eq)(t))return;const{context:i,painter:o}=t,s=this._resources.get(i);if(null==this._prevFBO||null==this._prevViewport||null===s||void 0===s||!s.initialized)return;const{defines:r}=s.loadQualityProfile(i),{minDensity:n,maxDensity:a,radius:l}=e.getInput().uniforms,u=s.accumulateFramebuffer,c=s.resolveGradientTexture,p={shader:this.shaders.resolve,uniforms:{accumulatedDensity:{texture:{unit:8,texture:u.colorTexture},minAndInvRange:[n,1/(a-n)],normalization:3/(l*l*Math.PI)},gradient:{texture:{unit:9,texture:c}}},defines:r,optionalAttributes:{},useComputeBuffer:!1};i.bindFramebuffer(this._prevFBO),i.setViewport(0,0,this._prevViewport.width,this._prevViewport.height),i.bindTexture(u.colorTexture,8),i.bindTexture(c,9),o.setPipelineState(we),o.submitDrawMesh(i,p,o.quadMesh),this._unbind()}_getOrCreateResourcesRecord(t){let e=this._resources.get(t);return null==e&&(e=new le,this._resources.set(t,e)),e}_unbind(){this._prevFBO=null,this._prevViewport=null,this._isBound=!1}_bind(t,e,i){if(this._isBound)return;const{context:o,state:s,pixelRatio:r}=t,n=o.getBoundFramebufferObject(),a=o.getViewport();this._prevFBO=n,this._prevViewport=a;const{gradient:l,gradientHash:u}=i.uniforms;e.ensureResolveGradientTexture(o,u,l);const{width:c,height:p}=a,d=function(t,e){const i=e>1.5?.25:.5;return t<1/(2*i)?1:i}(_e(i,s),r),h=c*d,m=p*d,f=e.ensureAccumulateFBO(o,h,m);o.blitFramebuffer(n,f,0,0,n.width,n.height,0,0,f.width,f.height,yt.NV.STENCIL,yt.Cj.NEAREST),o.bindFramebuffer(f),o.setViewport(0,0,f.width,f.height),o.setColorMask(!0,!0,!0,!0),o.setClearColor(0,0,0,0),o.clear(yt.NV.COLOR),this._isBound=!0}},dotDensity:new class extends ot{constructor(){super(...arguments),this.type=s.N.DotDensity,this.shaders={polygon:new ht,point:new ut,fill:new zt},this._resources=new Map}render(t,e){(0,st.dJ)(t)||(0,st.Eq)(t)?this._renderPolygons(t,e):this._renderDotDensity(t,e)}_renderPolygons(t,e){const{painter:i}=t;i.setShader({shader:this.shaders.fill,uniforms:(0,r.A)((0,r.A)({},(0,st.QA)(t,e.target)),{},{visualVariableColor:null,visualVariableOpacity:null}),defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:{zoomRange:!1},useComputeBuffer:(0,st.Eq)(t)}),i.setPipelineState((0,st.Qu)(t)),i.submitDraw(t,e)}_renderDotDensity(t,e){const{context:i,painter:o,requiredLevel:s}=t,n=e.instance.getInput().uniforms,a=this._getOrCreateResourcesRecord(i),l=a.getDotDensityTextures(i,d.CQ,n.seed),u=1/2**(s-e.target.key.level),c=d.CQ,p=c*window.devicePixelRatio*c*window.devicePixelRatio,h=1/u*(1/u),m=n.dotScale?t.state.scale/n.dotScale:1,f=n.dotValue*m*h;o.setShader({shader:this.shaders.polygon,uniforms:(0,r.A)((0,r.A)({},(0,st.QA)(t,e.target)),{},{instance:{isActive:n.isActive,colors:n.colors,dotValue:Math.max(1,f)},draw:{dotTexture0:{unit:d.Cp,texture:l[0]},dotTexture1:{unit:d.vN,texture:l[1]},tileZoomFactor:u,pixelRatio:window.devicePixelRatio,tileDotsOverArea:p/(d.CQ*window.devicePixelRatio*d.CQ*window.devicePixelRatio)}}),defines:(0,r.A)((0,r.A)({},(0,st.vT)(t)),{},{blending:n.blending}),optionalAttributes:{},useComputeBuffer:!1});const y=i.getViewport();i.setViewport(0,0,d.CQ,d.CQ);const v=i.getBoundFramebufferObject(),g=a.getFBO(i);i.bindFramebuffer(g),i.setClearColor(0,0,0,0),i.clear(yt.NV.COLOR),o.setPipelineState({color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:!1}),o.updatePipelineState(i),o.submitDraw(t,e),i.bindFramebuffer(v),i.setViewport(y.x,y.y,y.width,y.height);const b=a.getFBO(i).colorTexture,x={shader:this.shaders.point,uniforms:{view:(0,st.L4)(t,e.target),instance:{dotSize:n.dotSize},draw:{locations:{unit:d.Cp,texture:b},tileZoomFactor:1,pixelRatio:window.devicePixelRatio}},defines:(0,r.A)({},(0,st.vT)(t)),optionalAttributes:{},useComputeBuffer:!1};o.setPipelineState((0,st.Qu)(t)),o.submitDrawMesh(i,x,a.getDotDensityMesh(i))}shutdown(t){var e;super.shutdown(t),null!==(e=this._resources.get(t))&&void 0!==e&&e.destroy(),this._resources.delete(t)}_getOrCreateResourcesRecord(t){let e=this._resources.get(t);return null==e&&(e=new St,this._resources.set(t,e)),e}},animatedMarker:new class extends rt{constructor(){super(...arguments),this.type=s.N.AnimatedMarker,this.symbologyPlane=o.uC.MARKER,this.shaders={geometry:new J}}}};function $e(){for(const t in Xe)Xe[t].startup()}function Je(t){for(const e in Xe)Xe[e].shutdown(t)}},33817:(t,e,i)=>{i.d(e,{F:()=>p});var o=i(35143),s=i(91967),r=i(81806),n=i(67993),a=i(68134),l=i(46053),u=(i(76460),i(47249),i(85842)),c=i(19451);let p=class extends s.A{constructor(t){super(t),this.debugName="",this._updatingHandles=new c.U,this._idToUpdatingState=new n.A}get updating(){const t=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some((t=>t));if((0,r.A)("esri-2d-log-updating")){const e=Array.from(this._idToUpdatingState.entries()).map((t=>{let[e,i]=t;return"-> ".concat(e,": ").concat(i)})).join("\n");console.log("".concat(this.debugName,": Updating: ").concat(t,"\n-> Handles: ").concat(this._updatingHandles.updating,"\n").concat(e))}return t}addUpdateTracking(t,e){const i=(0,a.wB)((()=>e.updating),(e=>this._idToUpdatingState.set(t,e)),{sync:!0});this.addHandles(i)}addPromise(t){return this._updatingHandles.addPromise(t)}};(0,o._)([(0,l.MZ)({constructOnly:!0})],p.prototype,"debugName",void 0),(0,o._)([(0,l.MZ)({readOnly:!0})],p.prototype,"updating",null),p=(0,o._)([(0,u.$)("esri.views.2d.layers.support.UpdateTracking2D")],p)},34429:(t,e,i)=>{i.d(e,{QueueProcessor:()=>c});var o=i(30726),s=i(50346),r=i(59649),n=i(67993),a=i(52394),l=i(75540);class u{constructor(t,e){this.item=t,this.controller=e,this.promise=null}}class c{constructor(t){this._schedule=null,this._deferreds=new n.A,this._controllers=new n.A,this._processingItems=new n.A,this._pausedSignal=(0,l.v)(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new r.A(t.peeker),this.process=t.process}destroy(){this.clear(),this._schedule=(0,o.xt)(this._schedule)}get updating(){return this.running}get length(){return this._processingItems.size+this._queue.length}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}abort(t){const e=this._controllers.get(t);e&&e.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((e=>t.push(e))),this._controllers.clear(),t.forEach((t=>t.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((e,i)=>t(i)))}get(t){const e=this._deferreds.get(t);return e?e.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,e){const i=this.get(t);if(i)return i;const o=new AbortController;let r=null;e&&(r=(0,s.u7)(e,(()=>o.abort())));const n=()=>{a.remove(),null!=r&&r.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},a=(0,s.NY)(o.signal,(()=>{const e=this._processingItems.get(t);e&&e.controller.abort(),n(),l.reject((0,s.NK)())})),l=(0,s.Tw)();return this._deferreds.set(t,l),this._controllers.set(t,o),l.promise.then(n,n),this._queue.push(t),this._scheduleNext(),l.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){var t;const e=this._queue.popLast();return e&&(null!==(t=this._deferreds.get(e))&&void 0!==t&&t.reject((0,s.NK)()),this._removeItem(e)),e}reset(){const t=Array.from(this._processingItems.values());this._processingItems.clear();for(const e of t)this._queue.push(e.item),e.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._pausedSignal.value||this._schedule||(this._schedule=(0,a._)((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(e))}_processError(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(e))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(null==t)return;let e;const i=new AbortController,o=new u(t,i);this._processingItems.set(t,o);try{e=this.process(t,i.signal)}catch(r){this._processError(o,r)}(0,s.$X)(e)?(o.promise=e,e.then((t=>this._processResult(o,t)),(t=>this._processError(o,t)))):this._processResult(o,e)}}},43282:(t,e,i)=>{i.d(e,{c:()=>o});const o={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4,isStroke:5}}},60401:(t,e,i)=>{i.d(e,{j:()=>a});var o=i(50346),s=i(34429),r=i(33817);class n{constructor(){this.type="override-batch",this.messages=[],this._resovler=(0,o.Tw)()}get promise(){return this._resovler.promise}resolve(){this._resovler.resolve()}add(t){this.messages.push(t)}}class a{constructor(t){this.updateTracking=new r.F({debugName:"FeatureCommandQueue"}),this.process=t.process,this._queueProcessor=new s.QueueProcessor({concurrency:1,process:async t=>{if("override-batch"===t.type){const t=this._nextOverrideBatch;if(null==t)throw new Error("InternalError: Override should be defined");return this._nextOverrideBatch=null,await this.process(t),void t.resolve()}return this.process(t)}})}destroy(){this.updateTracking.destroy(),this._queueProcessor.destroy(),this.clear()}clear(){this._queueProcessor.clear()}async push(t){return(0,o.QZ)(this.updateTracking.addPromise(this._doPush(t)))}async _doPush(t){const e=this._queueProcessor,i=e.last();switch(t.type){case"update":case"highlight":if((null===i||void 0===i?void 0:i.type)===t.type)return;return e.push(t);case"override":case"edit":return this._pushOverride(t)}}_pushOverride(t){return null==this._nextOverrideBatch&&(this._nextOverrideBatch=new n,this._queueProcessor.push(this._nextOverrideBatch)),this._nextOverrideBatch.add(t),this._nextOverrideBatch.promise}}},60853:(t,e,i)=>{i.d(e,{K5:()=>p,Kt:()=>m,M8:()=>a,Rj:()=>f,_9:()=>n,i6:()=>d,mh:()=>c,nb:()=>u,p8:()=>g,tL:()=>l,xf:()=>y,yS:()=>h,zb:()=>v,zy:()=>b});var o=i(5095),s=i(60984),r=i(90113);function n(t){const e=(0,s.fV)(12.9898),i=(0,s.fV)(78.233),o=(0,s.fV)(43758.5453),r=(0,s.Om)(t,(0,s.Zc)(e,i)),n=(0,s.zi)(r,(0,s.fV)(3.14));return(0,s.jc)((0,s.F8)(n).multiply(o))}function a(t){return(0,s.LC)(t,(0,s.fV)(r.qM))}function l(t,e){return t.x.multiply(e.y).subtract(e.x.multiply(t.y))}function u(t){return t.multiply(2).subtract(1)}function c(t,e){const i=(0,s.fV)(2**e);return(0,s.zi)((0,s.RI)(t.divide(i)),(0,s.fV)(2))}function p(t,e){return(0,s.MM)(c(t,e),(0,s.fV)(.5))}function d(t,e){return c(t,e+o.U5)}function h(t,e){return c(t,e)}function m(t){const e=c(t.z,7),i=(0,s.fV)(1).subtract(e),o=t.xyz.subtract((0,s.eR)(0,0,(0,s.fV)(128)));return i.multiply(t).add(e.multiply(o))}function f(t){const e=(0,s.ln)(255/256,255/65536,255/16777216,255/4294967296);return(0,s.Om)(t,e)}function y(t){return(0,s.T9)((0,s.T9)((0,s.T9)(t.x,t.y),t.z),t.w)}function v(t){return new s.nt(1).subtract(t)}function g(t){return t.subtract(new s.nt(1))}function b(t,e){return t.subtract(new s.nt(e))}},62484:(t,e,i)=>{var o;i.d(e,{DW:()=>m,GA:()=>p,mv:()=>o}),function(t){t.Local="Local",t.Global="Global"}(o||(o={}));class s{generateSource(t){const e=[];for(let o=1;o<this.length;o++)e.push("vec4 atom".concat(o," = texture(").concat(t.animationTexture,", (pointer + 0.5) / size);")),e.push("pointer.x += 1.0;");for(let o=0;o<this.ins;o++)e.push("top--;"),e.push("vec4 in".concat(this.ins-o-1," = stack[top];"));for(let o=0;o<this.outs;o++)e.push("vec4 out".concat(o,";"));const{microcode:i}=this;for(const o of i)e.push(o);for(let o=0;o<this.outs;o++)e.push("stack[top] = out".concat(o,";")),e.push("top++;"),e.push("if (top >= ".concat(h,") { top = ").concat(h-1,"; }"));return e}}let r=128;function n(t){return["float duration = clamp(".concat(t.duration,", 0.05, 3600.0);"),"float startTimeOffset = ".concat(t.startTimeOffset,";"),"float repeatDelay = ".concat(t.repeatDelay,";"),"float timeOriginSelector = ".concat(t.timeOriginSelector,";"),"float repeatType = ".concat(t.repeatType,";"),"float easing = ".concat(t.easing,";"),"float playAnimation = ".concat(t.playAnimation," * (1.0 - step(0.0, -").concat(t.duration,"));"),"float reverseAnimation = ".concat(t.reverseAnimation,";"),"float time = globalTime - (timeOriginSelector == 1.0 ? localTimeOrigin : 0.0);","time *= playAnimation;","time *= 1.0 - reverseAnimation * 2.0;","float period = duration + repeatDelay;","time += reverseAnimation == 1.0 ? (period - startTimeOffset - 0.001) : startTimeOffset + 0.001;","float omega = time / period;","float oi = floor(omega);","omega = repeatType == 1.0 || repeatType == 3.0 ? omega - oi : omega;","float of = omega * period;","of = (clamp(of, reverseAnimation * repeatDelay, period - (1.0 - reverseAnimation) * repeatDelay) - reverseAnimation * repeatDelay) / duration;","of = easing == 2.0 ? pow(of, 3.0) : of;","of = easing == 3.0 ? 1.0 - pow(1.0 - of, 3.0) : of;","of = easing == 4.0 ? of < 0.5 ? 4.0 * pow(of, 3.0) : 1.0 - pow(-2.0 * of + 2.0, 3.0) / 2.0 : of;","bool oscillate = repeatType == 3.0 && mod(oi, 2.0) == 1.0;","".concat(t.out," = oscillate ? 1.0 - of : of;")]}const a={Linear:1,EaseIn:2,EaseOut:3,EaseInOut:4},l={Loop:1,None:2,Oscillate:3},u={Local:1,Global:2};function c(t){const e=a[t.easing],i=l[t.repeatType],o=u[t.timeOriginSelector];return[[t.duration,t.startTimeOffset,t.repeatDelay,o],[i,e,t.playAnimation,t.reverseAnimation]]}const p={scalar:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=1,this.ins=0,this.outs=1,this.microcode=["out0 = vec4(atom0.y, atom0.y, atom0.y, atom0.y);"]}encode(t){return[[this.opcode,t,0,0]]}},vector3:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=1,this.ins=0,this.outs=1,this.microcode=["out0 = vec4(atom0.yzw, 0.0);"]}encode(t){return[[this.opcode,t[0]||0,t[1]||0,t[2]||0]]}},vector4:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=2,this.ins=0,this.outs=1,this.microcode=["out0 = atom1;"]}encode(t){return[[this.opcode,0,0,0],t]}},animatedTransform:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=10,this.ins=1,this.outs=1,this.microcode=["vec2 fromTranslation = atom1.xy;","vec2 toTranslation = atom1.zw;","float fromRotation = atom2.x;","float toRotation = atom2.y;","float fromScale = atom2.z;","float toScale = atom2.w;","bool relativeTranslation = atom9.x == 1.0;","bool absoluteScale = atom9.y == 1.0;","vec2 translationMultiplier = relativeTranslation ? pixelDimensions : vec2(1.0, 1.0);","float scaleDivisor = absoluteScale ? pixelDimensions.y : 1.0;","float fTranslation;","{",...n({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",out:"fTranslation"}),"}","float fRotation;","{",...n({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fRotation"}),"}","float fScale;","{",...n({duration:"atom7.x",startTimeOffset:"atom7.y",repeatDelay:"atom7.z",timeOriginSelector:"atom7.w",repeatType:"atom8.x",easing:"atom8.y",playAnimation:"atom8.z",reverseAnimation:"atom8.w",out:"fScale"}),"}","vec2 aTranslation = mix(fromTranslation, toTranslation, fTranslation);","float aRotation = mix(fromRotation, toRotation, fRotation);","float aScale = mix(fromScale, toScale, fScale);","vec2 pTranslation = in0.xy;","float pRotation = in0.z;","float pScale = in0.w;","aTranslation *= translationMultiplier;","aScale /= scaleDivisor;","float rotation = pRotation + aRotation;","float scale = pScale * aScale;","float sin1 = sin(pRotation);","float cos1 = cos(pRotation);","float s1 = pScale;","float x1 = pTranslation.x;","float y1 = pTranslation.y;","float x2 = aTranslation.x;","float y2 = aTranslation.y;","\n    vec2 translation = vec2(\n      cos1 * s1 * x2 - sin1 * s1 * y2 + x1,\n      sin1 * s1 * x2 + cos1 * s1 * y2 + y1\n    );\n    ","out0 = vec4(translation, rotation, scale);"]}encode(t){return[[this.opcode,0,0,0],[t.translation.from[0],t.translation.from[1],t.translation.to[0],t.translation.to[1]],[t.rotation.from,t.rotation.to,t.scale.from,t.scale.to],...c(t.translation.timing),...c(t.rotation.timing),...c(t.scale.timing),[t.relativeTranslation?1:0,t.absoluteScale?1:0,0,0]]}},animatedColor:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=7,this.ins=1,this.outs=1,this.microcode=["float fromOpacity = atom0.y;","float toOpacity = atom0.z;","vec4 fromColor = atom1;","vec4 toColor = atom2;","float fColor;","{",...n({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",out:"fColor"}),"}","float fOpacity;","{",...n({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fOpacity"}),"}","vec4 aColor = mix(fromColor, toColor, fColor);","aColor.a *= mix(fromOpacity, toOpacity, fOpacity);","vec4 pColor = in0;","out0 = aColor * pColor;"]}encode(t){return[[this.opcode,t.opacity.from,t.opacity.to,0],[t.color.from[0],t.color.from[1],t.color.from[2],t.color.from[3]],[t.color.to[0],t.color.to[1],t.color.to[2],t.color.to[3]],...c(t.color.timing),...c(t.opacity.timing)]}},ret:new class extends s{constructor(){super(...arguments),this.opcode=++r,this.length=1,this.ins=0,this.outs=0,this.microcode=["break;"]}encode(){return[[this.opcode,0,0,0]]}}},d=40,h=4;function m(t){const e=[];e.push("float globalTime = ".concat(t.globalTime,";")),e.push("float localTimeOrigin = ".concat(t.localTimeOrigin,";")),e.push("vec2 pointer = ".concat(t.animationPointer,";")),e.push("vec2 size = ".concat(t.animationTextureSize,";")),e.push("int top = 0;"),e.push("vec4 stack[".concat(h,"];")),e.push("for (int counter = 0; counter < ".concat(d,"; counter++) {")),e.push("vec4 atom0 = texture(".concat(t.animationTexture,", (pointer + 0.5) / size);")),e.push("pointer.x += 1.0;"),e.push("vec2 pixelDimensions = ".concat(t.pixelDimensions,";")),e.push("if (false) {");for(const i in p){const o=p[i];e.push("} else if (int(atom0.x) == ".concat(o.opcode,") {"));for(const i of o.generateSource(t))e.push(i)}return e.push("} // End if-else."),e.push("} // End for."),e.push("".concat(t.out," = top > 0 ? stack[top - 1] : vec4(0.0);")),e.join("\n")}},64780:(t,e,i)=>{i.d(e,{e:()=>l});var o=i(89379),s=i(76718),r=(i(12331),i(81806),i(61678),i(93345)),n=(i(89179),i(80895),i(36911)),a=i(89339);class l{constructor(t,e){this._boundPart=null,this.vertexBuffers=new Map,this.indexBuffers=new Map,this.groups=[];for(const i in e.vertex){const{data:o,attributes:n}=e.vertex[i],a=s.g.createVertex(t,r._U.STATIC_DRAW,o);this.vertexBuffers.set(i,{buffer:a,attributes:n})}for(const i in e.index){const{data:o}=e.index[i],n=s.g.createIndex(t,r._U.STATIC_DRAW,o);this.indexBuffers.set(i,{buffer:n})}for(const i of e.groups)this.groups.push((0,o.A)((0,o.A)({},i),{},{vertexArrays:new Map}));this.parts=e.parts}bind(t,e,i){this._boundPart=i;const{group:o}=this.parts[this._boundPart],s=this.groups[o];if(!s)throw new Error("Missing group ".concat(o,"."));let r=s.vertexArrays.get(e.stringHash);if(!r){var a;const i=new Set(e.locations.keys()),o=s.index?null===(a=this.indexBuffers.get(s.index))||void 0===a?void 0:a.buffer:null,l=new Map,u=new Map;for(const[t,{buffer:e,attributes:s}]of this.vertexBuffers){const o=s.filter((t=>i.has(t.name)));o.length>0&&(l.set(t,o),u.set(t,e))}r=new n.Z(t,e.locations,l,u,o),s.vertexArrays.set(e.stringHash,r)}t.bindVAO(r)}draw(t){if(null==this._boundPart)throw new Error("Mesh.bind() has not been called.");const{start:e,count:i}=this.parts[this._boundPart],{group:o}=this.parts[this._boundPart],{primitive:s,index:r}=this.groups[o];if(r){const o=this.indexBuffers.get(r);if(!o)throw new Error('Missing index buffer "'.concat(r,'".'));const{indexType:n}=o.buffer;if(!n)throw new Error("Buffer type error.");t.drawElements(s,i,n,e*a.I[n])}else t.drawArrays(s,e,i)}unbind(t){this._boundPart=null,t.bindVAO(null)}destroy(){for(const{vertexArrays:t}of this.groups)for(const[e,i]of t)i.disposeVAOOnly();for(const{buffer:t}of this.vertexBuffers.values())t.dispose();for(const{buffer:t}of this.indexBuffers.values())t.dispose()}}},74075:(t,e,i)=>{function o(t){return!!(t.visualVariableSizeMinMaxValue||t.visualVariableSizeScaleStops||t.visualVariableSizeStops||t.visualVariableSizeUnitValue||t.visualVariableSizeOutlineScaleStops)}function s(t){return!!t.visualVariableRotation}i.d(e,{I:()=>o,N:()=>s})},81608:(t,e,i)=>{function o(t,e){const i=t.slice(0,e),o=e-i.length;for(let s=0;s<o;s++){const t=i[i.length-1];i.push(t)}return i}function s(t){if(!t)return[0,0,0,0];const{r:e,g:i,b:o,a:s}=t;return[e*(s/255),i*(s/255),o*(s/255),s]}i.d(e,{p:()=>s,r:()=>o})},89339:(t,e,i)=>{i.d(e,{I:()=>s});var o=i(93345);const s={[o.pe.BYTE]:1,[o.pe.UNSIGNED_BYTE]:1,[o.pe.SHORT]:2,[o.pe.UNSIGNED_SHORT]:2,[o.pe.HALF_FLOAT]:2,[o.pe.INT]:4,[o.pe.UNSIGNED_INT]:4,[o.pe.FLOAT]:4}},89657:(t,e,i)=>{i.d(e,{Q:()=>o});const o={isAlongLine:0,isAbsoluteSize:1,isDiscrete:2}},90113:(t,e,i)=>{var o;i.d(e,{$w:()=>c,Fb:()=>a,Fz:()=>y,H_:()=>o,J5:()=>l,M:()=>d,Ni:()=>p,V5:()=>n,Xx:()=>f,YV:()=>w,au:()=>u,b5:()=>g,bg:()=>b,cZ:()=>S,cn:()=>m,eo:()=>_,kx:()=>v,os:()=>s,qM:()=>h,rp:()=>r,ti:()=>x,v9:()=>A}),function(t){t[t.Geographic=0]="Geographic",t[t.Arithmatic=1]="Arithmatic"}(o||(o={}));const s=3.14159265359/180,r=3.14159265359/128,n=1,a=1.1,l=1,u=24,c=8,p=1e-5,d=.05,h=1e-30,m=4,f=0,y=2,v=2,g=3,b=0,x=3,w=16777216,_=1.1,S=16,A=128}}]);
//# sourceMappingURL=1581.9e1a9921.chunk.js.map